<?xml version="1.0" encoding="UTF-8"?>
<!-- -*- nxml -*- -->
<transfer>
  <section-def-cats>
    <def-cat n="unknown"> <!-- unknown words -->
      <cat-item tags=""/>
    </def-cat>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="n_sp">
      <cat-item tags="n.*.sp"/>
    </def-cat>
    <def-cat n="np">
      <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="npant">
      <cat-item tags="np.ant"/>
      <cat-item tags="np.ant.*"/>
      <cat-item tags="np.cog.*"/>
    </def-cat>
    <def-cat n="npant_unk">
      <cat-item tags="np.ant"/>
      <cat-item tags="np.ant.*"/>
      <cat-item tags="np.cog.*"/>
      <cat-item tags=""/>
    </def-cat>
    <def-cat n="nptop">
      <cat-item tags="np.loc"/>
      <cat-item tags="np.top.*"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="detdefsg">
      <cat-item tags="det.def.*.sg"/>
    </def-cat>
    <def-cat n="detdefpl">
      <cat-item tags="det.def.mf.pl"/>
    </def-cat>
    <def-cat n="adjindpl">
      <cat-item tags="adj.ind.*.pl"/>
    </def-cat>
    <def-cat n="le">
      <cat-item lemma="le" tags="det.*"/>
    </def-cat>
    <def-cat n="ce_det">
      <cat-item lemma="ce" tags="det.*"/>
    </def-cat>
    <def-cat n="quelques_plusieurs">
      <cat-item lemma="quelque" tags="det.*"/>
      <cat-item lemma="plusieurs" tags="det.*"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adjec_adv">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="_1er">
      <cat-item lemma="1er" tags="adj.m.sg"/>
    </def-cat>
    <def-cat n="neadv">
      <cat-item lemma="ne" tags="adv"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="cnjsub">
      <cat-item tags="cnjsub"/>
    </def-cat>
    <def-cat n="cnjadv">
      <cat-item tags="cnjadv"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="enprep">
      <cat-item lemma="en" tags="pr"/>
    </def-cat>
    <def-cat n="adeprep">
      <cat-item lemma="à" tags="pr"/>
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="deprep">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="entreprep">
      <cat-item lemma="entre" tags="pr"/>
    </def-cat>
    <def-cat n="chez">
      <cat-item lemma="chez" tags="pr"/>
    </def-cat>
    <def-cat n="commeprep">
      <cat-item lemma="comme" tags="pr"/>
    </def-cat>
    <def-cat n="sur_avec">
      <cat-item lemma="sur" tags="pr"/>
      <cat-item lemma="avec" tags="pr"/>
      <cat-item lemma="sans" tags="pr"/>
      <cat-item lemma="entre" tags="pr"/>
      <cat-item lemma="contre" tags="pr"/>
      <cat-item lemma="à" tags="pr"/>
    </def-cat>
    <def-cat n="apres">
      <cat-item lemma="après" tags="pr"/>
      <cat-item lemma="après" tags="adv"/>
    </def-cat>
    <def-cat n="pas_strict">
      <cat-item lemma="pas" tags="adv"/>
    </def-cat>
    <def-cat n="pas"> <!-- adverbes négatifs qui doivent être éliminés pendant la traduction -->
      <cat-item lemma="pas" tags="adv"/>
      <cat-item lemma="point" tags="adv"/>
      <cat-item lemma="point" tags="n.*"/>
    </def-cat>
    <def-cat n="adv_neg"> <!-- adverbes négatifs qui doivent être se conserver pendant la traduction-->
      <cat-item lemma="jamais" tags="adv"/>
      <cat-item lemma="nullement" tags="adv"/>
      <cat-item lemma="aucunement" tags="adv"/>
      <cat-item lemma="guère" tags="adv"/>
      <cat-item lemma="plus" tags="adv"/>
      <cat-item lemma="nulle part" tags="adv"/>
      <cat-item lemma="pas beaucoup" tags="adv"/>
      <cat-item lemma="pas beaucoup de" tags="adv"/>
      <cat-item lemma="rien" tags="prn.*"/>
      <cat-item lemma="toujours pas" tags="adv"/>
      <cat-item lemma="même pas" tags="adv"/>
    </def-cat>
    <def-cat n="train">
      <cat-item lemma="train" tags="n.*"/>
    </def-cat>
    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="lequel">
      <cat-item lemma="lequel" tags="rel.*"/>
    </def-cat>
    <def-cat n="prntn">
      <cat-item tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="prnsubj">
      <cat-item lemma="je" tags="prn.tn.p1.mf.sg"/>
      <cat-item lemma="tu" tags="prn.tn.p2.mf.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.m.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.sg"/>
      <cat-item lemma="nous" tags="prn.tn.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.tn.p2.mf.pl"/>
      <cat-item lemma="il" tags="prn.tn.p3.m.pl"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.pl"/>
    </def-cat>
    <def-cat n="il">
      <cat-item lemma="il" tags="prn.tn.p3.m.sg"/>
    </def-cat>
    <def-cat n="on">
      <cat-item lemma="on" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="moi_toi_etc">
      <cat-item lemma="moi" tags="prn.tn.p1.mf.sg"/>
      <cat-item lemma="toi" tags="prn.tn.p2.mf.sg"/>
      <cat-item lemma="lui" tags="prn.tn.p3.m.sg"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.sg"/>
      <cat-item lemma="soi" tags="prn.tn.ref.p3.mf.sp"/>
      <cat-item lemma="nous" tags="prn.tn.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.tn.p1.mf.pl"/>
      <cat-item lemma="eux" tags="prn.tn.p3.m.pl"/>
      <cat-item lemma="il" tags="prn.tn.p3.f.pl"/>
    </def-cat>
    <def-cat n="un_detmsg">
      <cat-item lemma="un" tags="det.ind.m.sg"/>
    </def-cat>
    <def-cat n="unpron">
      <cat-item lemma="un" tags="prn.*"/>
    </def-cat>
    <def-cat n="ce_prn">
      <cat-item lemma="ce" tags="prn.tn.nt"/>
    </def-cat>
    <def-cat n="celui">
      <cat-item lemma="celui" tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="prn">
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pro.*"/>
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnitg">
      <cat-item tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="en_prnenc">
      <cat-item lemma="en" tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnproref3">
      <cat-item lemma="se" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="prnproref">
      <cat-item lemma="me" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="se" tags="prn.pro.ref.p3.mf.sp"/>
      <cat-item lemma="nous" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="vous" tags="prn.pro.p2.mf.pl"/>
    </def-cat>
    <def-cat n="prnproobj">
      <cat-item lemma="me" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="lui" tags="prn.pro.p3.mf.sg"/>
      <cat-item lemma="nous" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="se" tags="prn.pro.ref.p3.mf.sp"/>
      <cat-item lemma="vous" tags="prn.pro.p2.mf.pl"/>
      <cat-item lemma="leur" tags="prn.pro.p3.mf.pl"/>
      <cat-item lemma="le" tags="prn.pro.p3.mf.sg"/>
      <cat-item lemma="le" tags="prn.pro.p3.m.sg"/>
      <cat-item lemma="le" tags="prn.pro.p3.f.sg"/>
      <cat-item lemma="le" tags="prn.pro.p3.nt"/>
      <cat-item lemma="le" tags="prn.pro.p3.mf.pl"/>
      <cat-item lemma="en" tags="prn.pro.adv"/>
      <cat-item lemma="y" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="lui">
      <cat-item lemma="lui" tags="prn.pro.p3.mf.sg"/>
    </def-cat>
    <def-cat n="a_lui">
      <cat-item lemma="à lui" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="a_nous">
      <cat-item lemma="à nous" tags="adj.pos.mf.sp"/>
    </def-cat>
    <def-cat n="a_vous">
      <cat-item lemma="à vous" tags="adj.pos.mf.sp"/>
    </def-cat>
    <def-cat n="y">
      <cat-item lemma="y" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="beaucoup_de">
      <cat-item lemma="beaucoup de" tags="prn.tn.mf.sp"/>
    </def-cat>
    <def-cat n="nombreux">
      <cat-item lemma="nombreux" tags="adj.m.sp"/>
      <cat-item lemma="nombreux" tags="adj.f.pl"/>
    </def-cat>
    <def-cat n="verb_partitiu">
      <cat-item tags="vbhaver.*"/>
      <cat-item lemma="accueillir" tags="vblex.*"/>
      <cat-item lemma="avoir" tags="vblex.*"/>
      <cat-item lemma="avoir# besoin" tags="vblex.*"/>
      <cat-item lemma="accumuler" tags="vblex.*"/>
      <cat-item lemma="acheter" tags="vblex.*"/>
      <cat-item lemma="boire" tags="vblex.*"/>
      <cat-item lemma="chercher" tags="vblex.*"/>
      <cat-item lemma="désirer" tags="vblex.*"/>
      <cat-item lemma="faire" tags="vblex.*"/>
      <cat-item lemma="falloir" tags="vbmod.*"/>
      <cat-item lemma="gagner" tags="vblex.*"/>
      <cat-item lemma="gagner" tags="vbmod.*"/>
      <cat-item lemma="imaginer" tags="vblex.*"/>
      <cat-item lemma="manger" tags="vblex.*"/>
      <cat-item lemma="sentir" tags="vblex.*"/>
      <cat-item lemma="voler" tags="vblex.*"/>
      <cat-item lemma="vouloir" tags="vblex.*"/>
      <cat-item lemma="vouloir" tags="vbmod.*"/>
    </def-cat>
    <def-cat n="verb">
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="vbser">
      <cat-item tags="vbser.*"/>
    </def-cat>
    <def-cat n="vbserp3">
      <cat-item tags="vbser.*.p3.*"/>
    </def-cat>
    <def-cat n="verbnoser">
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="vbhaver">
      <cat-item tags="vbhaver.*"/>
      <cat-item lemma="avoir" tags="vblex.*"/>
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="inf_ger">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>
    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="vbserpp">
      <cat-item tags="vbser.pp.*"/>
    </def-cat>
    <def-cat n="auxpp">
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item lemma="être" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="pp_m_sg">
      <cat-item tags="vblex.pp.m.sg"/>
      <cat-item tags="vbser.pp.m.sg"/>
      <cat-item tags="vbhaver.pp.m.sg"/>
      <cat-item tags="vbmod.pp.m.sg"/>
    </def-cat>
    <def-cat n="pp_mf_sp">
      <cat-item tags="vblex.pp.mf.*"/>
      <cat-item tags="vblex.pp.*.sp"/>
      <cat-item tags="vbser.pp.mf.*"/>
      <cat-item tags="vbser.pp.*.sp"/>
      <cat-item tags="vbhaver.pp.mf.*"/>
      <cat-item tags="vbhaver.pp.*.sp"/>
      <cat-item tags="vbmod.pp.mf.*"/>
      <cat-item tags="vbmod.pp.*.sp"/>
    </def-cat>
    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>
    <def-cat n="pretind">
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbmod.ifi.*"/>
    </def-cat>
    <def-cat n="aller_venir">
      <cat-item lemma="aller" tags="vblex.*"/>
      <cat-item lemma="venir" tags="vblex.*"/>
    </def-cat>
    <def-cat n="aller_imp">
      <cat-item lemma="aller" tags="vblex.imp.*"/>
    </def-cat>
    <def-cat n="lquest">
      <cat-item tags="lquest"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num"/>
      <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="xifra">
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="num_detind">
      <cat-item tags="num"/>
      <cat-item tags="num.*"/>
      <cat-item tags="det.ind.*"/>
    </def-cat>
    <def-cat n="detindpl">
      <cat-item tags="det.ind.*.pl"/>
      <cat-item lemma="beaucoup de" tags="det.ind.*"/>
      <cat-item lemma="peu de" tags="det.ind.*"/>
    </def-cat>
    <def-cat n="en">
      <cat-item lemma="en" tags="pr"/>
      <cat-item lemma="en" tags="prn.*"/>
    </def-cat>
    <def-cat n="apr">
      <cat-item lemma="à" tags="pr"/>
    </def-cat>
    <def-cat n="depuis">
      <cat-item lemma="depuis" tags="pr"/>
    </def-cat>
    <def-cat n="que">
      <cat-item lemma="que" tags="cnjsub"/>
      <cat-item lemma="que" tags="rel.mf.sp"/>
      <cat-item lemma="que" tags="prn.itg.mf.sg"/>
    </def-cat>
    <def-cat n="est-ce_que">
      <cat-item lemma="est-ce que" tags="prn.itg.mf.sg"/>
    </def-cat>
    <def-cat n="pascomp"> <!-- passé composé -->
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.fts.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.fts.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.cni.*"/>
    </def-cat>
    <def-cat n="pascomp_ser"> <!-- passé composé -->
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.fts.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.cni.*"/>
    </def-cat>
    <def-cat n="verbconj">
      <cat-item tags="vblex.*.p1.*"/>
      <cat-item tags="vblex.*.p2.*"/>
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbser.*.p1.*"/>
      <cat-item tags="vbser.*.p2.*"/>
      <cat-item tags="vbser.*.p3.*"/>
      <cat-item tags="vbmod.*.p1.*"/>
      <cat-item tags="vbmod.*.p2.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="verbconjp3">
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbser.*.p3.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="serconj">
      <cat-item tags="vbser.*.p1.*"/>
      <cat-item tags="vbser.*.p2.*"/>
      <cat-item tags="vbser.*.p3.*"/>
    </def-cat>
    <def-cat n="verbnoserconj">
      <cat-item tags="vblex.*.p1.*"/>
      <cat-item tags="vblex.*.p2.*"/>
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbmod.*.p1.*"/>
      <cat-item tags="vbmod.*.p2.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="verbnoser_inf_ger">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>
    <def-cat n="pp_nohaver">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="appeler">
      <cat-item lemma="appeler" tags="vblex.pri.*"/>
      <cat-item lemma="appeler" tags="vblex.pii.*"/>
      <cat-item lemma="appeler" tags="vblex.fti.*"/>
    </def-cat>
    <def-cat n="continuer">
      <cat-item lemma="continuer" tags="vblex.*"/>
    </def-cat>
    <def-cat n="resterp3sg_noifi">
      <cat-item lemma="rester" tags="vblex.pri.p3.sg"/>
      <cat-item lemma="rester" tags="vblex.prs.p3.sg"/>
      <cat-item lemma="rester" tags="vblex.pii.p3.sg"/>
      <cat-item lemma="rester" tags="vblex.pis.p3.sg"/>
      <cat-item lemma="rester" tags="vblex.fti.p3.sg"/>
      <cat-item lemma="rester" tags="vblex.cni.p3.sg"/>
    </def-cat>
    <def-cat n="resterpp">
      <cat-item lemma="rester" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="verbospron"> <!-- verbs pronominals en fra però amb l'equivalent cat no pronominal -->
      <cat-item lemma="asseoir" tags="vblex.*"/>
      <cat-item lemma="avérer" tags="vblex.*"/>
      <cat-item lemma="carapater" tags="vblex.*"/>
      <cat-item lemma="dérober" tags="vblex.*"/>
      <cat-item lemma="dérober# à" tags="vblex.*"/>
      <cat-item lemma="faire# engueuler" tags="vblex.*"/>
      <cat-item lemma="heurter" tags="vblex.*"/>
      <cat-item lemma="passer" tags="vblex.*"/>
      <cat-item lemma="rendre" tags="vblex.*"/>
      <cat-item lemma="rendre# à" tags="vblex.*"/>
      <cat-item lemma="reposer" tags="vblex.*"/>
      <cat-item lemma="taire" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verbospron_pp">
      <cat-item lemma="asseoir" tags="vblex.pp.*"/>
      <cat-item lemma="avérer" tags="vblex.pp.*"/>
      <cat-item lemma="carapater" tags="vblex.pp.*"/>
      <cat-item lemma="dérober" tags="vblex.pp.*"/>
      <cat-item lemma="dérober# à" tags="vblex.pp.*"/>
      <cat-item lemma="faire# engueuler" tags="vblex.pp.*"/>
      <cat-item lemma="heurter" tags="vblex.pp.*"/>
      <cat-item lemma="passer" tags="vblex.pp.*"/>
      <cat-item lemma="rendre" tags="vblex.pp.*"/>
      <cat-item lemma="rendre# à" tags="vblex.pp.*"/>
      <cat-item lemma="reposer" tags="vblex.pp.*"/>
      <cat-item lemma="taire" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="verbospron_inf">
      <cat-item lemma="asseoir" tags="vblex.inf"/>
      <cat-item lemma="avérer" tags="vblex.inf"/>
      <cat-item lemma="carapater" tags="vblex.inf"/>
      <cat-item lemma="dérober" tags="vblex.inf"/>
      <cat-item lemma="dérober# à" tags="vblex.inf"/>
      <cat-item lemma="faire# engueuler" tags="vblex.inf"/>
      <cat-item lemma="heurter" tags="vblex.inf"/>
      <cat-item lemma="passer" tags="vblex.inf"/>
      <cat-item lemma="rendre" tags="vblex.inf"/>
      <cat-item lemma="rendre# à" tags="vblex.inf"/>
      <cat-item lemma="reposer" tags="vblex.inf"/>
      <cat-item lemma="taire" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="verbospron_ger">
      <cat-item lemma="asseoir" tags="vblex.ger"/>
      <cat-item lemma="avérer" tags="vblex.ger"/>
      <cat-item lemma="carapater" tags="vblex.ger"/>
      <cat-item lemma="dérober" tags="vblex.ger"/>
      <cat-item lemma="dérober# à" tags="vblex.ger"/>
      <cat-item lemma="faire# engueuler" tags="vblex.ger"/>
      <cat-item lemma="heurter" tags="vblex.ger"/>
      <cat-item lemma="passer" tags="vblex.ger"/>
      <cat-item lemma="rendre" tags="vblex.ger"/>
      <cat-item lemma="rendre# à" tags="vblex.ger"/>
      <cat-item lemma="reposer" tags="vblex.ger"/>
      <cat-item lemma="taire" tags="vblex.ger"/>
    </def-cat>
    <def-cat n="vbambser_pp">
      <cat-item lemma="aller" tags="vblex.pp.*"/>
      <cat-item lemma="apparaître" tags="vblex.pp.*"/>
      <cat-item lemma="paraître" tags="vblex.pp.*"/>
      <cat-item lemma="arriver" tags="vblex.pp.*"/>
      <cat-item lemma="venir" tags="vblex.pp.*"/>
      <cat-item lemma="partir" tags="vblex.pp.*"/>
      <cat-item lemma="naître" tags="vblex.pp.*"/>
      <cat-item lemma="renaître" tags="vblex.pp.*"/>
      <cat-item lemma="mourir" tags="vblex.pp.*"/>
      <cat-item lemma="descendre" tags="vblex.pp.*"/>
      <cat-item lemma="monter" tags="vblex.pp.*"/>
      <cat-item lemma="entrer" tags="vblex.pp.*"/>
      <cat-item lemma="rentrer" tags="vblex.pp.*"/>
      <cat-item lemma="sortir" tags="vblex.pp.*"/>
      <cat-item lemma="tomber" tags="vblex.pp.*"/>
      <cat-item lemma="retourner" tags="vblex.pp.*"/>
      <cat-item lemma="passer" tags="vblex.pp.*"/>
      <cat-item lemma="rester" tags="vblex.pp.*"/>
      <cat-item lemma="devenir" tags="vblex.pp.*"/>
      <cat-item lemma="revenir" tags="vblex.pp.*"/>
    </def-cat>

    <def-cat n="est_vbser">
      <cat-item tags="vbser.pri.p3.sg"/>
    </def-cat>
    <def-cat n="parti_pp">
      <cat-item lemma="partir" tags="vblex.pp.m.sg"/>
    </def-cat>

    <def-cat n="defense">
      <cat-item lemma="défense" tags="n.f.sg"/>
    </def-cat>
    <def-cat n="debut">
      <cat-item lemma="début" tags="n.m.sg"/>
    </def-cat>
    <def-cat n="fin">
      <cat-item lemma="fin" tags="n.f.sg"/>
    </def-cat>
    <def-cat n="milliard">
      <cat-item lemma="milliard" tags="n.*"/>
      <cat-item lemma="demi-milliard" tags="n.*"/>
      <cat-item lemma="demi-million" tags="n.*"/>
    </def-cat>
    <def-cat n="cnjcoo">
      <cat-item tags="cnjcoo"/>
    </def-cat>
    <def-cat n="cm">
      <cat-item tags="cm"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

    <def-cat n="jour_n">
      <cat-item lemma="lundi" tags="n.*"/>
      <cat-item lemma="mardi" tags="n.*"/>
      <cat-item lemma="mercredi" tags="n.*"/>
      <cat-item lemma="jeudi" tags="n.*"/>
      <cat-item lemma="vendredi" tags="n.*"/>
      <cat-item lemma="samedi" tags="n.*"/>
      <cat-item lemma="dimanche" tags="n.*"/>
    </def-cat>

    <def-cat n="jour_adv">
      <cat-item lemma="avant-hier" tags="adv"/>
      <cat-item lemma="hier" tags="adv"/>
      <cat-item lemma="aujourd'hui" tags="adv"/>
      <cat-item lemma="demain" tags="adv"/>
      <cat-item lemma="après-demain" tags="adv"/>
      <cat-item lemma="le lendemain" tags="adv"/>
    </def-cat>

    <def-cat n="part_jour">
      <cat-item lemma="matin" tags="n.*"/>
      <cat-item lemma="après-midi" tags="n.*"/>
      <cat-item lemma="soir" tags="n.*"/>
    </def-cat>

    <def-cat n="heures">
      <cat-item lemma="heure" tags="n.f.pl"/>
    </def-cat>

    <def-cat n="unite_temps">
      <cat-item lemma="seconde" tags="n.*"/>
      <cat-item lemma="minute" tags="n.*"/>
      <cat-item lemma="heure" tags="n.*"/>
      <cat-item lemma="jour" tags="n.*"/>
      <cat-item lemma="journée" tags="n.*"/>
      <cat-item lemma="semaine" tags="n.*"/>
      <cat-item lemma="mois" tags="n.*"/>
      <cat-item lemma="an" tags="n.*"/>
      <cat-item lemma="année" tags="n.*"/>
      <cat-item lemma="lustre" tags="n.*"/>
      <cat-item lemma="décennie" tags="n.*"/>
      <cat-item lemma="décade" tags="n.*"/>
      <cat-item lemma="siècle" tags="n.*"/>
      <cat-item lemma="millénaire" tags="n.*"/>
    </def-cat>

    <def-cat n="nom_mois">
      <cat-item lemma="janvier" tags="n.*"/>
      <cat-item lemma="février" tags="n.*"/>
      <cat-item lemma="mars" tags="n.*"/>
      <cat-item lemma="avril" tags="n.*"/>
      <cat-item lemma="mai" tags="n.*"/>
      <cat-item lemma="juin" tags="n.*"/>
      <cat-item lemma="juillet" tags="n.*"/>
      <cat-item lemma="août" tags="n.*"/>
      <cat-item lemma="septembre" tags="n.*"/>
      <cat-item lemma="octobre" tags="n.*"/>
      <cat-item lemma="novembre" tags="n.*"/>
      <cat-item lemma="décembre" tags="n.*"/>
      <cat-item lemma="vendémiaire" tags="n.*"/>
      <cat-item lemma="brumaire" tags="n.*"/>
      <cat-item lemma="frimaire" tags="n.*"/>
      <cat-item lemma="nivôse" tags="n.*"/>
      <cat-item lemma="pluviôse" tags="n.*"/>
      <cat-item lemma="ventôse" tags="n.*"/>
      <cat-item lemma="germinal" tags="n.*"/>
      <cat-item lemma="floréal" tags="n.*"/>
      <cat-item lemma="prairial" tags="n.*"/>
      <cat-item lemma="messidor" tags="n.*"/>
      <cat-item lemma="thermidor" tags="n.*"/>
      <cat-item lemma="fructidor" tags="n.*"/>
    </def-cat>

    <def-cat n="nom_monsieur">
      <cat-item lemma="monsieur" tags="n.*"/>
      <cat-item lemma="madame" tags="n.*"/>
      <cat-item lemma="mademoiselle" tags="n.*"/>
    </def-cat>

    <def-cat n="combien">
      <cat-item lemma="combien" tags="prn.*"/>
      <cat-item lemma="combien" tags="rel.*"/>
    </def-cat>

    <def-cat n="longtemps">
      <cat-item lemma="longtemps" tags="adv"/>
    </def-cat>

    <def-cat n="plus_moins">
      <cat-item lemma="plus" tags="adv"/>
      <cat-item lemma="moins" tags="adv"/>
    </def-cat>

    <def-cat n="ci_la">
      <cat-item lemma="ci" tags="adv"/>
      <cat-item lemma="là" tags="adv"/>
    </def-cat>

  </section-def-cats>

  <section-def-attrs>

    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
    </def-attr>
    <def-attr n="a_nomp">
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_nptop">
      <attr-item tags="np.loc"/>
      <attr-item tags="np.top"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_predet">
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj.ord"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
    <def-attr n="a_prep">
      <attr-item tags="pr"/>
    </def-attr>
    <def-attr n="a_que">
      <attr-item tags="cnjsub"/>
      <attr-item tags="rel.mf.sp"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn.tn.p1"/>
      <attr-item tags="prn.tn.p2"/>
      <attr-item tags="prn.tn.p3"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.tn.ref.p3"/>
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.itg"/>
    </def-attr>
    <def-attr n="a_rel">
      <attr-item tags="rel"/>
    </def-attr>
    <def-attr n="a_verb_pron">
      <attr-item tags="vblex"/>
      <attr-item tags="vblex.pron"/>
      <attr-item tags="vblex.nopron"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vaux"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vaux"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_inf">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbser.inf"/>
      <attr-item tags="vbhaver.inf"/>
      <attr-item tags="vaux.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_ger">
      <attr-item tags="vblex.ger"/>
      <attr-item tags="vbser.ger"/>
      <attr-item tags="vbhaver.ger"/>
      <attr-item tags="vaux.ger"/>
      <attr-item tags="vbmod.ger"/>
    </def-attr>
    <def-attr n="a_pretind">
      <attr-item tags="vblex.ifi"/>
      <attr-item tags="vbser.ifi"/>
<!--	  <attr-item tags="vbhaver.ifi"/> -->
<!--	  <attr-item tags="vaux.ifi"/> -->
      <attr-item tags="vbmod.ifi"/>
    </def-attr>
    <def-attr n="a_lquest">
      <attr-item tags="lquest"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_xifra">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.ref"/>
      <attr-item tags="prn.enc.adv"/>
    </def-attr>
    <def-attr n="tipo_prn">
      <attr-item tags="enc"/>
      <attr-item tags="pro"/>
      <attr-item tags="tn"/>
      <attr-item tags="itg"/>
    </def-attr>
    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p3.f.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.mf.pl"/>
      <attr-item tags="p3.mf.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.nt"/>
      <attr-item tags="mf.sg"/>
      <attr-item tags="adv"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
<attr-item tags="m0"/>
<attr-item tags="m1"/>
<attr-item tags="m2"/>
<attr-item tags="m3"/>
<attr-item tags="m4"/>
<attr-item tags="m5"/>
<attr-item tags="m6"/>
<attr-item tags="m7"/>
<attr-item tags="m8"/>
<attr-item tags="m9"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="persona">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="ifi"/>
      <attr-item tags="pii"/>
      <attr-item tags="fti"/>
      <attr-item tags="cni"/>
      <attr-item tags="prs"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="imp"/>
    </def-attr>
    <def-attr n="verbototal">
      <attr-item tags="vblex.pri.p1.sg"/>
      <attr-item tags="vblex.pri.p3.sg"/>
      <attr-item tags="vblex.pri.p2.sg"/>
      <attr-item tags="vblex.pri.p3.pl"/>
      <attr-item tags="vblex.prs.p1.sg"/>
      <attr-item tags="vblex.prs.p2.sg"/>
      <attr-item tags="vblex.prs.p3.sg"/>
      <attr-item tags="vblex.prs.p3.pl"/>
    </def-attr>

  </section-def-attrs>

  <section-def-vars>
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="numero"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="auxg"/>
    <def-var n="auxn"/>
    <def-var n="aux"/>
    <def-var n="pronom"/>
  </section-def-vars>

  <section-def-lists>
    <def-list n="mois">
      <list-item v="janvier"/>
      <list-item v="février"/>
      <list-item v="mars"/>
      <list-item v="avril"/>
      <list-item v="mai"/>
      <list-item v="juin"/>
      <list-item v="juillet"/>
      <list-item v="août"/>
      <list-item v="septembre"/>
      <list-item v="octobre"/>
      <list-item v="novembre"/>
      <list-item v="décembre"/>
      <list-item v="vendémiaire"/>
      <list-item v="brumaire"/>
      <list-item v="frimaire"/>
<!-- problemes en ser sp en català
      <list-item v="nivôse"/>
      <list-item v="pluviôse"/>
      <list-item v="ventôse"/>
-->
      <list-item v="germinal"/>
      <list-item v="floréal"/>
      <list-item v="prairial"/>
      <list-item v="messidor"/>
      <list-item v="thermidor"/>
      <list-item v="fructidor"/>
    </def-list>

    <def-list n="vbambser">
      <list-item v="aller"/>
      <list-item v="apparaître"/>
      <list-item v="paraître"/>
      <list-item v="arriver"/>
      <list-item v="venir"/>
      <list-item v="partir"/>
      <list-item v="naître"/>
      <list-item v="renaître"/>
      <list-item v="mourir"/>
      <list-item v="descendre"/>
      <list-item v="monter"/>
      <list-item v="entrer"/>
      <list-item v="rentrer"/>
      <list-item v="sortir"/>
      <list-item v="tomber"/>
      <list-item v="retourner"/>
      <list-item v="passer"/>
      <list-item v="rester"/>
      <list-item v="devenir"/>
      <list-item v="revenir"/>
    </def-list>

    <def-list n="vb_pronfra_noproncat">
      <list-item v="assoir"/>
      <list-item v="avérer"/>
      <list-item v="carapater"/>
      <list-item v="dérober"/>
      <list-item v="heurter"/>
      <list-item v="passer"/>
      <list-item v="rendre"/>
      <list-item v="reposer"/>
      <list-item v="taire"/>
    </def-list>

    <def-list n="pays">
      <list-item v="Europe"/>
      <list-item v="Asie"/>
      <list-item v="Afrique"/>
      <list-item v="Afrique du Sud"/>
      <list-item v="Amérique"/>
      <list-item v="Amérique Centrale"/>
      <list-item v="Amérique du Nord"/>
      <list-item v="Amérique du Sud"/>
      <list-item v="Océanie"/>
      <list-item v="Eurasie"/>
      <list-item v="Pangée"/>
      <list-item v="Gondwana"/>
      <list-item v="Australie"/>
      <list-item v="Tasmanie"/>
      <list-item v="Nouvelle-Galles du Sud"/>
      <list-item v="Queensland"/>
      <list-item v="Nouvelle-Zélande"/>
      <list-item v="Timor"/>
      <list-item v="Timor oriental"/>
      <list-item v="Tuvalu"/>
      <list-item v="Vanuatu"/>
      <list-item v="Tonga"/>
      <list-item v="Kiribati"/>
      <list-item v="Papouasie"/>
      <list-item v="Papouasie-Nouvelle-Guinée"/>
      <list-item v="Nouvelle-Calédonie"/>
      <list-item v="Portugal"/>
      <list-item v="Espagne"/>
      <list-item v="Catalogne"/>
      <list-item v="Navarre"/>
      <list-item v="Biscaye"/>
      <list-item v="Guipuscoa"/>
      <list-item v="Castille"/>
      <list-item v="Andalousie"/>
      <list-item v="Aragon"/>
      <list-item v="Asturies"/>
      <list-item v="Galice"/>
      <list-item v="Pays Basque"/>
      <list-item v="Andorre"/>
      <list-item v="France"/>
      <list-item v="Champagne"/>
      <list-item v="Bretagne"/>
      <list-item v="Normandie"/>
      <list-item v="Gascogne"/>
      <list-item v="Béarn"/>
      <list-item v="Comminges"/>
      <list-item v="Aquitaine"/>
      <list-item v="Nouvelle-Aquitaine"/>
<!--      <list-item v="Gironde"/> -->
      <list-item v="Auvergne"/>
<!--      <list-item v="Limousin"/> -->
      <list-item v="Provence"/>
      <list-item v="Vaucluse"/>
      <list-item v="Savoie"/>
      <list-item v="Drôme"/>
      <list-item v="Allier"/>
      <list-item v="Ardèche"/>
<!--      <list-item v="Vivarais"/> -->
      <list-item v="Var"/>
      <list-item v="Bourgogne"/>
      <list-item v="Lorraine"/>
      <list-item v="Alsace"/>
      <list-item v="Grande-Bretagne"/>
      <list-item v="Angleterre"/>
      <list-item v="Yorkshire"/>
      <list-item v="Lancashire"/>
      <list-item v="Lincolnshire"/>
      <list-item v="Essex"/>
      <list-item v="Middlesex"/>
      <list-item v="Wessex"/>
      <list-item v="Sussex"/>
      <list-item v="Suffolk"/>
      <list-item v="Devon"/>
      <list-item v="Hampshire"/>
      <list-item v="Cornouaille"/>
      <list-item v="Cornouailles"/>
      <list-item v="Pays de Galles"/>
      <list-item v="Écosse"/>
      <list-item v="Irlande"/>
      <list-item v="Benelux"/>
      <list-item v="Belgique"/>
      <list-item v="Wallonie"/>
      <list-item v="Flandre"/>
      <list-item v="Luxembourg"/>
      <list-item v="Hollande"/>
      <list-item v="Frise"/>
      <list-item v="Allemagne"/>
      <list-item v="Bavière"/>
      <list-item v="Brandenbourg"/>
      <list-item v="Poméranie"/>
      <list-item v="Saxe"/>
      <list-item v="Saxe-Anhalt"/>
      <list-item v="Basse-Saxe"/>
      <list-item v="Franconie"/>
      <list-item v="Basse-Franconie"/>
      <list-item v="Haute-Franconie"/>
      <list-item v="Moyenne-Franconie"/>
      <list-item v="Souabe"/>
      <list-item v="Thuringe"/>
      <list-item v="Schleswig-Holstein"/>
      <list-item v="Schleswig"/>
      <list-item v="Holstein"/>
      <list-item v="Sorabie"/>
      <list-item v="Lusace"/>
      <list-item v="Haute-Lusace"/>
      <list-item v="Basse-Lusace"/>
      <list-item v="Prusse"/>
      <list-item v="Prusse-Orientale"/>
      <list-item v="Danemark"/>
      <list-item v="Jutland"/>
      <list-item v="Islande"/>
      <list-item v="Norvège"/>
      <list-item v="Suède"/>
      <list-item v="Finlande"/>
      <list-item v="Laponie"/>
      <list-item v="Prussie"/>
      <list-item v="Russie"/>
      <list-item v="Carélie"/>
      <list-item v="Tchétchénie"/>
      <list-item v="Ingouchie"/>
      <list-item v="Kabardino-Balkarie"/>
      <list-item v="Karatchaïévo-Tcherkessie"/>
      <list-item v="Adyguée"/>
      <list-item v="Ossétie"/>
      <list-item v="Ossétie du Nord"/>
      <list-item v="Ossétie du Nord-Alanie"/>
      <list-item v="Ossétie du Sud"/>
      <list-item v="Alanie"/>
      <list-item v="Tchouvachie"/>
      <list-item v="Tatarstan"/>
      <list-item v="Bashkortostan"/>
      <list-item v="Oudmourtie"/>
      <list-item v="Mordovie"/>
      <list-item v="Kalmoukie"/>
      <list-item v="Touva"/>
      <list-item v="Bouriatie"/>
      <list-item v="Iakoutie"/>
      <list-item v="Yakoutie"/>
      <list-item v="Kamtchatka"/>
      <list-item v="Kouban"/>
      <list-item v="Koubane"/>
      <list-item v="Estonie"/>
      <list-item v="Lettonie"/>
      <list-item v="Lituanie"/>
      <list-item v="Livonie"/>
      <list-item v="Pologne"/>
      <list-item v="Silésie"/>
      <list-item v="Tchécoslovaquie"/>
      <list-item v="Tchéquie"/>
      <list-item v="Bohême"/>
      <list-item v="Moravie"/>
      <list-item v="Slovaquie"/>
      <list-item v="Hongrie"/>
      <list-item v="Autriche"/>
      <list-item v="Suisse"/>
      <list-item v="Tessin"/>
      <list-item v="Italie"/>
      <list-item v="Ligurie"/>
<!--      <list-item v="Piémont"/> -->
      <list-item v="Lombardie"/>
      <list-item v="Émilie-Romagne"/>
      <list-item v="Émilie"/>
      <list-item v="Romagne"/>
<!--      <list-item v="Toscane"/> -->
      <list-item v="Campanie"/>
      <list-item v="Calabre"/>
      <list-item v="Sardeigne"/>
      <list-item v="Sicile"/>
      <list-item v="Sicile"/>
      <list-item v="Slovénie"/>
      <list-item v="Croatie"/>
      <list-item v="Serbie"/>
      <list-item v="Bosnie"/>
      <list-item v="Bosnie-Herzégovine"/>
      <list-item v="Herzégovine"/>
      <list-item v="Monténegro"/>
      <list-item v="Macédoine"/>
      <list-item v="Albanie"/>
      <list-item v="Roumanie"/>
      <list-item v="Bulgarie"/>
      <list-item v="Grèce"/>
      <list-item v="Ukraine"/>
      <list-item v="Crimée"/>
      <list-item v="Galicie"/>
      <list-item v="Podolie"/>
      <list-item v="Biélorussie"/>
      <list-item v="Moldavie"/>
      <list-item v="Transdnistrie"/>
      <list-item v="Turquie"/>
      <list-item v="Cappadoce"/>
      <list-item v="Syrie"/>
      <list-item v="Kurdistan"/>
      <list-item v="Arménie"/>
      <list-item v="Géorgie"/>
      <list-item v="Abkhazie"/>
      <list-item v="Colchide"/>
      <list-item v="Ibérie"/>
      <list-item v="Azerbaïdjan"/>
      <list-item v="Kazakhstan"/>
      <list-item v="Turkménistan"/>
      <list-item v="Ouzbékistan"/>
      <list-item v="Kirghizistan"/>
      <list-item v="Kirghizie"/>
      <list-item v="Tadjikistan"/>
      <list-item v="Iran"/>
      <list-item v="Iraq"/>
      <list-item v="Irak"/>
      <list-item v="Arabie"/>
      <list-item v="Arabie saoudite"/>
      <list-item v="Jordanie"/>
      <list-item v="Syrie"/>
<!--      <list-item v="Liban"/> -->
<!--      <list-item v="Yémen"/> -->
      <list-item v="Koweït"/>
      <list-item v="Qatar"/>
      <list-item v="Émirats arabes unis"/>
      <list-item v="Afghanistan"/>
      <list-item v="Pakistan"/>
      <!-- <list-item v="Inde"/> -->
      <!-- <list-item v="Gujarat"/> -->
      <list-item v="Maharashtra"/>
      <list-item v="Bengale"/>
      <!-- <list-item v="Népal"/> -->
      <!-- <list-item v="Boutan"/> -->
      <!-- <list-item v="Tibet"/> -->
      <list-item v="Chine"/>
      <list-item v="Mandchourie"/>
      <list-item v="Hubei"/>
      <list-item v="Xinjiang"/>
      <list-item v="Wuhan"/>
      <list-item v="Corée"/>
      <list-item v="Corée du Nord"/>
      <list-item v="Corée du Sud"/>
      <!-- <list-item v="Japon"/> -->
      <list-item v="Viêtnam"/>
      <list-item v="Tonkin"/>
      <list-item v="Annam"/>
      <list-item v="Cochinchine"/>
      <list-item v="Cambodge"/>
      <list-item v="Birmanie"/>
      <list-item v="Myanmar"/>
      <list-item v="Laos"/>
      <list-item v="Taïlande"/>
      <list-item v="Indonésie"/>
      <list-item v="Malaisie"/>
      <list-item v="Sarawak"/>
      <list-item v="Bornéo"/>
      <list-item v="Bangladesh"/>
      <list-item v="Sri-Lanka"/>
      <list-item v="Sri Lanka"/>
      <list-item v="Marroc"/>
      <list-item v="Numidie"/>
<!--      <list-item v="Canaries"/> -->
      <list-item v="Mauritanie"/>
      <list-item v="Algérie"/>
      <list-item v="Tunisie"/>
      <list-item v="Libye"/>
      <list-item v="Égypte"/>
      <list-item v="Nubie"/>
      <list-item v="Burkina"/>
      <list-item v="Burkina Faso"/>
      <list-item v="Mali"/>
      <list-item v="Niger"/>
      <list-item v="Nigéria"/>
      <list-item v="Biafra"/>
      <list-item v="Tchad"/>
      <list-item v="Sénégal"/>
      <list-item v="Gambie"/>
      <list-item v="Sierra Leone"/>
      <list-item v="Côte d'Ivoire"/>
      <list-item v="Ghana"/>
      <list-item v="Liberia"/>
      <list-item v="Togo"/>
      <list-item v="Guinée"/>
      <list-item v="Guinée-Bissau"/>
      <list-item v="Guinée équatoriale"/>
      <list-item v="Bénin"/>
<!--      <list-item v="Cameroun"/> -->
      <list-item v="Gabon"/>
      <list-item v="Éthiopie"/>
      <list-item v="Érythrée"/>
      <list-item v="Somalie"/>
      <list-item v="Zaïre"/>
      <list-item v="Rwanda"/>
      <list-item v="Burundi"/>
      <list-item v="Ouganda"/>
      <list-item v="Kenya"/>
      <list-item v="Tanzanie"/>
      <list-item v="Malawi"/>
      <list-item v="Lesotho"/>
      <list-item v="Botswana"/>
      <list-item v="Zimbabwe"/>
      <list-item v="Namibie"/>
      <list-item v="Zambie"/>
      <list-item v="Swaziland"/>
      <list-item v="Angola"/>
      <list-item v="Mozambique"/>
      <list-item v="Groenland"/>
      <list-item v="Canada"/>
      <list-item v="Manitoba"/>
      <list-item v="Ontario"/>
      <list-item v="Québec"/>
      <list-item v="Saskatchewan"/>
      <list-item v="Nouvelle-Orléans"/>
      <list-item v="Alabama"/>
      <list-item v="Alaska"/>
      <list-item v="Arkansas"/>
      <list-item v="Arizona"/>
      <list-item v="Californie"/>
      <list-item v="Caroline du Nord"/>
      <list-item v="Caroline du Sud"/>
      <list-item v="Connecticut"/>
      <list-item v="Dakota"/>
      <list-item v="Dakota du Nord"/>
      <list-item v="Dakota du Sud"/>
      <list-item v="Delaware"/>
      <list-item v="Floride"/>
      <list-item v="Idaho"/>
      <list-item v="Illinois"/>
      <list-item v="Iowa"/>
      <list-item v="Kansas"/>
      <list-item v="Kentucky"/>
      <list-item v="Louisiane"/>
      <list-item v="Maine"/>
      <list-item v="Maryland"/>
      <list-item v="Massachusetts"/>
      <list-item v="Michigan"/>
      <list-item v="Minnesota"/>
      <list-item v="Montana"/>
      <list-item v="New Hampshire"/>
      <list-item v="New Jersey"/>
      <list-item v="Nebraska"/>
      <list-item v="Nevada"/>
      <list-item v="Montana"/>
      <list-item v="Oklahoma"/>
      <list-item v="Ohio"/>
      <list-item v="Oregon"/>
      <list-item v="Pennsylvanie"/>
      <list-item v="Tennessee"/>
      <list-item v="Texas"/>
      <list-item v="Utah"/>
      <list-item v="Vermont"/>
      <list-item v="Virginie"/>
      <list-item v="Virginie-Occidentale"/>
      <list-item v="Wisconsin"/>
      <list-item v="Mexique"/>
      <list-item v="République dominicaine"/>
      <list-item v="Belize"/>
      <list-item v="Guatemala"/>
      <list-item v="Honduras"/>
      <list-item v="Nicaragua"/>
      <list-item v="Costa Rica"/>
      <list-item v="Panama"/>
      <list-item v="Barbade"/>
      <list-item v="Colombie"/>
      <list-item v="Vénézuéla"/>
      <list-item v="Venezuela"/>
      <list-item v="Brésil"/>
      <list-item v="Équateur"/>
      <list-item v="Pérou"/>
      <list-item v="Nouvelle-Castille"/>
      <list-item v="Chili"/>
      <list-item v="Argentine"/>
      <list-item v="Bolivie"/>
      <list-item v="Paraguay"/>
      <list-item v="Uruguay"/>
    </def-list>

    <def-list n="lang_dial">
      <list-item v="portugais"/>
      <list-item v="espagnol"/>
      <list-item v="catalan"/>
      <list-item v="valencien"/>
      <list-item v="majorquin"/>
      <list-item v="minorquin"/>
      <list-item v="ibizois"/>
      <list-item v="baléare"/>
      <list-item v="alguérois"/>
      <list-item v="roussillonnais"/>
      <list-item v="aragonais"/>
      <list-item v="asturien"/>
      <list-item v="léonais"/>
      <list-item v="mirandais"/>
      <list-item v="basque"/>
      <list-item v="castillan"/>
      <list-item v="andalou"/>
      <list-item v="mozarabe"/>
      <list-item v="français"/>
      <list-item v="breton"/>
      <list-item v="normand"/>
      <list-item v="picard"/>
      <list-item v="chti"/>
      <list-item v="ch'ti"/>
      <list-item v="alsacien"/>
      <list-item v="bourgonde"/>
      <list-item v="bourguignon"/>
      <list-item v="occitan"/>
      <list-item v="aranais"/>
      <list-item v="corse"/>
      <list-item v="auvergnat"/>
      <list-item v="limousin"/>
      <list-item v="gascon"/>
      <list-item v="béarnais"/>
      <list-item v="languedocien"/>
      <list-item v="provençal"/>
      <list-item v="niçois"/>
      <list-item v="savoyard"/>
      <list-item v="luxembourgeois"/>
      <list-item v="anglais"/>
      <list-item v="écossais"/>
      <list-item v="gallois"/>
      <list-item v="mannois"/>
      <list-item v="cornique"/>
      <list-item v="irlandais"/>
      <list-item v="wallon"/>
      <list-item v="flamand"/>
      <list-item v="hollandais"/>
      <list-item v="brabançon"/>
      <list-item v="limbourgeois"/>
      <list-item v="frison"/>
      <list-item v="allemand"/>
      <list-item v="bavarois"/>
      <list-item v="souabe"/>
      <list-item v="burgonde"/>
      <list-item v="danois"/>
      <list-item v="islandais"/>
      <list-item v="norvégien"/>
      <list-item v="suédois"/>
      <list-item v="finlandais"/>
      <list-item v="finnois"/>
      <list-item v="carélien"/>
      <list-item v="russe"/>
      <list-item v="slave"/>
      <list-item v="tchétchène"/>
      <list-item v="ingouche"/>
      <list-item v="karatchaï"/>
      <list-item v="balkar"/>
      <list-item v="ossète"/>
      <list-item v="tchouvache"/>
      <list-item v="tatar"/>
      <list-item v="tatare"/>
      <list-item v="bachkir"/>
      <list-item v="oudmourte"/>
      <list-item v="mordve"/>
      <list-item v="khanty"/>
      <list-item v="mansi"/>
      <list-item v="kalmouk"/>
      <list-item v="yakoute"/>
      <list-item v="iakoute"/>
      <list-item v="khakasse"/>
      <list-item v="touvinien"/>
      <list-item v="altaïen"/>
      <list-item v="nogaï"/>
      <list-item v="estonien"/>
      <list-item v="letton"/>
      <list-item v="lithuanien"/>
      <list-item v="balte"/>
      <list-item v="polonais"/>
      <list-item v="juif"/>
      <list-item v="sorabe"/>
      <list-item v="cachoube"/>
      <list-item v="tchèque"/>
      <list-item v="slovaque"/>
      <list-item v="hongrois"/>
      <list-item v="italien"/>
      <list-item v="sarde"/>
      <list-item v="piémontais"/>
      <list-item v="lombard"/>
      <list-item v="émilien"/>
      <list-item v="romagnol"/>
      <list-item v="ligurien"/>
      <list-item v="ligure"/>
      <list-item v="génois"/>
      <list-item v="sicilien"/>
      <list-item v="napolitain"/>
      <list-item v="calabrais"/>
      <list-item v="toscan"/>
      <list-item v="vénitien"/>
      <list-item v="istriote"/>
      <list-item v="frioulan"/>
      <list-item v="maltais"/>
      <list-item v="slovène"/>
      <list-item v="dalmate"/>
      <list-item v="croate"/>
      <list-item v="serbe"/>
      <list-item v="bosnien"/>
      <list-item v="bosniaque"/>
      <list-item v="monténégrin"/>
      <list-item v="macédonien"/>
      <list-item v="roumain"/>
      <list-item v="moldave"/>
      <list-item v="bulgare"/>
      <list-item v="rom"/>
      <list-item v="romani"/>
      <list-item v="grec"/>
      <list-item v="béotien"/>
      <list-item v="étolien"/>
      <list-item v="phocidien"/>
      <list-item v="thessalien"/>
      <list-item v="ukrainien"/>
      <list-item v="biélorusse"/>
      <list-item v="moldave"/>
      <list-item v="turc"/>
      <list-item v="ottoman"/>
      <list-item v="kurde"/>
      <list-item v="arménien"/>
      <list-item v="géorgien"/>
      <list-item v="mingrélien"/>
      <list-item v="abkhaze"/>
      <list-item v="azerbaïdjanais"/>
      <list-item v="kazakh"/>
      <list-item v="karakalpak"/>
      <list-item v="turkmène"/>
      <list-item v="turcoman"/>
      <list-item v="ouzbek"/>
      <list-item v="kirghiz"/>
      <list-item v="tadjik"/>
      <list-item v="mongol"/>
      <list-item v="moghol"/>
      <list-item v="mogol"/>
      <list-item v="bouriate"/>
      <list-item v="mandchou"/>
      <list-item v="toungouse"/>
      <list-item v="ouïghour"/>
      <list-item v="cachemiri"/>
      <list-item v="cachemirien"/>
      <list-item v="baloutche"/>
      <list-item v="sindi"/>
      <list-item v="sindhi"/>
      <list-item v="pendjabi"/>
      <list-item v="panjabi"/>
      <list-item v="punjabi"/>
      <list-item v="arabe"/>
      <list-item v="sarrasin"/>
      <list-item v="hébreu"/>
      <list-item v="cananéen"/>
      <list-item v="nabatéen"/>
      <list-item v="amazigh"/>
      <list-item v="amazighe"/>
      <list-item v="berbère"/>
      <list-item v="kabyle"/>
      <list-item v="touareg"/>
      <list-item v="copte"/>
      <list-item v="nubien"/>
      <list-item v="bengali"/>
      <list-item v="bengalais"/>
      <list-item v="marathe"/>
      <list-item v="gujarati"/>
      <list-item v="tamoul"/>
      <list-item v="tamil"/>
      <list-item v="télougou"/>
      <list-item v="cingalais"/>
      <list-item v="népalais"/>
      <list-item v="tibétain"/>
      <list-item v="chinois"/>
      <list-item v="cantonais"/>
      <list-item v="japonais"/>
      <list-item v="aïnou"/>
      <list-item v="coréen"/>
      <list-item v="vietnamien"/>
      <list-item v="thaïlandais"/>
      <list-item v="birman"/>
      <list-item v="laotien"/>
      <list-item v="cambodgien"/>
      <list-item v="khmer"/>
      <list-item v="malais"/>
      <list-item v="tagal"/>
      <list-item v="indonésien"/>
      <list-item v="javanais"/>
      <list-item v="taïwanais"/>
      <list-item v="hawaïen"/>
      <list-item v="tahitien"/>
      <list-item v="samoan"/>
      <list-item v="tongan"/>
      <list-item v="nauruan"/>
      <list-item v="maori"/>
      <list-item v="éthiopien"/>
      <list-item v="somalien"/>
      <list-item v="malgache"/>
      <list-item v="wolof"/>
      <list-item v="peul"/>
      <list-item v="bambara"/>
      <list-item v="mandingue"/>
      <list-item v="songhaï"/>
      <list-item v="haoussa"/>
      <list-item v="yoruba"/>
      <list-item v="igbo"/>
      <list-item v="bantou"/>
      <list-item v="swahili"/>
      <list-item v="zoulou"/>
      <list-item v="hottentot"/>
      <list-item v="bochiman"/>
      <list-item v="apache"/>
      <list-item v="algonquien"/>
      <list-item v="algonquin"/>
      <list-item v="chinook"/>
      <list-item v="cherokee"/>
      <list-item v="chéroki"/>
      <list-item v="tchéroki"/>
      <list-item v="mohawk"/>
      <list-item v="huron"/>
      <list-item v="iroquois"/>
      <list-item v="comanche"/>
      <list-item v="navajo"/>
      <list-item v="creek"/>
      <list-item v="kiowa"/>
      <list-item v="esquimau"/>
      <list-item v="mapuche"/>
      <list-item v="gaulois"/>
      <list-item v="ibère"/>
      <list-item v="celtibère"/>
      <list-item v="étrusque"/>
      <list-item v="latin"/>
      <list-item v="sabin"/>
      <list-item v="ombrien"/>
      <list-item v="osque"/>
      <list-item v="thrace"/>
      <list-item v="illyrien"/>
      <list-item v="troyen"/>
      <list-item v="lydien"/>
      <list-item v="phrygien"/>
      <list-item v="sogdien"/>
      <list-item v="bactrien"/>
      <list-item v="perse"/>
      <list-item v="persan"/>
      <list-item v="sumérien"/>
      <list-item v="akkadien"/>
      <list-item v="nabatéen"/>
      <list-item v="araméen"/>
    </def-list>
  </section-def-lists>

  <section-def-macros>

  <def-macro n="f_prn_prn" npar="2">
<!-- analiza els dos pronoms (típicament CD i CI) i, si cal, en canvia l'ordre -->
     <choose>
<!-- opcio valenciana
      <when>
        <test>
          <and>
            <equal><clip pos="1" side="sl" part="lem"/><lit v="le"/></equal>
            <equal><clip pos="2" side="sl" part="lem"/><lit v="lui"/></equal>
         </and>
        </test>
        <let><clip pos="1" side="tl" part="whole"/><clip pos="2" side="tl" part="whole"/></let>
        <let><clip pos="2" side="tl" part="whole"/><clip pos="1" side="tl" part="whole"/></let>
      </when>
-->
<!-- opcio principatina
-->
      <when>
        <test>
          <and>
            <equal><clip pos="1" side="sl" part="lem"/><lit v="le"/></equal>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="f"/></equal>
            <equal><clip pos="2" side="sl" part="lem"/><lit v="lui"/></equal>
         </and>
        </test>
        <let><clip pos="2" side="tl" part="whole"/><concat><lit v="hi"/><lit-tag v="prn.pro.adv"/></concat></let>
      </when>
      <when>
        <test>
          <and>
            <equal><clip pos="1" side="sl" part="lem"/><lit v="le"/></equal>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
            <equal><clip pos="2" side="sl" part="lem"/><lit v="lui"/></equal>
         </and>
        </test>
        <let><clip pos="2" side="tl" part="whole"/><concat><lit v="hi"/><lit-tag v="prn.pro.adv"/></concat></let>
      </when>
      <when>
        <test>
          <and>
            <equal><clip pos="1" side="sl" part="lem"/><lit v="le"/></equal>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="nt"/></equal>
            <equal><clip pos="2" side="sl" part="lem"/><lit v="lui"/></equal>
         </and>
        </test>
        <let><var n="aux"/><clip pos="1" side="tl" part="whole"/></let>
        <let><clip pos="1" side="tl" part="whole"/><clip pos="2" side="tl" part="whole"/></let>
        <let><clip pos="2" side="tl" part="whole"/><var n="aux"/></let>
      </when>
    </choose>
  </def-macro>

  <def-macro n="f_ifi1" npar="1">
     <choose>
      <when>
        <test><equal><clip pos="1" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
        <let><clip pos="1" side="tl" part="whole"/>
             <concat><get-case-from pos="1"><lit v="anar"/></get-case-from><lit-tag v="vaux"/><clip pos="1" side="tl" part="persona"/><clip pos="1" side="tl" part="nbr"/>
                <lit v="$ ^"/><clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/><lit-tag v="inf"/>
                <clip pos="1" side="tl" part="lemq"/></concat></let>
      </when>
      <otherwise>
        <let><clip pos="1" side="tl" part="whole"/>
             <concat><clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/></concat></let>
      </otherwise>
    </choose>
  </def-macro>

    <def-macro n="f_maj_gentilici" npar="1">
<!-- si es tracta d'un gentilici, traiem la majúscula -->
<!-- p1 = det, p2 = n -->
      <choose>
        <when>
          <test>
            <and>
              <in caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <list n="lang_dial"/>
              </in>
              <equal>
                <case-of pos="1" side="sl" part="lem"/>
                <lit v="Aa"/>
              </equal>
            </and>
          </test>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="aa"/>
          </modify-case>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_bcond" npar="2">
<!--Para mirar si el blanco contiene o no formato, y enviarlo sólo si tiene formato (para reglas en las que se elimine una o más palabras) -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>


    <def-macro n="test_pr_i_verb" npar="2">
<!--Para comprobar según la preposición y el verbo, qué traducción hay que enviar -->
      <choose>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="venir"/>
              </equal>
	       <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v="de"/>
              </equal>
            </and>
          </test>
	  <let>
	   <clip pos="1" side="tl" part="lem"/>
           <lit v="acabar"/>
	  </let>
        </when>
      </choose>
    </def-macro>


    <def-macro n="f_concord_pedac" npar="1">
<!--Pedaç totalment ad-hoc per solucionar problemes amb l'assignació del gènere i nombre a heureux, joyeux > feliç -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="tl" part="lem"/><lit v="feliç"/></equal>
              <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></equal>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <or>
              <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
              <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.nopron"/></equal>
            </or>
          </test>
          <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
        </when>
      </choose>
    </def-macro>


    <def-macro n="f_concord0" npar="1">
      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord1" npar="1">
      <call-macro n="f_concord0"><with-param pos="1"/></call-macro>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
    </def-macro>

    <def-macro n="f_concord2" npar="2">
      <call-macro n="f_concord0"><with-param pos="1"/></call-macro>
      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <not>
                  <or>
                    <equal>
                      <var n="genero"/>
                      <lit-tag v="m"/>
                    </equal>
                    <equal>
                      <var n="genero"/>
                      <lit-tag v="f"/>
                    </equal>
                  </or>
                </not>
              </test>
              <let>
                <var n="genero"/>
                <lit-tag v="m"/>
              </let>
            </when>
          </choose>
        </otherwise>
      </choose>
      <choose>
        <when>
<!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
            <equal>
              <clip pos="2" side="tl" part="a_num"/>
              <lit-tag v="num"/>
            </equal>
            <not>
            <equal>
              <clip pos="2" side="tl" part="lem"/>
              <lit v="1"/>
            </equal>
            </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
    </def-macro>

    <def-macro n="f_concord3" npar="3">
      <choose>
<!-- Look whether in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look whether in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="3"/></call-macro>
    </def-macro>

    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="3"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="4"/></call-macro>
    </def-macro>

    <def-macro n="f_unset_nopron" npar="1"> <!-- elimina nopron a vblex.nopron -->
      <choose>
	<when>
	  <test>
	    <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.nopron"/></equal>
	  </test>
	  <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_set_pron" npar="2"> <!-- posa a la variable 'pronom' el pronom reflexiu que calgui si el verb és reflexiu. El segon paramàtre és la repetició del primer, si és una forma conjugada (personal) del verb, altrament és l'auxiliar-->
      <call-macro n="f_unset_nopron"><with-param pos="1"/></call-macro>
      <let>
	<var n="pronom"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
	  </test>
      <choose>
	    <when>
	      <test>
	        <equal><clip pos="2" side="tl" part="persona"/><lit-tag v="p3"/></equal>
	      </test>
	      <append n="pronom">
	        <lit v="^"/>
                <get-case-from pos="1">
                  <lit v="es"/>
                </get-case-from>
	        <lit-tag v="prn.pro.ref.p3.mf.sp"/>
	        <lit v="$"/>
	      </append>	
	    </when>
	    <otherwise>
	      <append n="pronom">
	        <lit v="^"/>
                <get-case-from pos="1">
                  <lit v="prpers"/>
                </get-case-from>
	        <lit-tag v="prn.pro"/>
                <clip pos="2" side="tl" part="persona"/>
	        <lit-tag v="mf"/>
	        <clip pos="1" side="tl" part="nbr"/>
	        <lit v="$"/>
	      </append>	
	    </otherwise>
          </choose>
          <!-- ara arreglem la majúscula del verb, si cal -->
          <choose>
            <when>
              <test>
                <equal>
                   <case-of pos="1" side="sl" part="lem"/>
                   <lit v="Aa"/>
                 </equal>
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
	  <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
	</when>
	<when>
	  <test>
	    <and>
	      <or>
	        <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="aimer"/></equal>
	        <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="kiffer"/></equal>
	      </or>
	      <or>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="agradar"/></equal>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="agradar_pl"/></equal>
	      </or>
	      <or>
	        <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p1"/></equal>
	        <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p2"/></equal>
	        <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p3"/></equal>
	      </or>
	    </and>
	  </test>
      <choose>
        <when>
	      <test>
	        <equal><clip pos="2" side="tl" part="persona"/><lit-tag v="p3"/></equal>
	      </test>
	      <append n="pronom">
	        <lit v="^"/>
                <get-case-from pos="1">
                  <lit v="li"/>
                </get-case-from>
	        <lit-tag v="prn.pro.p3.mf"/>
	        <clip pos="1" side="tl" part="nbr"/>
	        <lit v="$"/>
	      </append>	
	    </when>
	    <otherwise>
	      <append n="pronom">
	        <lit v="^"/>
                <get-case-from pos="1">
                  <lit v="prpers"/>
                </get-case-from>
	        <lit-tag v="prn.pro"/>
                <clip pos="2" side="tl" part="persona"/>
	        <lit-tag v="mf"/>
	        <clip pos="1" side="tl" part="nbr"/>
	        <lit v="$"/>
	      </append>	
	    </otherwise>
      </choose>
	  <let><clip pos="2" side="tl" part="persona"/><lit-tag v="p3"/></let>
	  <choose>
        <when>
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="agradar_pl"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
	      <let>
	        <clip pos="1" side="tl" part="lemh"/>
            <get-case-from pos="1">
               <lit v="agradar"/>
             </get-case-from>
          </let>
        </when>
        <otherwise>
	      <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </otherwise>
	  </choose>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_set_pron_enc" npar="1"> <!-- posa a la variable 'pronom' el pronom reflexiu enclític 'es´ si el verb és reflexiu -->
      <let>
	<var n="pronom"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
	  </test>
	  <append n="pronom">
	    <lit v="es"/>
	    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
	  </append>	
	  <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="print_pron" npar="0"> <!-- escriu la variable 'pronom' -->
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
	      <var n="pronom"/>
              <b/>
<!--
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
-->
            </out>
	  </when>
        </choose>
    </def-macro>

  </section-def-macros>

  <section-rules>
<!--regles de concordança-->
    <rule comment="REGLA: DETERMINANT">
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NOM">
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: commeprep (per impedir el la reinicialització de les variables)">
      <pattern>
        <pattern-item n="commeprep"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREP">
      <pattern>
        <pattern-item n="prep"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjsub">
      <pattern>
        <pattern-item n="cnjsub"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjadv">
      <pattern>
        <pattern-item n="cnjadv"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: chez + prn.tn = a ca + adj.pos: chez moi > a casa meva">
      <pattern>
        <pattern-item n="chez"/>
	<pattern-item n="moi_toi_etc"/>
      </pattern>
      <action>
        <choose>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="moi"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="meu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="toi"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="teu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="lui"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="seu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="il"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="seu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="soi"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="seu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="nous"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="nostre"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="vos"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="vostre"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="eux"/></equal></test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="seu"/></let>
	  </when>
        </choose>
        <out>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="casa"/>
            <lit-tag v="n.f.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <lit-tag v="adj.pos.f.sg"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: en + nom = en + nom: en français -> en francès (per a evitar la generació de plurals)">
      <pattern>
        <pattern-item n="enprep"/>
        <pattern-item n="n_sp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRNSUBJ">
      <pattern>
        <pattern-item n="prnsubj"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NP">
      <pattern>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: VBSER">
      <pattern>
        <pattern-item n="vbser"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: CE + VBSER > VBSER">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="vbserp3"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: VERBnoserconj (per a multiparaules + verbs pronominals)">
      <pattern>
        <pattern-item n="verbnoserconj"/>
      </pattern>
      <action>
        <call-macro n="f_set_pron">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="print_pron">
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: VERBnoser_inf_ger (per a multiparaules + verbs pronominals)">
      <pattern>
        <pattern-item n="verbnoser_inf_ger"/>
      </pattern>
      <action>
        <call-macro n="f_unset_nopron"><with-param pos="1"/></call-macro>
        <call-macro n="f_set_pron_enc"><with-param pos="1"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <mlu>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tags"/>
                </lu>
                <lu>
	          <var n="pronom"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </mlu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: AUXPP">
      <pattern>
        <pattern-item n="auxpp"/>
      </pattern>
      <action>
        <!-- haver# de, etc. no té formes -->
        <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
        <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ">
      <pattern>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <or>
                <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
                <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.nopron"/></equal>
              </or>
            </test>
            <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal><clip pos="1" side="tl" part="a_adjec"/><lit-tag v="vblex.pp"/></equal>
                <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </and>
            </test>
            <let><clip pos="1" side="tl" part="gen"/><lit-tag v="GD"/></let>
            <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></let>
          </when>
          <when>
            <test>
              <or>
	        <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="nombreux"/></equal>
	        <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="beaucoup"/></equal>
              </or>
            </test>
            <let><var n="numero"/><lit-tag v="pl"/></let>
          </when>
        </choose>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_adjec"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


     <rule comment="REGLA: plus/moins ADJ/ADV que moi: plus rapide que moi > més ràpid que jo">
      <pattern>
        <pattern-item n="plus_moins"/>
        <pattern-item n="adjec_adv"/>
        <pattern-item n="que"/>
	<pattern-item n="moi_toi_etc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
	  <when>
	    <test><equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="moi"/></equal></test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="jo"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="toi"/></equal></test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="tu"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="lui"/></equal></test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="ell"/></let>
	  </when>
	  <when>
	    <test><equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="eux"/></equal></test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="ell"/></let>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
          <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
          <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="4">
              <clip pos="4" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="4" side="tl" part="tags"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: ce livre-ci >> aquest llibre, ce livre-là >> aquell llibre">
      <pattern>
        <pattern-item n="ce_det"/>
        <pattern-item n="nom"/>
        <pattern-item n="ci_la"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="lem"/><lit v="ci"/></equal>
              </test>
            <out>
              <lu>
                <lit v="aquest"/>
                <lit-tag v="det.dem"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <lit v="aquell"/>
                <lit-tag v="det.dem"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: est-ce que > 0">
      <pattern>
        <pattern-item n="est-ce_que"/>
      </pattern>
      <action>
      </action>
    </rule>

    <rule comment="REGLA: PRONOM">
<!--Special case, macro f_concord1
is not applicable because gender and number cannot be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

    <rule comment="REGLA: un milliard > mil milions">
      <pattern>
        <pattern-item n="un_detmsg"/>
        <pattern-item n="milliard"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NUMERAL">
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: RELATIF">
      <pattern>
        <pattern-item n="rel"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREP RELATIF">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="lequel"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: l'un de > un de">
      <pattern>
        <pattern-item n="le"/>
        <pattern-item n="unpron"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: DETERMINANT NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
    	    <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
    	    <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
	        <equal><clip pos="1" side="sl" part="lem"/><lit v="1er"/></equal>
                <in caseless="yes"><clip pos="2" side="sl" part="lem"/><list n="mois"/></in>
              </and>
            </test>
            <out>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
            	<clip pos="2" side="tl" part="a_nom"/>
            	<clip pos="2" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
	    <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
	    <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
	    <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
	        <equal><clip pos="2" side="sl" part="lem"/><lit v="1er"/></equal>
                <in caseless="yes"><clip pos="3" side="sl" part="lem"/><list n="mois"/></in>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
            	<clip pos="3" side="tl" part="a_nom"/>
            	<clip pos="3" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
                <or>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="siècle"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="millennaire"/></equal>
                </or>
                <equal><clip pos="2" side="sl" part="gen"/><lit-tag v="mf"/></equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemg"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="sacré"/></equal>
                <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="del dimoni"/></equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
	        <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: PREDET DET NOM">
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREDET DET NOM ADJ">
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici"> <!-- problemes de mala anàsi en el cas p.ex. de: "l'Italien NomInconnu" -->
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM ADJ">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NOM ADV ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
	    <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NUMERAL NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="mois"/>
              </in>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
            	<clip pos="2" side="tl" part="a_nom"/>
            	<clip pos="2" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: NUMERAL ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NUMERAL NOM ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
       	    <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NUMERAL ADJ NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
	    <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUMERAL NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <list n="mois"/>
              </in>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
            	<clip pos="3" side="tl" part="a_nom"/>
            	<clip pos="3" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: DET NUMERAL ADJ NOM : ses trois premiers romans > les seves tres primeres novel·les">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

   <rule comment="REGLA: JOUR 1er MOIS (mercredi 1er novembre: dilluns 1 de novembre)">
      <pattern>
        <pattern-item n="jour_n"/>
        <pattern-item n="_1er"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
            	<clip pos="3" side="tl" part="a_nom"/>
            	<clip pos="3" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
      </action>
    </rule>

   <rule comment="REGLA: JOUR 1er MOIS NUM (mercredi 1er novembre 2004: dilluns 1 de novembre de 2004)">
      <pattern>
        <pattern-item n="jour_n"/>
        <pattern-item n="_1er"/>
        <pattern-item n="nom_mois"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
            	<clip pos="3" side="tl" part="a_nom"/>
            	<clip pos="3" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
      </action>
    </rule>

   <rule comment="REGLA: NUMERAL NOM NUM (20 novembre 1998: 20 de novembre de 1998)">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom_mois"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="mois"/>
              </in>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
            	<clip pos="2" side="tl" part="a_nom"/>
            	<clip pos="2" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

   <rule comment="REGLA: DET JOUR 1er MOIS (le mercredi 1er novembre: el dilluns 1 de novembre)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="jour_n"/>
        <pattern-item n="_1er"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
            	<clip pos="4" side="tl" part="a_nom"/>
            	<clip pos="4" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
      </action>
    </rule>

   <rule comment="REGLA: DET JOUR 1er MOIS NUM (le mercredi 1er novembre 2004: el dilluns 1 de novembre de 2004)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="jour_n"/>
        <pattern-item n="_1er"/>
        <pattern-item n="nom_mois"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="1"/>
                <lit-tag v="num"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
            	<clip pos="4" side="tl" part="a_nom"/>
            	<clip pos="4" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="4"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUMERAL NOM NUM (le 20 novembre 1998: el 20 de novembre de 1998)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom_mois"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <list n="mois"/>
              </in>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
            	<clip pos="3" side="tl" part="a_nom"/>
            	<clip pos="3" side="tl" part="gen"/>
            	<lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: début janvier > al començament de gener">
      <pattern>
        <pattern-item n="debut"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="al començament de"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    
    <rule comment="REGLA: fin janvier > al final de gener">
      <pattern>
        <pattern-item n="fin"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="al final de"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    
    <rule comment="REGLA: prep début janvier > prep el començament de gener">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="debut"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="el"/>
            <lit-tag v="det.def.m.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="començament"/>
            <lit-tag v="n.m.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    
    <rule comment="REGLA: prep fin janvier > prep el final de gener">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="fin"/>
        <pattern-item n="nom_mois"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="el"/>
            <lit-tag v="det.def.m.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="final"/>
            <lit-tag v="n.m.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    
    <rule comment="REGLA: DET NOM DET ADV ADJ: la fille la plus jolie : la noia més maca">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b pos="4"/>
          <lu>
	    <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_adjec"/>
            <clip pos="5" side="tl" part="gen"/>
            <clip pos="5" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NOM DET ADV ADJ: la cinq filles les plus jolies : les cinc noies més maques">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
          <b pos="5"/>
          <lu>
	    <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_adjec"/>
            <clip pos="6" side="tl" part="gen"/>
            <clip pos="6" side="tl" part="nbr"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

<!--fi regles de concordança-->

<!--regles per a eliminar el partitiu-->
    <rule comment="REGLA: SENT PREP DET NOM (sent Des enfants : sent Uns xiquets)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord1"><with-param pos="4"/></call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="un"/>
            </get-case-from>
            <lit-tag v="det.ind"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT PREP DET NOM ADJ (sent Des enfants : sent Uns xiquets)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="un"/>
            </get-case-from>
            <lit-tag v="det.ind"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT PREP DET ADJ NOM (sent Des grands enfants : sent Uns grans xiquets)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord2">
          <with-param pos="5"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="un"/>
            </get-case-from>
            <lit-tag v="det.ind"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT PREP ADJIND NOM (sent D'autres enfants : sent Altres xiquets)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adjindpl"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord1"><with-param pos="4"/></call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT PREP ADJIND NOM ADJ (sent D'autres enfants intelligents : sent Altres xiquets intel·ligents)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adjindpl"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT PREP ADJIND ADJ NOM (sent D'autres grands enfants : sent Altres grans xiquets)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adjindpl"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord2">
          <with-param pos="5"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DE NOMBREUX NOM (de nombreux enfants : molts xiquets)">
      <pattern>
        <pattern-item n="deprep"/>
        <pattern-item n="nombreux"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="molt"/>
            </get-case-from>
            <lit-tag v="adj"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DE NOMBREUX ET ADJ NOM (de nombreuses et profondes différencies : moltes i profundes diferències)">
      <pattern>
        <pattern-item n="deprep"/>
        <pattern-item n="nombreux"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="5"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="molt"/>
            </get-case-from>
            <lit-tag v="adj"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: APRES DE NOMBREUX NOM (après de nombreuses années :n després de molts xiquets)">
      <pattern>
        <pattern-item n="apres"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nombreux"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="molt"/>
            <lit-tag v="adj"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DE NOMBREUX ADJ NOM (de nombreux petits enfants : molts petits xiquets)">
      <pattern>
        <pattern-item n="deprep"/>
        <pattern-item n="nombreux"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="molt"/>
            </get-case-from>
            <lit-tag v="adj"/>
            <var n="genero"/>
            <var n="numero"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREP DE">
      <pattern>
        <pattern-item n="sur_avec"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA:PREP DE DET (avec des: amb)">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA:PREP DE ADJIND (avec d'autres: amb altres)">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adjindpl"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: depuis des années > des de fa anys">
      <pattern>
        <pattern-item n="depuis"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="unite_temps"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
               <lit v="fer"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA:PREP DE DET NOM (avec des mois: amb mesos)">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA:PREP DE ADJIND NOM (avec d'autres mois: amb altres mesos)">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adjindpl"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: jour (n) part_jour: lundi matin > el dilluns al matí">
      <pattern>
        <pattern-item n="jour_n"/>
        <pattern-item n="part_jour"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: jour (adv) part_jour: demain matin > demà al matí">
      <pattern>
        <pattern-item n="jour_adv"/>
        <pattern-item n="part_jour"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: de madame X > de la senyora X">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom_monsieur"/>
        <pattern-item n="npant_unk"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <clip pos="2" side="sl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: beaucoup de + pron > molts de + pron: beaucoup d'eux > molts d'ells, beaucoup d'elles > moltes d'elles">
    <!-- aquesta construcció no sembla gaire francesa, però afegida per si de cas -->
      <pattern>
        <pattern-item n="beaucoup_de"/>
        <pattern-item n="prntn"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: CELUI DE: celui de la gauche > el de l'esquerra">
      <pattern>
        <pattern-item n="celui"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def"/>
            <clip pos="1" side="sl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: beaucoup de + entre + pron > molts de + entre + pron: beaucoup d'entre eux > molts d'ells, beaucoup d'entre elles > moltes d'elles">
      <pattern>
        <pattern-item n="beaucoup_de"/>
        <pattern-item n="entreprep"/>
        <pattern-item n="prntn"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>


  <rule comment="REGLA: quelques/plusieurs de + pron > DET de + pron: quelques d'eux > alguns d'ells, quelques d'elles > algunes d'elles">
      <pattern>
        <pattern-item n="quelques_plusieurs"/>
        <pattern-item n="deprep"/>
        <pattern-item n="prntn"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: quelques/plusieurs de + entre + pron > DET de + entre + pron: quelques d'entre eux > alguns d'ells, quelques d'entre elles > algunes d'elles">
      <pattern>
        <pattern-item n="quelques_plusieurs"/>
        <pattern-item n="deprep"/>
        <pattern-item n="entreprep"/>
        <pattern-item n="prntn"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

<!-- REGLES VERBS QUE SÓN PRONOMINALS EN UNA LLENGUA PERÒ NO EN L'ALTRA -->

    <rule comment="Verbs pronominals en francès i no pronominals en català: infinitiu">
      <pattern>
        <pattern-item n="prnproref3"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="Verbs pronominals en francès i no pronominals en català: gerundi">
      <pattern>
        <pattern-item n="prnproref3"/>
        <pattern-item n="verbospron_ger"/>
      </pattern>
      <action>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="Verbs pronominals en francès i no pronominals en català: gerundi">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="prnproref3"/>
        <pattern-item n="verbospron_ger"/>
      </pattern>
      <action>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="Verbs pronominals en francès i no pronominals en català: formes personals">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <let>
                <clip pos="2" side="tl" part="whole"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="Verbs pronominals en francès i no pronominals en català: formes personals negatives">
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
            <let>
                <clip pos="3" side="tl" part="whole"/>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="whole"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule comment="Verbs pronominals en francés i no pronominals en català. Temps compostos">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="pascomp_ser"/>
        <pattern-item n="verbospron_pp"/>

      </pattern>
      <action>
        <choose>
          <when>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
<!--Para que traduzca "haber" como auxiliar (lo mismo que hace la regla HABER 3ª persona -->
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m.sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
            </out>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

<!-- FI REGLES VERBS QUE SÓN PRONOMINALS EN UNA LLENGUA PERÒ NO EN L'ALTRA -->

    <rule comment="REGLA: CE VBSER DES > VBSER">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="vbserp3"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: CE NE VBSER PAS DES > NO VBSER">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbserp3"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: CE VBSER ADV DES > VBSER ADV">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="vbserp3"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: CE NE VBSER PAS ADV DES > NO VBSER ADV">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbserp3"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="6"/><with-param pos="7"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: verb + de +  VERB PREP DET (venir de avoir des: acabar de tenir)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
      <call-macro n="test_pr_i_verb">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
	  <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>	
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
	    <clip pos="1" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
     </choose>	
      </action>
    </rule>

    <rule comment="REGLA: aller + INF (aller manger : anar a menjar)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="aller_venir"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="lemh"/>
	    <clip pos="2" side="tl" part="tags"/>
	    <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: aller + PRO + INF (aller en manger : anar a menjar-ne)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="aller_venir"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="inf"/>
      </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
	  <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="2"/>
          <mlu>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="tags"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="2" side="tl" part="tipoenc_pro"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: aller + ADV + INF (aller bien manger : anar a menjar bé)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="aller_venir"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="1"/>
	  <lu>
	    <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="tags"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="2" side="tl" part="lemh"/>
	    <clip pos="2" side="tl" part="tags"/>
	    <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: on + aller +  INF (on va manger : es va a menjar)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="tags"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: on + aller + PRO + INF (on va en manger : es va a menjar-ne)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="inf"/>
      </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
	  <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="3"/>
          <mlu>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="tags"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="3" side="tl" part="tipoenc_pro"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: on + aller + ADV * INF (on va bien manger : es anar a menjar bé)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="4" side="tl" part="lemh"/>
	    <clip pos="4" side="tl" part="tags"/>
	    <clip pos="4" side="tl" part="lemq"/>
          </lu>
	  <b pos="3"/>
	  <lu>
	    <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="tags"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: aller + prnsubj * INF (vont-ils manger : van a menjar)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="aller_venir"/>
        <pattern-item n="prnsubj"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
        </out>
        <choose>
          <when>
            <test>
              <equal><b pos="1"/><lit v="-"/></equal>
            </test>
            <out>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <out>
	  <lu>
	    <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="tags"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: verb +  VERB PREP DET (aller avoir des: tindrà)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="2" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
            <out>
              <lu>
	        <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
	        </get-case-from>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="fti"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	<otherwise>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
     </choose>	
      </action>
    </rule>

    <rule comment="REGLA:VERB PREP DET (avoir des: tenir)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

<!--
    <rule comment="REGLA:VERB PREP DET (mange de la: menjo)">
      <pattern>
        <pattern-item n="verb_partitiu"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefsg"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>
-->

    <rule comment="REGLA: verb de + VERB que PREP DET (venir d'avoir que des: acabar de tenir més que)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>	
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="test_pr_i_verb">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>	
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
	    <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


    <rule comment="REGLA: verb + VERB que PREP DET (aller avoir que des: tenir més que)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="2" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA:VERB que PREP DET (avoir que des: tenir més que)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


     <rule comment="REGLA: verb de + VERB toujours PREP DET (venir d'avoir toujours des: acabar de tenir sempre)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>	
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="test_pr_i_verb">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>	
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
	    <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
	    <lit-tag v="ger"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


    <rule comment="REGLA: verb + VERB toujours PREP DET (aller avoir toujours des: tenir sempre)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="2" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
          <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


    <rule comment="REGLA:VERB adv PREP DET (avoir toujours des: tenir encara)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


     <rule comment="REGLA: verb de + VERB toujours PREP DET (venir d'avoir toujours des: acabar de tenir sempre)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>	
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
	<pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="test_pr_i_verb">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>	
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
	    <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


    <rule comment="REGLA: verb + VERB aujourd'hui encore PREP DET (aller avoir ajourd'hui encore des: tenir hui encara)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
	<pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="1" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="2" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
	  <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>


    <rule comment="REGLA:VERB adv adv PREP DET (avoir auhjourd'hui encore des: tenir avui encara">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA: PRN VERB DES (il croit des choses, creu coses)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA: ON VERB DES (on croit des choses, es creuen coses)">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA: PRN VERB DE LE (il veut de l'eau: vol aigua)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb_partitiu"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefsg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
      </action>
    </rule>

    <rule comment="REGLA: ON VERB DE LE (on veut de l'eau: es vol aigua)">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="verb_partitiu"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefsg"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
      </action>
    </rule>

<!--
    <rule comment="REGLA:PRN VERBSER PP DE DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lemh"/>
                <list n="vbambser"/>
              </in>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>
-->

    <rule comment="REGLA:PRN NEADV VERB que DE DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA:ON NEADV VERB que DE DET">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <!-- partial reset of variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="pl"/></let>
      </action>
    </rule>

    <rule comment="REGLA: VBHAVER VBSERPP (ont été > han estat)">
      <pattern>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pp_m_sg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test><equal><clip pos="2" side="tl" part="gen"/><lit-tag v="GD"/></equal></test>
            <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test><equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="ND"/></equal></test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="1" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: NE VBHAVER VBSERPP QUE (n'ont été que > només han estat)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test><equal><clip pos="3" side="tl" part="gen"/><lit-tag v="GD"/></equal></test>
            <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test><equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="ND"/></equal></test>
            <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="només"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="només"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: PRN VBHAVER VBSERPP (ils ont été > han estat)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="vbserpp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN NE VBHAVER VBSERPP QUE (ils n'ont été que > només han estat)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="vbserpp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="4" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="4" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="només"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="3" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: VBHAVER ADV VBSERPP (ont toujours été > han estat sempre, ont pas éte > han estat)">
      <pattern>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="1" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="pas"/></equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <out>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA:PRN ADV VERB pas PREP DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV VERB pas adv PREP DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN VERB ADV PREP DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV VERB PREP DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: PRN VERB ADV ADV PREP DET">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

 <rule>
<!-- REGLA:PRN verb + VERB PREP DET je vais faire des voyages: faré viatges -->
      <pattern>
        <pattern-item n="prnsubj"/>
	<pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
          <lu>
	   <get-case-from pos="1">
            <clip pos="3" side="tl" part="lemh"/>
	   </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>
	<out>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
     </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule>
<!-- REGLA:PRN NEADV verb + VERB que PREP DET je ne vais faire que des voyages: no faré més que viatges-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
       <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="4" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="6"/>
              <lu>
                <clip pos="6" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN ADV VERB pas verb PREP DET je ne vais pas faire des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="5" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <clip pos="5" side="tl" part="persona"/>
            <clip pos="5" side="tl" part="gen"/>
            <clip pos="5" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="5"/>
              <lu>
                <clip pos="6" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN ADV VERB pas verb adv PREP DET je ne vais pas faire toujours des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="5" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
	  <lu>
	   <clip pos="6" side="tl" part="whole"/>
	  </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <clip pos="5" side="tl" part="persona"/>
            <clip pos="5" side="tl" part="gen"/>
            <clip pos="5" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
	  <lu>
	   <clip pos="6" side="tl" part="whole"/>
	  </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="6"/>
              <lu>
                <clip pos="7" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

     <rule>
<!-- REGLA:PRN ADV VERB pas verb adv PREP DET je ne vais pas toujours faire des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
	 <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="6" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
	  <lu>
	   <clip pos="5" side="tl" part="whole"/>
	  </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <clip pos="6" side="tl" part="temps"/>
            <clip pos="6" side="tl" part="persona"/>
            <clip pos="6" side="tl" part="gen"/>
            <clip pos="6" side="tl" part="nbr"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
	  <lu>
	   <clip pos="5" side="tl" part="whole"/>
	  </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="6" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="6" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="6" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="6"/>
              <lu>
                <clip pos="7" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN verb VERB adv PREP DET je vais faire encore des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
	<pattern-item n="verb"/>	
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
          <lu>
	  <get-case-from pos="1">
            <clip pos="3" side="tl" part="lemh"/>
	  </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
	  <get-case-from pos="1">
            <clip pos="2" side="tl" part="lem"/>
	  </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN adv verb VERB PREP DET je aujourd'hui vais faire des voyages -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="4" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	 <lu>
	   <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
	   </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>
	<out>
	 <lu>
	   <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
	   </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="whole"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
     </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN VERB adv adv PREP DET il va faire aujourd'hui encore des voyages -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
	<pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="aller"/>
	        </equal>
		<equal>
	           <clip pos="3" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
          <lu>
	    <get-case-from pos="1">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
          <get-case-from pos="1">
            <clip pos="2" side="tl" part="lem"/>
          </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>


 <rule>
<!-- REGLA:PRN verb + prep + VERB PREP DET je viens de faire des voyages: acabe de fer viatges -->
      <pattern>
        <pattern-item n="prnsubj"/>
	<pattern-item n="verb"/>
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      <call-macro n="test_pr_i_verb">
        <with-param pos="2"/>
        <with-param pos="3"/>
      </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="4" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
	  <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>	
	<out>
	  <lu>
	    <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="whole"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
     </choose>	
      </action>
    </rule>


    <rule>
<!-- REGLA:PRN NEADV verb + de + VERB que PREP DET je ne viens de faire que des voyages: no acabe de fer més que viatges-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      <call-macro n="test_pr_i_verb">
        <with-param pos="3"/>
        <with-param pos="4"/>
      </call-macro>
       <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="5" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
     	    <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="5"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
	  <lu>
             <clip pos="4" side="tl" part="whole"/>
	  </lu>
	  <b/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <clip pos="5" side="tl" part="persona"/>
            <clip pos="5" side="tl" part="gen"/>
            <clip pos="5" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="5"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN ADV VERB pas verb PREP DET je ne vais pas faire des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="prep"/>	
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      <call-macro n="test_pr_i_verb">
        <with-param pos="3"/>
        <with-param pos="5"/>
      </call-macro>
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="6" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
     	    <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
	  <lu>
             <clip pos="5" side="tl" part="whole"/>
	  </lu>
	  <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <clip pos="6" side="tl" part="temps"/>
            <clip pos="6" side="tl" part="persona"/>
            <clip pos="6" side="tl" part="gen"/>
            <clip pos="6" side="tl" part="nbr"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN ADV VERB pas verb adv PREP DET je ne viens pas de faire toujours des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      <call-macro n="test_pr_i_verb">
        <with-param pos="3"/>
        <with-param pos="5"/>
      </call-macro>
          <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="6" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
     	    <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="7" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
	  <lu>
             <clip pos="5" side="tl" part="whole"/>
	  </lu>
	  <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <clip pos="6" side="tl" part="temps"/>
            <clip pos="6" side="tl" part="persona"/>
            <clip pos="6" side="tl" part="gen"/>
            <clip pos="6" side="tl" part="nbr"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
	  <b pos="5"/>
          <lu>
            <clip pos="7" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>
     <rule>
<!-- REGLA:PRN ADV VERB pas adv prep verb PREP DET je ne viens pas toujours de faire des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
         <call-macro n="test_pr_i_verb">
        <with-param pos="3"/>
        <with-param pos="6"/>
      </call-macro>
          <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="7" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
     	    <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
	  <lu>
             <clip pos="5" side="tl" part="whole"/>
	  </lu>
	  <b pos="5"/>
	  <lu>
             <clip pos="6" side="tl" part="whole"/>
	  </lu>
	  <b pos="6"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="a_verb"/>
            <clip pos="7" side="tl" part="temps"/>
            <clip pos="7" side="tl" part="persona"/>
            <clip pos="7" side="tl" part="gen"/>
            <clip pos="7" side="tl" part="nbr"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
	  <b pos="7"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN verb + de +  VERB adv PREP DET je viens de faire encore des voyages-->
      <pattern>
        <pattern-item n="prnsubj"/>
	<pattern-item n="verb"/>	
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
        <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="test_pr_i_verb">
        <with-param pos="2"/>
        <with-param pos="3"/>
      </call-macro>	
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="4" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
	    <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
	    <lit-tag v="ger"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="whole"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN adv verb VERB PREP DET je aujourd'hui viens de faire des voyages -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
	<pattern-item n="prep"/>
        <pattern-item n="verb"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
      <call-macro n="test_pr_i_verb">
        <with-param pos="3"/>
        <with-param pos="4"/>
      </call-macro>
       <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="3" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="5" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
     	    <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
	 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
	  <b pos="3"/>
	  <lu>
             <clip pos="4" side="tl" part="whole"/>
	  </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <clip pos="5" side="tl" part="persona"/>
            <clip pos="5" side="tl" part="gen"/>
            <clip pos="5" side="tl" part="nbr"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>

    <rule>
<!-- REGLA:PRN VERB de verb adv adv PREP DET il vient de faire aujourd'hui encore des voyages -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
	<pattern-item n="prep"/>
	<pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdefpl"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="test_pr_i_verb">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>	
        <choose>
	  <when>
	    <test>
	      <and>
	        <equal>
	       	   <clip pos="2" side="sl" part="lem"/>
		   <lit v="être"/>
	        </equal>
		<equal>
	           <clip pos="4" side="sl" part="temps"/>
		   <lit-tag v="inf"/>
	        </equal>
	      </and>
	    </test>
        <out>
	  <lu>
            <lit v="estar"/>
	    <lit-tag v="vblex"/>
	    <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
	  <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
	    <lit-tag v="ger"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="whole"/>
          </lu>
	  <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
      </otherwise>
      </choose>	
      </action>
    </rule>


<!--fi regles per a eliminar el partitiu-->

<!--regles per a continuer à/de inf -->

    <rule comment="REGLA: continuer à/de inf > continuar ger">
      <pattern>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnsubj continuer à/de inf > continuar ger">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: continuer à/de adv inf > continuar ger adv">
      <pattern>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnsubj continuer à/de adv inf > continuar ger adv">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: continuer à/de ne pas inf > continuar no ger">
      <pattern>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="neadv"/>
        <pattern-item n="pas"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnsubj continuer à/de ne pas inf > continuar no ger">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="neadv"/>
        <pattern-item n="pas"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: continuer à/de ne pas adv inf > continuar no ger adv">
      <pattern>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="neadv"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b pos="4"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnsubj continuer à/de ne pas adv inf > continuar no ger adv">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="continuer"/>
        <pattern-item n="adeprep"/>
        <pattern-item n="neadv"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <b pos="5"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
          <b pos="6"/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

<!--fi regles per a continuer à/de inf -->

<!--regles per a rester-->

    <rule comment="REGLA: . RESTER_PP ADJ > ADJ: resté seul > sol">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="resterpp"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: , RESTER_PP ADJ > ADJ: resté seul > sol">
      <pattern>
        <pattern-item n="cm"/>
        <pattern-item n="resterpp"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: . ADV RESTER_PP ADJ > ADJ: longtemps resté seul > molt de temps sol">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="adv"/>
        <pattern-item n="resterpp"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="3">
              <clip pos="4" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: , ADV RESTER_PP ADJ > ADJ: longtemps resté seul > molt de temps sol">
      <pattern>
        <pattern-item n="cm"/>
        <pattern-item n="adv"/>
        <pattern-item n="resterpp"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="3">
              <clip pos="4" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: il reste detindpl nom > queden detindpl nom">
      <pattern>
        <pattern-item n="il"/>
        <pattern-item n="resterp3sg_noifi"/>
        <pattern-item n="detindpl"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="pl"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: il reste detindpl nom adj > queden detindpl nom adj">
      <pattern>
        <pattern-item n="il"/>
        <pattern-item n="resterp3sg_noifi"/>
        <pattern-item n="detindpl"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="5"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="pl"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

<!--fi regles per a rester-->


<!--<rule>
 REGLA: Passé composé/perifràstic -->
<!-- Per traduir "ai fait" per "vaig fer"
      <pattern>
	<pattern-item n="pascomp"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
	<out>
	  <lu>
	    <get-case-from pos="1">
	      <lit v="anar"/>
	    </get-case-from>
	    <lit-tag v="vaux"/>
	    <clip pos="1" side="tl" part="persona"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </lu>
	   <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="lem"/>
	    <clip pos="2" side="tl" part="a_verb"/>
	    <lit-tag v="inf"/>
	    <clip pos="2" side="tl" part="lemq"/>
	  </lu>
	</out>
      </action>
   </rule>


   <rule>
   REGLA: Passé composé/perifràstic -->
<!-- Per traduir "ai fait" per "vaig fer"
      <pattern>
	<pattern-item n="pascomp"/>
	<pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
	<out>
	  <lu>
	    <get-case-from pos="1">
	      <lit v="anar"/>
	    </get-case-from>
	    <lit-tag v="vaux"/>
	    <clip pos="1" side="tl" part="persona"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </lu>
	   <b pos="1"/>
	   <lu>
	   <clip pos="2" side="tl" part="whole"/>
	   </lu>
	   <b pos="2"/>
	  <lu>
	    <clip pos="3" side="tl" part="lem"/>
	    <clip pos="3" side="tl" part="a_verb"/>
	    <lit-tag v="inf"/>
	    <clip pos="3" side="tl" part="lemq"/>
	  </lu>
	</out>
      </action>
   </rule>


   <rule>
   REGLA: Passé composé/perifràstic -->
<!-- Per traduir "ai fait" per "vaig fer"
      <pattern>
	<pattern-item n="pascomp"/>
	<pattern-item n="adv"/>
	<pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
	<out>
	  <lu>
	    <get-case-from pos="1">
	      <lit v="anar"/>
	    </get-case-from>
	    <lit-tag v="vaux"/>
	    <clip pos="1" side="tl" part="persona"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </lu>
	   <b pos="1"/>
	   <lu>
	   <clip pos="2" side="tl" part="whole"/>
	   </lu>
	   <b pos="2"/>
	   <lu>
	   <clip pos="3" side="tl" part="whole"/>
	   </lu>
	   <b pos="3"/>
	  <lu>
	    <clip pos="4" side="tl" part="lem"/>
	    <clip pos="4" side="tl" part="a_verb"/>
	    <lit-tag v="inf"/>
	    <clip pos="4" side="tl" part="lemq"/>
	  </lu>
	</out>
      </action>
   </rule>-->

   <rule comment="REGLA: PRNREF VBSER PP > s'haver + participi">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
	<out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="haver"/>
            <lit-tag v="vaux"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

   <rule comment="REGLA: PRNREF VBSER ADV PP > s'haver + participi + adv">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
	<out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="haver"/>
            <lit-tag v="vaux"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

   <rule comment="REGLA:VBSER PP > haver PP">
      <pattern>
        <pattern-item n="serconj"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
      <choose>
       <when>
         <test>
           <or>
	     <equal><clip pos="1" side="sl" part="temps"/><lit-tag v="pp"/></equal>
             <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="vbambser"/></in>
           </or>
	 </test>
        <choose>
          <when>
            <test><equal><clip pos="1" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <lit-tag v="inf"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
	        <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
	        <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
       </when>
       <otherwise>
        <choose>
          <when>
            <test><equal><clip pos="1" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        </otherwise>
      </choose>
      </action>
    </rule>

   <rule comment="REGLA:VBSER ADV PP > haver PP ADV">
      <pattern>
        <pattern-item n="serconj"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
      <choose>
       <when>
         <test>
           <or>
	     <equal><clip pos="1" side="sl" part="temps"/><lit-tag v="pp"/></equal>
             <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="vbambser"/></in>
           </or>
	 </test>
        <choose>
          <when>
            <test><equal><clip pos="1" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <lit-tag v="inf"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
	        <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
	        <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
	        <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
	        <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
       </when>
       <otherwise>
        <choose>
          <when>
            <test><equal><clip pos="1" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        </otherwise>
      </choose>
      </action>
    </rule>

   <rule comment="REGLA: PRN PRNREF VBSER PP > s'haver + participi">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="4" side="sl" part="lem"/>
                  <list n="vb_pronfra_noproncat"/>
                </in>
                <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
              </and>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
	    <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="haver"/>
                <lit-tag v="vaux"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


   <rule comment="REGLA: PRN PRNREF VBSER ADV PP > s'haver + participi + adv">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="5" side="sl" part="lem"/>
                  <list n="vb_pronfra_noproncat"/>
                </in>
                <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
              </and>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
	    <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="haver"/>
                <lit-tag v="vaux"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>


   <rule comment="REGLA: PRNSUBJ VBSER PP > haver + participi">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="serconj"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>

        <choose>
	  <when>
	    <test>
	      <and>
	        <not><equal><var n="pronom"/><lit v=""/></equal></not>
                <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="vbambser"/></in>
	      </and>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="1" side="sl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
	  </when>
        </choose>


      <choose>
       <when>
         <test>
           <or>
	     <equal><clip pos="2" side="sl" part="temps"/><lit-tag v="pp"/></equal>
             <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="vbambser"/></in>
           </or>
	 </test>
        <choose>
          <when>
            <test><equal><clip pos="2" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="haver"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
	        <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
       </when>
	       <otherwise>
        <choose>
          <when>
            <test><equal><clip pos="2" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        </otherwise>
      </choose>
      </action>
    </rule>


    <rule comment="REGLA: ON VBSER PP > es haver + participi">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
      <out>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
      </out>
      <choose>
       <when>
         <test>
           <or>
	     <equal><clip pos="2" side="sl" part="temps"/><lit-tag v="pp"/></equal>
             <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="vbambser"/></in>
           </or>
	 </test>
        <choose>
          <when>
            <test><equal><clip pos="2" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="anar"/>
                </get-case-from>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <lit v="haver"/>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
	        <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
       </when>
       <otherwise>
        <choose>
          <when>
            <test><equal><clip pos="2" side="sl" part="temps"/><lit-tag v="ifi"/></equal></test>
            <out>
              <lu>
                <lit v="anar"/>
                <lit-tag v="vaux"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <lit-tag v="inf"/>
                 <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
	        <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
         </choose>
        </otherwise>
      </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN VERB (il arrive: arriba, il épouse: es casa amb)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: On VERB (on arrive: s'arriba)">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><clip pos="2" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
	    </test>
	    <let><clip pos="2" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="ens"/>
                </get-case-from>
	        <lit-tag v="prn.pro.p1.mf.pl"/>
              </lu>
              <b pos="1"/>
            </out>
            <choose>
	      <when>
	        <test>
	          <equal><clip pos="2" side="sl" part="temps"/><lit-tag v="ifi"/></equal>
	        </test>
                <out>
                  <lu>
                     <lit v="anar"/>
                     <lit-tag v="vaux.p1.pl"/>
                  </lu>
                  <b/>
                  <lu>
                     <clip pos="2" side="tl" part="lemh"/>
                     <clip pos="2" side="tl" part="a_verb"/>
                     <lit-tag v="inf"/>
                     <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
	      </when>
	      <otherwise>
                <out>
                  <lu>
                     <clip pos="2" side="tl" part="lemh"/>
                     <clip pos="2" side="tl" part="a_verb"/>
                     <clip pos="2" side="tl" part="temps"/>
                     <lit-tag v="p1.pl"/>
                     <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
	      </otherwise>
            </choose>
	  </when>
	  <otherwise>
            <call-macro n="f_ifi1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: PRN + aller + INF (il va manger : va a menjar)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <out>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN + aller + PRO + INF (il va en manger : va a menjar-ne)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="inf"/>
      </pattern>	
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <out>
	  <b pos="2"/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="3"/>
          <mlu>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="tags"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="3" side="tl" part="tipoenc_pro"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PRN + aller + ADV + INF (il va bien manger : va a menjar bé)">
<!-- difícil de dir si és "anar a" o futur, però segur que cal canviar l'estructura -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="aller_venir"/>
        <pattern-item n="adv"/>
        <pattern-item n="inf"/>
     </pattern>	
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <out>
          <b/>
          <lu>
            <lit v="a"/>
            <lit-tag v="pr"/>
          </lu>
	  <b pos="2"/>
	  <lu>
	    <clip pos="4" side="tl" part="lemh"/>
	    <clip pos="4" side="tl" part="tags"/>
	    <clip pos="4" side="tl" part="lemq"/>
          </lu>
	  <b pos="3"/>
	  <lu>
	    <clip pos="3" side="tl" part="lemh"/>
	    <clip pos="3" side="tl" part="tags"/>
	    <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: VBHAVER SERPP (a été: ha estat (evitem: ha estada))">
      <pattern>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pp_mf_sp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER SERPP QUE (n'a été que: només ha estat (evitem: ha estada))">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pp_mf_sp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="només"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>


    <rule comment="REGLA: PRN VBHAVER PP (il a mangé: ha menjat)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pp_m_sg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN VBHAVER ADV PP (il a toujours mangé: ha menjat sempre)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp_m_sg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="4"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB PAS (il n'arrive pas: no arriba, il n'épouse pas: no es casa amb)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB ADV PAS (il n'arrive cependant pas: no arriba tanmateix, il n'épouse cependant pas: no es casa amb tanmateix)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <out>
          <b pos="4"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB PAS DE (il ne veut pas de: no vol)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
                <get-case-from pos="3">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB ADV PAS DE (il ne veut cependant pas de: no vol tanmateix)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
                <get-case-from pos="3">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <lu>
                <clip pos="6" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB ADV_NEG DE (il ne veut jamais de: no vol mai)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
                <get-case-from pos="3">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBHAVER PAS PP DE (il n'a pas eu de: no ha tingut, ils n'ont pas parlé de: no han parlat de)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="5"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
                <get-case-from pos="3">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBHAVER ADV_NEG PP DE (il n'a jamais eu de: no ha tingut mai, ils n'ont jamais parlé de: no han parlat mai de)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="5"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
                <get-case-from pos="3">
	          <var n="pronom"/>
                </get-case-from>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER PAS VBSERPP (n'ont pas été > no han estat, n'a pas épousé > no s'ha casat amb)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="4"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="4" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="4" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: CE NE VBSER PAS > NO VBSER">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbserp3"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: NE VBSER PAS VBSERPP (ne sont pas tombés > no han caigut)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="vbambser_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="4"/>
          <with-param pos="2"/>
        </call-macro>
        <let><clip pos="2" side="tl" part="lem"/><lit v="haver"/></let>
        <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
        <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
        <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NE VBSER VBSERPP QUE (ne sont tombés que > només han caigut)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="vbambser_pp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <let><clip pos="2" side="tl" part="lem"/><lit v="haver"/></let>
        <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
        <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
        <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="només"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
	  </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBHAVER PAS PP (ils n'ont pas été > no han estat, il n'a pas épousé > no s-ha casat amb)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="5"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="5" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="5" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="5" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="5" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBSER PAS VBSERPP (ils ne sont pas tombés > no han caigut)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="vbambser_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="5"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <let><clip pos="3" side="tl" part="lem"/><lit v="haver"/></let>
        <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
        <let><clip pos="5" side="tl" part="gen"/><lit-tag v="m"/></let>
        <let><clip pos="5" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBSER VBSERPP QUE (ils ne sont tombés que > només han caigut)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="vbambser_pp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_set_pron">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <let><clip pos="3" side="tl" part="lem"/><lit v="haver"/></let>
        <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
        <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
        <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="només"/>
            </get-case-from>
                <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
	  </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB PAS DE LE (il ne veut pas de l'eau: no vol aigua, il ne veut pas des bombons, no vol bombons)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VERB ADV_NEG DE LE (il ne veut jamais de l'eau: no vol mai aigua, il ne veut jamais des bombons, no vol mai bombons)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBHAVER PAS PP DE DET (il n'a pas voulu de l'eau: no ha volgut aigua, ils n'ont pas parlé du: no han parlat del)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN NE VBHAVER ADV_NEG PP DE DET (il n'a jamais voulu de l'eau: no ha volgut mai aigua, ils n'ont jamais parlé du: no han parlat mai del)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="3" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


<!-- les següent 8 regles són com les anteriors, però sense prn inicial -->
    <rule comment="REGLA: NE VERB PAS DE (ne veut pas de: no vol)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VERB ADV_NEG DE (ne veut jamais de: no vol mai)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER PAS PP DE (n'a pas eu de: no ha tingut, n'ont pas parlé de: no han parlat de)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER ADV_NEG PP DE (n'a jamais eu de: no ha tingut mai, n'ont jamais parlé de: no han parlat mai de)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


<!-- les quatre regles que segueixen sembla que només s'utilitzen amb el verb être -->
    <rule comment="REGLA: NE VERB PAS DE LE (ne veut pas de l'eau: no vol aigua, ne veut pas des bomboms: no vol bombons)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VERB ADV_NEG DE LE (ne veut jamais de l'eau: no vol mai aigua, ne veut jamais des bomboms: no vol mai bombons)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER PAS PP DE LE (n'a pas voulu de l'eau: no ha volgut aigua, n'ont pas voulu des bombons: no han volgut bombons)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: NE VBHAVER ADV_NEG PP DE LE (n'a jamais voulu de l'eau: no ha volgut mai aigua, n'ont jamais voulu des bombons: no han volgut mai bombons)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp_m_sg"/>
        <pattern-item n="deprep"/>
        <pattern-item n="detdef"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <!-- per a alguns verbs sí que cal mantenir la preposició "de" -->
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="agir"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="parler"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="finir"/></equal>
                <not><equal><clip pos="2" side="sl" part="lemq"/><lit v=""/></equal></not>
              </or>
            </test>
            <out>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: PRN VERB PRNENC">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="verb"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
	      <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
	      </get-case-from>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule>
<!-- je m'appelle -> em dic -->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="appeler"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <let>
              <clip pos="3" side="tl" part="lem"/>
              <lit v="dir"/>
            </let>
          </when>
        </choose>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!-- je ne m'appelle pas -> no em dic -->
      <pattern>
        <pattern-item n="prnsubj"/>
	<pattern-item n="neadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="appeler"/>
	<pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="persona"/>
              </equal>
            </test>
            <let>
              <clip pos="4" side="tl" part="lem"/>
              <lit v="dir"/>
            </let>
          </when>
        </choose>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
	  <b pos="4"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PRN PRN VERB (il lui dit: li diu, je me tais: callo)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>

        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>

        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <list n="vb_pronfra_noproncat"/>
                </in>
                <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
              </and>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="3" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn"/>
                <clip pos="2" side="tl" part="tipo_prn"/>
                <clip pos="2" side="tl" part="tipoenc_pro"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV VERB (il toujours arrive: sempre arriba)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA: PRN ADV VERB PAS (il n'arrive pas: no arriba)-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule>
<!--REGLA: PRN ADV VERB QUE (il ne mange que: no menja més que)-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV PRN VERB (il toujours lui dit: sempre li diu)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <lit-tag v="prn"/>
            <clip pos="3" side="tl" part="tipo_prn"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV PRN VERB PAS (il ne lui dit pas: no li diu; il n'y a pas: no hi ha)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1"><with-param pos="3"/></call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="il"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="y"/></equal>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="avoir"/></equal>
              </and>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="haver"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </when>
        </choose>
        <call-macro n="f_ifi1"><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV PRN VERB QUE (il ne lui dit que: no li diu més que)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1"><with-param pos="3"/></call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="il"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="y"/></equal>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="avoir"/></equal>
              </and>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="haver"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </when>
        </choose>
        <call-macro n="f_ifi1"><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="més"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PRN ADV PRN VERB PAS DE (il ne lui dit pas de: no li diu; il n'y a pas de: no hi ha)">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="il"/></equal>
                <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="y"/></equal>
                <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="avoir"/></equal>
              </and>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="haver"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </when>
        </choose>
        <call-macro n="f_ifi1"><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
      </action>
    </rule>

    <rule>
<!--REGLA: PRN PRN PRN VERB (il le lui dit: li'l diu)-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="prn"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_prn_prn">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="prn"/>
            <clip pos="2" side="tl" part="tipo_prn"/>
            <clip pos="2" side="tl" part="tipoenc_pro"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA: PRN ADV PRN PRN VERB (il toujours le lui dit: sempre li ho diu)-->
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="prn"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA: PRN ADV PRN PRN VERB PAS (il ne le lui dit pas: no li ho diu)-->
      <pattern>
		<pattern-item n="prnsubj"/>
        <pattern-item n="adv"/>
        <pattern-item n="prn"/>
        <pattern-item n="prn"/>
        <pattern-item n="verb"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: VERB-PRONOM (suis-je: sóc)">
      <pattern>
        <pattern-item n="verbconj"/>
        <pattern-item n="prnsubj"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: VERB-on (peut-on: es pot)">
      <pattern>
        <pattern-item n="verbconjp3"/>
        <pattern-item n="on"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
          </lu>
          <b/>
        </out>
        <modify-case>
          <clip pos="1" side="tl" part="whole"/>
          <lit v="aa"/>
        </modify-case>
        <out>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: VERBSER-PRONOM PP (suis-je arrivé: he arribat)">
      <pattern>
        <pattern-item n="serconj"/>
        <pattern-item n="prnsubj"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="2"/>
        </call-macro>
  <!--      <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lemh"/>
                <list n="vbambser"/>
              </in>
            </test>-->
            <out>
              <lu>
                <lit v="haver"/>
                <lit-tag v="vaux"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
      <!--     </when>
        </choose>-->
      </action>
    </rule>

    <rule comment="REGLA: VERB-PRONOM(suis-je: sóc)">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="prnsubj"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord0">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>

          </lu>
        </out>
      </action>
    </rule>

<!--
    <rule comment="REGLA: VERB-t-PRONOM(a-t-elle: ha)">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
        <pattern-item n="prnsubj"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>
-->

    <rule comment="REGLA: VERB + ENCLÍTIC">
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

<rule comment="REGLA: VERB + ENCLÍTIC + ENCLÍTIC">
      <pattern>
	<pattern-item n="verb"/>
	<pattern-item n="prnenc"/>
	<pattern-item n="prnenc"/>
    </pattern>
    <action>
      <out>
	<mlu>
	  <lu>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <clip pos="1" side="tl" part="temps"/>
	    <clip pos="1" side="tl" part="persona"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </lu>
	  <lu>
	    <clip pos="2" side="tl" part="lem"/>
	    <clip pos="2" side="tl" part="a_prnenc"/>
	    <clip pos="2" side="tl" part="persona"/>
	    <clip pos="2" side="tl" part="gen"/>
	    <clip pos="2" side="tl" part="nbr"/>
	  </lu>
	  <lu>
	    <clip pos="3" side="tl" part="lem"/>
	    <clip pos="3" side="tl" part="a_prnenc"/>
	    <clip pos="3" side="tl" part="persona"/>
	    <clip pos="3" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="nbr"/>
	    <clip pos="1" side="tl" part="lemq"/>
	  </lu>
	</mlu>
      </out>
    </action>
</rule>

    <rule comment="REGLA: être en train de = estar ger">
      <pattern>
        <pattern-item n="vbser"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prn être en train de = estar ger">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbser"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prn être adv en train de = estar adv ger : il est toujours en train de manger > està sempre menjant">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="vbser"/>
        <pattern-item n="adv"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="6"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: n'être pas en train de = no estar ger">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="6"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prn n'être pas en train de = no estar ger">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="7"/>
          <lu>
            <clip pos="8" side="tl" part="lemh"/>
            <clip pos="8" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="8" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prn n'être adv en train de = no estar adv ger">
      <pattern>
        <pattern-item n="prnsubj"/>
        <pattern-item n="neadv"/>
        <pattern-item n="vbser"/>
        <pattern-item n="adv"/>
        <pattern-item n="enprep"/>
        <pattern-item n="train"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord0">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <lit v="estar"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="7"/>
          <lu>
            <clip pos="8" side="tl" part="lemh"/>
            <clip pos="8" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="8" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: en + ger = ger : en chantant -> cantant">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
      <call-macro n="f_unset_nopron"><with-param pos="2"/></call-macro>
      <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
      <choose>
        <when>
          <test>
            <equal><clip pos="2" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
          </test>
          <out>
            <mlu>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="ger"/>
              </lu>
              <lu>
                <lit v="es"/>
                <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </out>
        </when>
        <otherwise>
          <out>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_ger"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </out>
        </otherwise>
      </choose>
      </action>
    </rule>

    <rule comment="REGLA: en ne + ger + pas = no ger : en ne chantant pas -> no cantant">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="neadv"/>
        <pattern-item n="ger"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: en + pro + ger= ger+enc">
     <pattern>
        <pattern-item n="en"/>
        <pattern-item n="prnproobj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <get-case-from pos="1">
                <clip pos="3" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="3" side="tl" part="a_ger"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="2" side="tl" part="tipoenc_pro"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: pro +ger = ger+enc">
      <pattern>
        <pattern-item n="prnproobj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_ger"/>
            </lu>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="1" side="tl" part="tipoenc_pro"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA:  pro+inf = inf+pro">
      <pattern>
        <pattern-item n="prnproobj"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_inf"/>
            </lu>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <lit-tag v="prn.enc"/>
              <clip pos="1" side="tl" part="tipoenc_pro"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA:  pro+pro+inf = inf+pro+pro: le lui dire > dir-li-ho, lui en parler > parlar-li'n, la lui donner > donar-la-hi, s'y mettre > posar-s'hi">
      <pattern>
        <pattern-item n="prnproobj"/>
        <pattern-item n="prnproobj"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1"><with-param pos="1"/></call-macro>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="se"/></equal>
            </test>
            <out>
              <mlu>
                <lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lemh"/>
                  </get-case-from>
                  <clip pos="3" side="tl" part="a_inf"/>
                </lu>
                <lu>
                  <clip pos="1" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="tipoenc_pro"/>
                </lu>
                <lu>
                  <clip pos="2" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="tipoenc_pro"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </mlu>
            </out>
          </when>
          <otherwise>
            <out>
              <mlu>
                <lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lemh"/>
                  </get-case-from>
                  <clip pos="3" side="tl" part="a_inf"/>
                </lu>
                <lu>
                  <clip pos="2" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="tipoenc_pro"/>
                </lu>
                <lu>
                  <clip pos="1" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="tipoenc_pro"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </mlu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!--REGLA:  à lui +inf = inf+pro (à lui dire > a dir-li) -->
      <pattern>
        <pattern-item n="a_lui"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <mlu>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_inf"/>
            </lu>
            <lu>
              <lit v="li"/>
              <lit-tag v="prn.enc.p3.mf.sg"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA:  à nous +inf = inf+pro (à nous aider > a ajudar-nos) -->
      <pattern>
        <pattern-item n="a_nous"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <mlu>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_inf"/>
            </lu>
            <lu>
              <lit v="ens"/>
              <lit-tag v="prn.enc.p1.mf.pl"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA:  à vous +inf = inf+pro (à vous aider > a ajudar-vos) -->
      <pattern>
        <pattern-item n="a_vous"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <mlu>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_inf"/>
            </lu>
            <lu>
              <lit v="us"/>
              <lit-tag v="prn.enc.p2.mf.pl"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: en + nptop = a + nptop: en France -> a França">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="a"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: le + nptop (pays) = nptop: la France -> França">
      <pattern>
        <pattern-item n="le"/>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal> <!-- en el cas de np.loc cal no cridar la macro -->
                <clip pos="2" side="tl" part="a_nptop"/>
                <lit-tag v="np.loc"/>
              </equal>
            </test>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
          </otherwise>
        </choose>

        <choose>
          <when>
            <test>
              <in>
                <clip pos="2" side="sl" part="lem"/>
                <list n="pays"/>
              </in>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: det TOP ADJ: l'Oural méridional > els Urals meridionals, l'Espagne centrale > l'Espanya central">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="nptop"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: eliminar 'pas de'">
      <pattern>
        <pattern-item n="pas_strict"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
      </action>
    </rule>

    <rule>
<!--REGLA: en 1998: l'any 1998 -->
      <pattern>
        <pattern-item n="enprep"/>
        <pattern-item n="xifra"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def.m.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="any"/>
            <lit-tag v="n.m.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!-- REGLA: autant/moins/plus de NOM que de: tants/menys/més NOM com/que-->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nom"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="autant"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="tant"/>
                <lit-tag v="adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA: autant/moins/plus de NOM que: tants/menys/més NOM com/que-->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nom"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_maj_gentilici">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="autant"/>
              </equal>
            </test>
	  <choose>
	    <when>
            <test>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
 	    <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
 	      <b pos="3"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
	     </out>
	   </when>
	   <otherwise>
            <out>
              <lu>
                <lit v="tant"/>
                <lit-tag v="adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
	  </otherwise>
	  </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA: autant/menys/més de ADJ que de: tants/menys/més ADJ com/que-->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adj"/>
        <pattern-item n="que"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="autant"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="tant"/>
                <lit-tag v="adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA: autant/menys/més de ADJ que: tants/menys/més ADJ com/que-->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="deprep"/>
        <pattern-item n="adj"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="autant"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="tant"/>
                <lit-tag v="adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA: aussi ADJ que: tan ADJ com -->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="aussi"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="tan"/>
                <lit-tag v="preadv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!-- REGLA: aussi ADV que: aussi ADJ com -->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="aussi"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="tan"/>
                <lit-tag v="preadv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="com"/>
                <lit-tag v="rel.adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule>
<!--REGLA: défense de fumer > prohibit fumar -->
      <pattern>
        <pattern-item n="defense"/>
        <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <lit v="prohibir"/>
            <lit-tag v="vblex.pp.m.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: combien de NOM > quant(s) NOM">
      <pattern>
        <pattern-item n="combien"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!--REGLA: ne pas fumer > no fumar, ne pas le dire > no dir-ho -->
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ne mange que > només menja">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="només"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="només"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: ne mange pas > no menja">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_set_pron">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: on ne mange pas > no es menja">
      <pattern>
        <pattern-item n="on"/>
        <pattern-item n="neadv"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

   <rule comment="REGLA: NE PRNREF VBSER PAS PP > no s'haver + participi (ne se sont pas réveillées > no s'han despertat)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="haver"/>
            <lit-tag v="vaux"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

   <rule comment="REGLA: NE PRNREF VBSER PAS ADV PP > no s'haver + participi + adv (ne se sont pas toujours réveillées > no s'han despertat sempre)">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pas"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="haver"/>
            <lit-tag v="vaux"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="a_verb"/>
            <clip pos="6" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
	    <clip pos="6" side="tl" part="lemq"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ne lui parle pas > no li parla">
      <pattern>
        <pattern-item n="neadv"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verbconj"/>
        <pattern-item n="pas"/>
      </pattern>
      <action>
        <call-macro n="f_set_pron">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <equal><var n="pronom"/><lit v=""/></equal>
	    </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </when>
	  <otherwise>
            <out>
              <lu>
                <var n="pronom"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="1" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
	  </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: il y a X temps > fa X temps">
      <pattern>
        <pattern-item n="il"/>
        <pattern-item n="y"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="num_detind"/>
        <pattern-item n="unite_temps"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="5"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <lit v="fer"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: depuis X temps > des de fa X temps">
      <pattern>
        <pattern-item n="depuis"/>
        <pattern-item n="num_detind"/>
        <pattern-item n="unite_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
               <lit v="fer"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: il y a longtemps > fa temps">
      <pattern>
        <pattern-item n="il"/>
        <pattern-item n="y"/>
        <pattern-item n="vbhaver"/>
        <pattern-item n="longtemps"/>
      </pattern>
      <action>
        <call-macro n="f_ifi1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <lit v="fer"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <lit v="temps"/>
            </get-case-from>
            <lit-tag v="n.m.sp"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: depuis longtemps > des de fa temps">
      <pattern>
        <pattern-item n="depuis"/>
        <pattern-item n="longtemps"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
               <lit v="fer"/>
            </get-case-from>
            <lit-tag v="vblex"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="temps"/>
            </get-case-from>
            <lit-tag v="n.m.sp"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: à NUM heures > a les NUM">
      <pattern>
        <pattern-item n="apr"/>
        <pattern-item n="num"/>
        <pattern-item n="heures"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
               <lit v="el"/>
            </get-case-from>
            <lit-tag v="det.def.f.pl"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: c'est parti > ha començat">
      <pattern>
        <pattern-item n="ce_prn"/>
        <pattern-item n="est_vbser"/>
        <pattern-item n="parti_pp"/>
      </pattern>
      <action>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
               <lit v="haver"/>
            </get-case-from>
            <lit-tag v="vbhaver.pri.p3.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="1">
               <lit v="començar"/>
            </get-case-from>
            <lit-tag v="vblex.pp.m.sg"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: itg est-ce que > itg">
      <pattern>
        <pattern-item n="prnitg"/>
        <pattern-item n="est-ce_que"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: cm">
      <pattern>
        <pattern-item n="cm"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: reset variables">
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

  </section-rules>

</transfer>
