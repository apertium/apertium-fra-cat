<?xml version="1.0" encoding="UTF-8"?>
<!-- -*- nxml -*- -->
<transfer>
  <section-def-cats>
    <def-cat n="unknown"> <!-- unknown words -->
      <cat-item tags=""/>
    </def-cat>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="np">
      <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="np_unk">
      <cat-item tags="np.*"/>
      <cat-item tags=""/>
    </def-cat>
    <def-cat n="npant">
      <cat-item tags="np.ant"/>
      <cat-item tags="np.ant.*"/>
    </def-cat>
    <def-cat n="npant_unk">
      <cat-item tags="np.ant"/>
      <cat-item tags="np.ant.*"/>
      <cat-item tags="np.cog.*"/>
      <cat-item tags=""/>
    </def-cat>
    <def-cat n="nptop">
      <cat-item tags="np.top.*"/>
      <cat-item tags="np.loc"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="detdefsg">
      <cat-item tags="det.def.*.sg"/>
    </def-cat>
    <def-cat n="detind">
      <cat-item tags="det.ind.*"/>
    </def-cat>
    <def-cat n="uns">
      <cat-item lemma="un" tags="det.ind.*.pl"/>
    </def-cat>
    <def-cat n="cada">
      <cat-item lemma="cada" tags="det.*"/>
    </def-cat>
    <def-cat n="moltdet">
      <cat-item lemma="molt" tags="det.*"/>
    </def-cat>
    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="eldetmsg">
      <cat-item lemma="el" tags="det.def.m.sg"/>
    </def-cat>
    <def-cat n="lesdetdef">
      <cat-item lemma="el" tags="det.def.f.pl"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
   <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="noadv">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>
    <def-cat n="negadv"> <!-- adverbis negatius que segueixen un no: no canta pas, mai, enlloc -->
      <cat-item lemma="pas" tags="adv"/>
      <cat-item lemma="mai" tags="adv"/>
      <cat-item lemma="enlloc" tags="adv"/>
      <cat-item lemma="gens" tags="adv"/>
      <cat-item lemma="gens ni mica" tags="adv"/>
      <cat-item lemma="de cap manera" tags="adv"/>
      <cat-item lemma="gaire" tags="adv"/>
      <cat-item lemma="ni" tags="cnjcoo"/>
    </def-cat>
    <def-cat n="cnjsub">
      <cat-item tags="cnjsub"/>
    </def-cat>
    <def-cat n="cnjadv">
      <cat-item tags="cnjadv"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="aprep">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="deprep">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="comprep">
      <cat-item lemma="com" tags="pr"/>
      <cat-item lemma="com a" tags="pr"/>
    </def-cat>
    <def-cat n="principi_prep">
      <cat-item lemma="al començament de" tags="pr"/>
      <cat-item lemma="a començaments de" tags="pr"/>
      <cat-item lemma="a les primeries de" tags="pr"/>
      <cat-item lemma="a primers de" tags="pr"/>
      <cat-item lemma="a principis de" tags="pr"/>
      <cat-item lemma="al principi de" tags="pr"/>
    </def-cat>
    <def-cat n="fi_prep">
      <cat-item lemma="al final de" tags="pr"/>
      <cat-item lemma="a finals de" tags="pr"/>
    </def-cat>
    <def-cat n="finsprep">
      <cat-item lemma="fins" tags="pr"/>
      <cat-item lemma="fins a" tags="pr"/>
    </def-cat>
    <def-cat n="des_de_mitjan">
      <cat-item lemma="des de mitjan" tags="pr"/>
      <cat-item lemma="des de mitjans" tags="pr"/>
      <cat-item lemma="a partir de mitjan" tags="pr"/>
      <cat-item lemma="a partir de mitjans" tags="pr"/>
      <cat-item lemma="fins a mitjan" tags="pr"/>
      <cat-item lemma="fins a mitjans" tags="pr"/>
    </def-cat>
    <def-cat n="espai_prepadv">
      <cat-item lemma="darrere" tags="pr"/>
      <cat-item lemma="rere" tags="pr"/>
      <cat-item lemma="davant" tags="pr"/>
      <cat-item lemma="sobre" tags="pr"/>
      <cat-item lemma="sota" tags="pr"/>
      <cat-item lemma="al davant" tags="pr"/>
      <cat-item lemma="al darrere" tags="pr"/>
      <cat-item lemma="al damunt" tags="pr"/>
      <cat-item lemma="a sobre" tags="pr"/>
      <cat-item lemma="a sota" tags="pr"/>
      <cat-item lemma="prop" tags="pr"/>
      <cat-item lemma="a prop" tags="pr"/>
      <cat-item lemma="a la vora" tags="pr"/>
      <cat-item lemma="al voltant" tags="pr"/>
      <cat-item lemma="a l'entorn" tags="pr"/>
      <cat-item lemma="a dins" tags="pr"/>
      <cat-item lemma="a fora" tags="pr"/>
      <cat-item lemma="a l'interior" tags="pr"/>
      <cat-item lemma="a l'exterior" tags="pr"/>
      <cat-item lemma="darrere" tags="adv"/>
      <cat-item lemma="rere" tags="adv"/>
      <cat-item lemma="davant" tags="adv"/>
      <cat-item lemma="sobre" tags="adv"/>
      <cat-item lemma="sota" tags="adv"/>
      <cat-item lemma="al davant" tags="adv"/>
      <cat-item lemma="al darrere" tags="adv"/>
      <cat-item lemma="al damunt" tags="adv"/>
      <cat-item lemma="a sobre" tags="adv"/>
      <cat-item lemma="a sota" tags="adv"/>
      <cat-item lemma="prop" tags="adv"/>
      <cat-item lemma="a prop" tags="adv"/>
      <cat-item lemma="a la vora" tags="adv"/>
      <cat-item lemma="al voltant" tags="adv"/>
      <cat-item lemma="a l'entorn" tags="adv"/>
      <cat-item lemma="a dins" tags="adv"/>
      <cat-item lemma="a fora" tags="adv"/>
      <cat-item lemma="a l'interior" tags="adv"/>
      <cat-item lemma="a l'exterior" tags="adv"/>
    </def-cat>
    <def-cat n="cnjcoo">
      <cat-item tags="cnjcoo"/>
    </def-cat>
    <def-cat n="i">
      <cat-item lemma="i" tags="cnjcoo"/>
    </def-cat>
    <def-cat n="que">
      <cat-item lemma="que" tags="cnjsub"/>
    </def-cat>
    <def-cat n="que_rel">
      <cat-item lemma="que" tags="rel.an.*"/>
    </def-cat>
    <def-cat n="com">
      <cat-item lemma="com" tags="pr"/>
      <cat-item lemma="com" tags="rel.adv"/>
    </def-cat>
    <def-cat n="quecom">
      <cat-item lemma="que" tags="cnjsub"/>
      <cat-item lemma="que" tags="rel.*"/>
      <cat-item lemma="com" tags="pr"/>
      <cat-item lemma="com" tags="rel.adv"/>
    </def-cat>
    <def-cat n="relat">
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="elqual">
      <cat-item lemma="el qual" tags="rel.*"/>
      <cat-item lemma="què" tags="rel.*"/>
    </def-cat>
    <def-cat n="prn">
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="prntn">
      <cat-item tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnproref">
      <cat-item lemma="em" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="et" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="es" tags="prn.pro.ref.p3.mf.sp"/>
      <cat-item lemma="ens" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="us" tags="prn.pro.p2.mf.pl"/>
    </def-cat>
    <def-cat n="es">
      <cat-item lemma="es" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="es_enc">
      <cat-item lemma="es" tags="prn.enc.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="prnpronoref">
      <cat-item lemma="en" tags="prn.pro.adv"/>
      <cat-item lemma="hi" tags="prn.pro.adv"/>
      <cat-item lemma="ho" tags="prn.pro.p3.nt"/>
      <cat-item lemma="li" tags="prn.pro.p3.mf.sg"/>
      <cat-item lemma="li" tags="prn.pro.p3.mf.pl"/>
      <cat-item lemma="el" tags="prn.pro.p3.m.sg"/>
      <cat-item lemma="el" tags="prn.pro.p3.f.sg"/>
      <cat-item lemma="el" tags="prn.pro.p3.m.pl"/>
      <cat-item lemma="el" tags="prn.pro.p3.f.pl"/>
    </def-cat>
    <def-cat n="hi">
      <cat-item lemma="hi" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="tu">
      <cat-item lemma="tu" tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="ell">
      <cat-item lemma="ell" tags="prn.tn.p3.m.sg"/>
    </def-cat>
    <def-cat n="ells">
      <cat-item lemma="ell" tags="prn.tn.p3.m.pl"/>
    </def-cat>
    <def-cat n="meu">
      <cat-item lemma="meu" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="teu">
      <cat-item lemma="teu" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="seu">
      <cat-item lemma="seu" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="nostre">
      <cat-item lemma="nostre" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="vostre">
      <cat-item lemma="vostre" tags="adj.pos.m.sg"/>
    </def-cat>
    <def-cat n="tot">
      <cat-item lemma="tot" tags="prn.tn.m.sg"/>
    </def-cat>
    <def-cat n="que_itg">
      <cat-item lemma="què" tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="vbser">
      <cat-item tags="vbser.*"/>
    </def-cat>
    <def-cat n="vbmod">
      <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="verb_conj">
      <cat-item tags="vblex.*.p1.*"/>
      <cat-item tags="vblex.*.p2.*"/>
      <cat-item tags="vblex.*.p3.*"/>
      <cat-item tags="vbser.*.p1.*"/>
      <cat-item tags="vbser.*.p2.*"/>
      <cat-item tags="vbser.*.p3.*"/>
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
      <cat-item tags="vbmod.*.p1.*"/>
      <cat-item tags="vbmod.*.p2.*"/>
      <cat-item tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="vbser_conj">
      <cat-item tags="vbser.*.p1.*"/>
      <cat-item tags="vbser.*.p2.*"/>
      <cat-item tags="vbser.*.p3.*"/>
    </def-cat>
    <def-cat n="vbhaver_conj">
      <cat-item tags="vbhaver.*.p1.*"/>
      <cat-item tags="vbhaver.*.p2.*"/>
      <cat-item tags="vbhaver.*.p3.*"/>
    </def-cat>
    <def-cat n="haver_p3">
      <cat-item tags="vbhaver.*.p3.*"/>
    </def-cat>
    <def-cat n="estar_conj">
      <cat-item lemma="estar" tags="vblex.*.p1.*"/>
      <cat-item lemma="estar" tags="vblex.*.p2.*"/>
      <cat-item lemma="estar" tags="vblex.*.p3.*"/>
    </def-cat>
    <def-cat n="estar_portar_conj">
      <cat-item lemma="estar" tags="vblex.*.p1.*"/>
      <cat-item lemma="estar" tags="vblex.*.p2.*"/>
      <cat-item lemma="estar" tags="vblex.*.p3.*"/>
      <cat-item lemma="portar" tags="vblex.*.p1.*"/>
      <cat-item lemma="portar" tags="vblex.*.p2.*"/>
      <cat-item lemma="portar" tags="vblex.*.p3.*"/>
      <cat-item lemma="dur" tags="vblex.*.p1.*"/>
      <cat-item lemma="dur" tags="vblex.*.p2.*"/>
      <cat-item lemma="dur" tags="vblex.*.p3.*"/>
    </def-cat>
    <def-cat n="tenir_voler_conj">
      <cat-item lemma="tenir" tags="vblex.*.p1.*"/>
      <cat-item lemma="tenir" tags="vblex.*.p2.*"/>
      <cat-item lemma="tenir" tags="vblex.*.p3.*"/>
      <cat-item lemma="voler" tags="vblex.*.p1.*"/>
      <cat-item lemma="voler" tags="vblex.*.p2.*"/>
      <cat-item lemma="voler" tags="vblex.*.p3.*"/>
    </def-cat>
    <def-cat n="poder_inf">
      <cat-item lemma="poder" tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="poder_pp">
      <cat-item lemma="poder" tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="poder_p3">
      <cat-item lemma="poder" tags="vbmod.*.p3.*"/>
    </def-cat>
    <def-cat n="verbnp">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="haverinf">
      <cat-item tags="vbhaver.inf"/>
    </def-cat>
    <def-cat n="estarinf">
      <cat-item lemma="estar" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="estar_portar_inf">
      <cat-item lemma="estar" tags="vblex.inf"/>
      <cat-item lemma="portar" tags="vblex.inf"/>
      <cat-item lemma="dur" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="anarinf">
      <cat-item lemma="anar" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>
    <def-cat n="haverger">
      <cat-item tags="vbhaver.ger"/>
    </def-cat>
    <def-cat n="imp">
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbmod.imp.*"/>
    </def-cat>
    <def-cat n="infnm">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
    </def-cat>
    <def-cat n="infnh">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="anarppmsg">
      <cat-item lemma="anar" tags="vblex.pp.m.sg"/>
    </def-cat>
    <def-cat n="estarpp">
      <cat-item lemma="estar" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="estar_portar_pp">
      <cat-item lemma="estar" tags="vblex.pp.*"/>
      <cat-item lemma="portar" tags="vblex.pp.*"/>
      <cat-item lemma="dur" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="ppf">
      <cat-item tags="vblex.pp.f.sg"/>
      <cat-item tags="vbhaver.pp.f.sg"/>
      <cat-item tags="vbmod.pp.f.sg"/>
    </def-cat>
    <def-cat n="haver-cnj">
      <cat-item lemma="haver" tags="vbhaver.pri.*"/>
      <cat-item lemma="haver" tags="vbhaver.prs.*"/>
      <cat-item lemma="haver" tags="vbhaver.pii.*"/>
      <cat-item lemma="haver" tags="vbhaver.pis.*"/>
      <cat-item lemma="haver" tags="vbhaver.cni.*"/>
      <cat-item lemma="haver" tags="vbhaver.ifi.*"/>
      <cat-item lemma="haver" tags="vbhaver.fti.*"/>
      <cat-item lemma="haver" tags="vbhaver.imp.*"/>
    </def-cat>
    <def-cat n="haver-cnj-p3">
      <cat-item lemma="haver" tags="vbhaver.pri.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.prs.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.pii.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.pis.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.cni.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.ifi.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.fti.p3.*"/>
      <cat-item lemma="haver" tags="vbhaver.imp.p3.*"/>
    </def-cat>
    <def-cat n="anar-cnj">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
      <cat-item lemma="anar" tags="vblex.prs.*"/>
      <cat-item lemma="anar" tags="vblex.pii.*"/>
      <cat-item lemma="anar" tags="vblex.pis.*"/>
      <cat-item lemma="anar" tags="vblex.cni.*"/>
      <cat-item lemma="anar" tags="vblex.ifi.*"/>
      <cat-item lemma="anar" tags="vblex.fti.*"/>
      <cat-item lemma="anar" tags="vblex.imp.*"/>
    </def-cat>
    <def-cat n="anar-cnj-p3">
      <cat-item lemma="anar" tags="vblex.pri.p3.*"/>
      <cat-item lemma="anar" tags="vblex.prs.p3.*"/>
      <cat-item lemma="anar" tags="vblex.pii.p3.*"/>
      <cat-item lemma="anar" tags="vblex.pis.p3.*"/>
      <cat-item lemma="anar" tags="vblex.cni.p3.*"/>
      <cat-item lemma="anar" tags="vblex.ifi.p3.*"/>
      <cat-item lemma="anar" tags="vblex.fti.p3.*"/>
      <cat-item lemma="anar" tags="vblex.imp.p3.*"/>
    </def-cat>
    <def-cat n="verbospron"> <!-- verbs pronominals en cat però amb l'equivalent fra no pronominal -->
      <cat-item lemma="agrumollar" tags="vblex.*"/>
      <cat-item lemma="aprimar" tags="vblex.*"/>
      <cat-item lemma="arriscar" tags="vblex.*"/>
      <cat-item lemma="assemblar" tags="vblex.*"/>
      <cat-item lemma="assabentar" tags="vblex.*"/>
      <cat-item lemma="assabentar# de" tags="vblex.*"/>
      <cat-item lemma="atrevir" tags="vblex.*"/>
      <cat-item lemma="avergonyir" tags="vblex.*"/>
      <cat-item lemma="bellugar" tags="vblex.*"/>
      <cat-item lemma="beure# l'enteniment" tags="vblex.*"/>
      <cat-item lemma="cabussar" tags="vblex.*"/>
      <cat-item lemma="capbussar" tags="vblex.*"/>
      <cat-item lemma="concienciar" tags="vblex.*"/>
      <cat-item lemma="convertir" tags="vblex.*"/>
      <cat-item lemma="convertir# en" tags="vblex.*"/>
      <cat-item lemma="descuidar" tags="vblex.*"/>
      <cat-item lemma="empescar" tags="vblex.*"/>
      <cat-item lemma="enfitar" tags="vblex.*"/>
      <cat-item lemma="empantanar" tags="vblex.*"/>
      <cat-item lemma="empantanegar" tags="vblex.*"/>
      <cat-item lemma="enamorar" tags="vblex.*"/>
      <cat-item lemma="encabir" tags="vblex.*"/>
      <cat-item lemma="encimbellar" tags="vblex.*"/>
      <cat-item lemma="enfilar" tags="vblex.*"/>
      <cat-item lemma="enfonsar" tags="vblex.*"/>
      <cat-item lemma="ensopegar" tags="vblex.*"/>
      <cat-item lemma="entrebancar" tags="vblex.*"/>
      <cat-item lemma="escarrufar" tags="vblex.*"/>
      <cat-item lemma="esgarrifar" tags="vblex.*"/>
      <cat-item lemma="estirar" tags="vblex.*"/>
      <cat-item lemma="fer# càrrec de" tags="vblex.*"/>
      <cat-item lemma="florir" tags="vblex.*"/>
      <cat-item lemma="gitar" tags="vblex.*"/>
      <cat-item lemma="jubilar" tags="vblex.*"/>
      <cat-item lemma="moure" tags="vblex.*"/>
      <cat-item lemma="negar" tags="vblex.*"/>
      <cat-item lemma="oblidar# de" tags="vblex.*"/>
      <cat-item lemma="penedir" tags="vblex.*"/>
      <cat-item lemma="podrir" tags="vblex.*"/>
      <cat-item lemma="recar" tags="vblex.*"/>
      <cat-item lemma="reviscolar" tags="vblex.*"/>
      <cat-item lemma="saber# greu" tags="vblex.*"/>
      <cat-item lemma="soler" tags="vblex.*"/>
      <cat-item lemma="submergir" tags="vblex.*"/>
      <cat-item lemma="tornar" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verbospron_inf">
      <cat-item lemma="agrumollar" tags="vblex.inf"/>
      <cat-item lemma="aprimar" tags="vblex.inf"/>
      <cat-item lemma="atrevir" tags="vblex.inf"/>
      <cat-item lemma="avergonyir" tags="vblex.inf"/>
      <cat-item lemma="bellugar" tags="vblex.inf"/>
      <cat-item lemma="beure# l'enteniment" tags="vblex.inf"/>
      <cat-item lemma="cabussar" tags="vblex.inf"/>
      <cat-item lemma="capbussar" tags="vblex.inf"/>
      <cat-item lemma="concienciar" tags="vblex.inf"/>
      <cat-item lemma="convertir" tags="vblex.inf"/>
      <cat-item lemma="convertir# en" tags="vblex.inf"/>
      <cat-item lemma="descuidar" tags="vblex.inf"/>
      <cat-item lemma="empescar" tags="vblex.inf"/>
      <cat-item lemma="enfitar" tags="vblex.inf"/>
      <cat-item lemma="empantanar" tags="vblex.inf"/>
      <cat-item lemma="empantanegar" tags="vblex.inf"/>
      <cat-item lemma="enamorar" tags="vblex.inf"/>
      <cat-item lemma="encabir" tags="vblex.inf"/>
      <cat-item lemma="encimbellar" tags="vblex.inf"/>
      <cat-item lemma="enfilar" tags="vblex.inf"/>
      <cat-item lemma="enfonsar" tags="vblex.inf"/>
      <cat-item lemma="ensopegar" tags="vblex.inf"/>
      <cat-item lemma="entrebancar" tags="vblex.inf"/>
      <cat-item lemma="escarrufar" tags="vblex.inf"/>
      <cat-item lemma="esgarrifar" tags="vblex.inf"/>
      <cat-item lemma="estirar" tags="vblex.inf"/>
      <cat-item lemma="fer# càrrec de" tags="vblex.inf"/>
      <cat-item lemma="florir" tags="vblex.inf"/>
      <cat-item lemma="gitar" tags="vblex.inf"/>
      <cat-item lemma="jubilar" tags="vblex.inf"/>
      <cat-item lemma="moure" tags="vblex.inf"/>
      <cat-item lemma="negar" tags="vblex.inf"/>
      <cat-item lemma="oblidar# de" tags="vblex.inf"/>
      <cat-item lemma="penedir" tags="vblex.inf"/>
      <cat-item lemma="podrir" tags="vblex.inf"/>
      <cat-item lemma="recar" tags="vblex.inf"/>
      <cat-item lemma="reviscolar" tags="vblex.inf"/>
      <cat-item lemma="saber# greu" tags="vblex.inf"/>
      <cat-item lemma="soler" tags="vblex.inf"/>
      <cat-item lemma="submergir" tags="vblex.inf"/>
      <cat-item lemma="tornar" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="verbospron_ger">
      <cat-item lemma="agrumollar" tags="vblex.ger"/>
      <cat-item lemma="aprimar" tags="vblex.ger"/>
      <cat-item lemma="atrevir" tags="vblex.ger"/>
      <cat-item lemma="avergonyir" tags="vblex.ger"/>
      <cat-item lemma="bellugar" tags="vblex.ger"/>
      <cat-item lemma="beure# l'enteniment" tags="vblex.ger"/>
      <cat-item lemma="cabussar" tags="vblex.ger"/>
      <cat-item lemma="capbussar" tags="vblex.ger"/>
      <cat-item lemma="concienciar" tags="vblex.ger"/>
      <cat-item lemma="convertir" tags="vblex.ger"/>
      <cat-item lemma="convertir# en" tags="vblex.ger"/>
      <cat-item lemma="descuidar" tags="vblex.ger"/>
      <cat-item lemma="empescar" tags="vblex.ger"/>
      <cat-item lemma="enfitar" tags="vblex.ger"/>
      <cat-item lemma="empantanar" tags="vblex.ger"/>
      <cat-item lemma="empantanegar" tags="vblex.ger"/>
      <cat-item lemma="enamorar" tags="vblex.ger"/>
      <cat-item lemma="encabir" tags="vblex.ger"/>
      <cat-item lemma="encimbellar" tags="vblex.ger"/>
      <cat-item lemma="enfilar" tags="vblex.ger"/>
      <cat-item lemma="enfonsar" tags="vblex.ger"/>
      <cat-item lemma="ensopegar" tags="vblex.ger"/>
      <cat-item lemma="entrebancar" tags="vblex.ger"/>
      <cat-item lemma="escarrufar" tags="vblex.ger"/>
      <cat-item lemma="esgarrifar" tags="vblex.ger"/>
      <cat-item lemma="estirar" tags="vblex.ger"/>
      <cat-item lemma="fer# càrrec de" tags="vblex.ger"/>
      <cat-item lemma="florir" tags="vblex.ger"/>
      <cat-item lemma="gitar" tags="vblex.ger"/>
      <cat-item lemma="jubilar" tags="vblex.ger"/>
      <cat-item lemma="moure" tags="vblex.ger"/>
      <cat-item lemma="negar" tags="vblex.ger"/>
      <cat-item lemma="oblidar# de" tags="vblex.ger"/>
      <cat-item lemma="penedir" tags="vblex.ger"/>
      <cat-item lemma="podrir" tags="vblex.ger"/>
      <cat-item lemma="recar" tags="vblex.ger"/>
      <cat-item lemma="reviscolar" tags="vblex.ger"/>
      <cat-item lemma="saber# greu" tags="vblex.ger"/>
      <cat-item lemma="soler" tags="vblex.ger"/>
      <cat-item lemma="submergir" tags="vblex.ger"/>
      <cat-item lemma="tornar" tags="vblex.ger"/>
    </def-cat>
    <def-cat n="verbospron_pp">
      <cat-item lemma="agrumollar" tags="vblex.pp.*"/>
      <cat-item lemma="aprimar" tags="vblex.pp.*"/>
      <cat-item lemma="atrevir" tags="vblex.pp.*"/>
      <cat-item lemma="avergonyir" tags="vblex.pp.*"/>
      <cat-item lemma="bellugar" tags="vblex.pp.*"/>
      <cat-item lemma="beure# l'enteniment" tags="vblex.pp.*"/>
      <cat-item lemma="cabussar" tags="vblex.pp.*"/>
      <cat-item lemma="capbussar" tags="vblex.pp.*"/>
      <cat-item lemma="concienciar" tags="vblex.pp.*"/>
      <cat-item lemma="convertir" tags="vblex.pp.*"/>
      <cat-item lemma="convertir# en" tags="vblex.pp.*"/>
      <cat-item lemma="descuidar" tags="vblex.pp.*"/>
      <cat-item lemma="empescar" tags="vblex.pp.*"/>
      <cat-item lemma="enfitar" tags="vblex.pp.*"/>
      <cat-item lemma="empantanar" tags="vblex.pp.*"/>
      <cat-item lemma="empantanegar" tags="vblex.pp.*"/>
      <cat-item lemma="enamorar" tags="vblex.pp.*"/>
      <cat-item lemma="encabir" tags="vblex.pp.*"/>
      <cat-item lemma="encimbellar" tags="vblex.pp.*"/>
      <cat-item lemma="enfilar" tags="vblex.pp.*"/>
      <cat-item lemma="enfonsar" tags="vblex.pp.*"/>
      <cat-item lemma="ensopegar" tags="vblex.pp.*"/>
      <cat-item lemma="entrebancar" tags="vblex.pp.*"/>
      <cat-item lemma="escarrufar" tags="vblex.pp.*"/>
      <cat-item lemma="esgarrifar" tags="vblex.pp.*"/>
      <cat-item lemma="estirar" tags="vblex.pp.*"/>
      <cat-item lemma="fer# càrrec de" tags="vblex.pp.*"/>
      <cat-item lemma="florir" tags="vblex.pp.*"/>
      <cat-item lemma="gitar" tags="vblex.pp.*"/>
      <cat-item lemma="jubilar" tags="vblex.pp.*"/>
      <cat-item lemma="moure" tags="vblex.pp.*"/>
      <cat-item lemma="negar" tags="vblex.pp.*"/>
      <cat-item lemma="oblidar# de" tags="vblex.pp.*"/>
      <cat-item lemma="penedir" tags="vblex.pp.*"/>
      <cat-item lemma="podrir" tags="vblex.pp.*"/>
      <cat-item lemma="recar" tags="vblex.pp.*"/>
      <cat-item lemma="reviscolar" tags="vblex.pp.*"/>
      <cat-item lemma="saber# greu" tags="vblex.pp.*"/>
      <cat-item lemma="soler" tags="vblex.pp.*"/>
      <cat-item lemma="submergir" tags="vblex.pp.*"/>
      <cat-item lemma="tornar" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="fa">
      <cat-item lemma="fer" tags="vblex.pri.p3.sg"/>
    </def-cat>
    <def-cat n="feia">
      <cat-item lemma="fer" tags="vblex.pii.p3.sg"/>
    </def-cat>
    <def-cat n="fa_feia">
      <cat-item lemma="fer" tags="vblex.pri.p3.sg"/>
      <cat-item lemma="fer" tags="vblex.pii.p3.sg"/>
    </def-cat>
    <def-cat n="inf_que">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item lemma="que" tags="cnjsub"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="xifra">
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="num_romans"> <!-- per a reis, segles, mil·lenis -->
      <cat-item lemma="I" tags="num.*"/>
      <cat-item lemma="II" tags="num.*"/>
      <cat-item lemma="III" tags="num.*"/>
      <cat-item lemma="IV" tags="num.*"/>
      <cat-item lemma="V" tags="num.*"/>
      <cat-item lemma="VI" tags="num.*"/>
      <cat-item lemma="VII" tags="num.*"/>
      <cat-item lemma="VIII" tags="num.*"/>
      <cat-item lemma="IX" tags="num.*"/>
      <cat-item lemma="X" tags="num.*"/>
      <cat-item lemma="XI" tags="num.*"/>
      <cat-item lemma="XII" tags="num.*"/>
      <cat-item lemma="XIII" tags="num.*"/>
      <cat-item lemma="XIV" tags="num.*"/>
      <cat-item lemma="XV" tags="num.*"/>
      <cat-item lemma="XVI" tags="num.*"/>
      <cat-item lemma="XVII" tags="num.*"/>
      <cat-item lemma="XVIII" tags="num.*"/>
      <cat-item lemma="XIX" tags="num.*"/>
      <cat-item lemma="XX" tags="num.*"/>
      <cat-item lemma="XXI" tags="num.*"/>
      <cat-item lemma="XXII" tags="num.*"/>
      <cat-item lemma="XXIII" tags="num.*"/>
      <cat-item lemma="XXIV" tags="num.*"/>
      <cat-item lemma="XXV" tags="num.*"/>
      <cat-item lemma="XXVI" tags="num.*"/>
      <cat-item lemma="XXVII" tags="num.*"/>
      <cat-item lemma="XXVIII" tags="num.*"/>
      <cat-item lemma="XXIX" tags="num.*"/>
      <cat-item lemma="XXX" tags="num.*"/>
      <cat-item lemma="i" tags="num.*"/>
      <cat-item lemma="ii" tags="num.*"/>
      <cat-item lemma="iii" tags="num.*"/>
      <cat-item lemma="iv" tags="num.*"/>
      <cat-item lemma="v" tags="num.*"/>
      <cat-item lemma="vi" tags="num.*"/>
      <cat-item lemma="vii" tags="num.*"/>
      <cat-item lemma="viii" tags="num.*"/>
      <cat-item lemma="ix" tags="num.*"/>
      <cat-item lemma="x" tags="num.*"/>
      <cat-item lemma="xi" tags="num.*"/>
      <cat-item lemma="xii" tags="num.*"/>
      <cat-item lemma="xiii" tags="num.*"/>
      <cat-item lemma="xiv" tags="num.*"/>
      <cat-item lemma="xv" tags="num.*"/>
      <cat-item lemma="xvi" tags="num.*"/>
      <cat-item lemma="xvii" tags="num.*"/>
      <cat-item lemma="xviii" tags="num.*"/>
      <cat-item lemma="xix" tags="num.*"/>
      <cat-item lemma="xx" tags="num.*"/>
      <cat-item lemma="xxi" tags="num.*"/>
      <cat-item lemma="xxii" tags="num.*"/>
      <cat-item lemma="xxiii" tags="num.*"/>
      <cat-item lemma="xxiv" tags="num.*"/>
      <cat-item lemma="xxv" tags="num.*"/>
      <cat-item lemma="xxvi" tags="num.*"/>
      <cat-item lemma="xxvii" tags="num.*"/>
      <cat-item lemma="xxviii" tags="num.*"/>
      <cat-item lemma="xxix" tags="num.*"/>
      <cat-item lemma="xxx" tags="num.*"/>
      <cat-item lemma="I" tags="adj.*"/>
      <cat-item lemma="II" tags="adj.*"/>
      <cat-item lemma="III" tags="adj.*"/>
      <cat-item lemma="IV" tags="adj.*"/>
      <cat-item lemma="V" tags="adj.*"/>
      <cat-item lemma="VI" tags="adj.*"/>
      <cat-item lemma="VII" tags="adj.*"/>
      <cat-item lemma="VIII" tags="adj.*"/>
      <cat-item lemma="IX" tags="adj.*"/>
      <cat-item lemma="X" tags="adj.*"/>
      <cat-item lemma="XI" tags="adj.*"/>
      <cat-item lemma="XII" tags="adj.*"/>
      <cat-item lemma="XIII" tags="adj.*"/>
      <cat-item lemma="XIV" tags="adj.*"/>
      <cat-item lemma="XV" tags="adj.*"/>
      <cat-item lemma="XVI" tags="adj.*"/>
      <cat-item lemma="XVII" tags="adj.*"/>
      <cat-item lemma="XVIII" tags="adj.*"/>
      <cat-item lemma="XIX" tags="adj.*"/>
      <cat-item lemma="XX" tags="adj.*"/>
      <cat-item lemma="XXI" tags="adj.*"/>
      <cat-item lemma="XXII" tags="adj.*"/>
      <cat-item lemma="XXIII" tags="adj.*"/>
      <cat-item lemma="XXIV" tags="adj.*"/>
      <cat-item lemma="XXV" tags="adj.*"/>
      <cat-item lemma="XXVI" tags="adj.*"/>
      <cat-item lemma="XXVII" tags="adj.*"/>
      <cat-item lemma="XXVIII" tags="adj.*"/>
      <cat-item lemma="XXIX" tags="adj.*"/>
      <cat-item lemma="XXX" tags="adj.*"/>
      <cat-item lemma="i" tags="adj.*"/>
      <cat-item lemma="ii" tags="adj.*"/>
      <cat-item lemma="iii" tags="adj.*"/>
      <cat-item lemma="iv" tags="adj.*"/>
      <cat-item lemma="v" tags="adj.*"/>
      <cat-item lemma="vi" tags="adj.*"/>
      <cat-item lemma="vii" tags="adj.*"/>
      <cat-item lemma="viii" tags="adj.*"/>
      <cat-item lemma="ix" tags="adj.*"/>
      <cat-item lemma="x" tags="adj.*"/>
      <cat-item lemma="xi" tags="adj.*"/>
      <cat-item lemma="xii" tags="adj.*"/>
      <cat-item lemma="xiii" tags="adj.*"/>
      <cat-item lemma="xiv" tags="adj.*"/>
      <cat-item lemma="xv" tags="adj.*"/>
      <cat-item lemma="xvi" tags="adj.*"/>
      <cat-item lemma="xvii" tags="adj.*"/>
      <cat-item lemma="xviii" tags="adj.*"/>
      <cat-item lemma="xix" tags="adj.*"/>
      <cat-item lemma="xx" tags="adj.*"/>
      <cat-item lemma="xxi" tags="adj.*"/>
      <cat-item lemma="xxii" tags="adj.*"/>
      <cat-item lemma="xxiii" tags="adj.*"/>
      <cat-item lemma="xxiv" tags="adj.*"/>
      <cat-item lemma="xxv" tags="adj.*"/>
      <cat-item lemma="xxvi" tags="adj.*"/>
      <cat-item lemma="xxvii" tags="adj.*"/>
      <cat-item lemma="xxviii" tags="adj.*"/>
      <cat-item lemma="xxix" tags="adj.*"/>
      <cat-item lemma="xxx" tags="adj.*"/>
    </def-cat>
    <def-cat n="mes">
      <cat-item lemma="gener" tags="n.*"/>
      <cat-item lemma="febrer" tags="n.*"/>
      <cat-item lemma="març" tags="n.*"/>
      <cat-item lemma="abril" tags="n.*"/>
      <cat-item lemma="maig" tags="n.*"/>
      <cat-item lemma="juny" tags="n.*"/>
      <cat-item lemma="juliol" tags="n.*"/>
      <cat-item lemma="agost" tags="n.*"/>
      <cat-item lemma="setembre" tags="n.*"/>
      <cat-item lemma="octubre" tags="n.*"/>
      <cat-item lemma="novembre" tags="n.*"/>
      <cat-item lemma="desembre" tags="n.*"/>
      <cat-item lemma="veremari" tags="n.*"/>
      <cat-item lemma="brumari" tags="n.*"/>
      <cat-item lemma="frimari" tags="n.*"/>
      <cat-item lemma="rufolari" tags="n.*"/>
      <cat-item lemma="nivós" tags="n.*"/>
      <cat-item lemma="pluviós" tags="n.*"/>
      <cat-item lemma="ventós" tags="n.*"/>
      <cat-item lemma="germinal" tags="n.*"/>
      <cat-item lemma="floreal" tags="n.*"/>
      <cat-item lemma="pradal" tags="n.*"/>
      <cat-item lemma="messidor" tags="n.*"/>
      <cat-item lemma="termidor" tags="n.*"/>
      <cat-item lemma="fructidor" tags="n.*"/>
    </def-cat>
    <def-cat n="any">
      <cat-item lemma="any" tags="n.*"/>
    </def-cat>
    <def-cat n="segle">
      <cat-item lemma="segle" tags="n.*"/>
      <cat-item lemma="mil·leni" tags="n.*"/>
    </def-cat>
    <def-cat n="dia_setmana">
      <cat-item lemma="dilluns" tags="n.*"/>
      <cat-item lemma="dimarts" tags="n.*"/>
      <cat-item lemma="dimecres" tags="n.*"/>
      <cat-item lemma="dijous" tags="n.*"/>
      <cat-item lemma="divendres" tags="n.*"/>
      <cat-item lemma="dissabte" tags="n.*"/>
      <cat-item lemma="diumenge" tags="n.*"/>
    </def-cat>
    <def-cat n="n_temps">
      <cat-item lemma="dia" tags="n.*"/>
      <cat-item lemma="setmana" tags="n.*"/>
      <cat-item lemma="mes" tags="n.*"/>
      <cat-item lemma="any" tags="n.*"/>
      <cat-item lemma="lustre" tags="n.*"/>
      <cat-item lemma="dècada" tags="n.*"/>
      <cat-item lemma="segle" tags="n.*"/>
      <cat-item lemma="mil·leni" tags="n.*"/>
      <cat-item lemma="dilluns" tags="n.*"/>
      <cat-item lemma="dimarts" tags="n.*"/>
      <cat-item lemma="dimecres" tags="n.*"/>
      <cat-item lemma="dijous" tags="n.*"/>
      <cat-item lemma="divendres" tags="n.*"/>
      <cat-item lemma="dissabte" tags="n.*"/>
      <cat-item lemma="diumenge" tags="n.*"/>
    </def-cat>
    <def-cat n="n_temps_pl">
      <cat-item lemma="dia" tags="n.*.pl"/>
      <cat-item lemma="setmana" tags="n.*.pl"/>
      <cat-item lemma="mes" tags="n.*.pl"/>
      <cat-item lemma="any" tags="n.*.pl"/>
      <cat-item lemma="lustre" tags="n.*.pl"/>
      <cat-item lemma="dècada" tags="n.*.pl"/>
      <cat-item lemma="segle" tags="n.*.pl"/>
      <cat-item lemma="mil·leni" tags="n.*.pl"/>
    </def-cat>
    <def-cat n="part_dia_n">
      <cat-item lemma="matí" tags="n.*"/>
      <cat-item lemma="tarda" tags="n.*"/>
      <cat-item lemma="vesprada" tags="n.*"/>
      <cat-item lemma="vespre" tags="n.*"/>
      <cat-item lemma="nit" tags="n.*"/>
      <cat-item lemma="matinada" tags="n.*"/>
    </def-cat>
    <def-cat n="part_dia_adv">
      <cat-item lemma="al matí" tags="adv"/>
      <cat-item lemma="a la tarda" tags="adv"/>
      <cat-item lemma="a la vesprada" tags="adv"/>
      <cat-item lemma="al vespre" tags="adv"/>
      <cat-item lemma="a la nit" tags="adv"/>
      <cat-item lemma="de matinada" tags="adv"/>
    </def-cat>
    <def-cat n="n_senyor">
      <cat-item lemma="senyor" tags="n.*"/>
      <cat-item lemma="senyoret" tags="n.f.*"/>
    </def-cat>
    <def-cat n="ca">
      <cat-item lemma="ca" tags="n.*"/>
      <cat-item lemma="a ca" tags="pr"/>
    </def-cat>
    <def-cat n="multiHiha">
      <cat-item lemma="hi ha" tags="vblex.pri.p3.sg"/>
    </def-cat>
    <def-cat n="anar_continuar">
      <cat-item lemma="anar" tags="vblex.*"/>
      <cat-item lemma="continuar" tags="vblex.*"/>
      <cat-item lemma="seguir" tags="vblex.*"/>
    </def-cat>
    <def-cat n="anar_continuar_inf">
      <cat-item lemma="anar" tags="vblex.inf"/>
      <cat-item lemma="continuar" tags="vblex.inf"/>
      <cat-item lemma="seguir" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="anar_continuar_ppmsg">
      <cat-item lemma="anar" tags="vblex.pp.m.sg"/>
      <cat-item lemma="continuar" tags="vblex.pp.m.sg"/>
      <cat-item lemma="seguir" tags="vblex.pp.m.sg"/>
    </def-cat>
    <def-cat n="anar_continuar_cnj">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
      <cat-item lemma="anar" tags="vblex.prs.*"/>
      <cat-item lemma="anar" tags="vblex.pii.*"/>
      <cat-item lemma="anar" tags="vblex.pis.*"/>
      <cat-item lemma="anar" tags="vblex.cni.*"/>
      <cat-item lemma="anar" tags="vblex.ifi.*"/>
      <cat-item lemma="anar" tags="vblex.fti.*"/>
      <cat-item lemma="anar" tags="vblex.imp.*"/>
      <cat-item lemma="continuar" tags="vblex.pri.*"/>
      <cat-item lemma="continuar" tags="vblex.prs.*"/>
      <cat-item lemma="continuar" tags="vblex.pii.*"/>
      <cat-item lemma="continuar" tags="vblex.pis.*"/>
      <cat-item lemma="continuar" tags="vblex.cni.*"/>
      <cat-item lemma="continuar" tags="vblex.ifi.*"/>
      <cat-item lemma="continuar" tags="vblex.fti.*"/>
      <cat-item lemma="continuar" tags="vblex.imp.*"/>
      <cat-item lemma="seguir" tags="vblex.pri.*"/>
      <cat-item lemma="seguir" tags="vblex.prs.*"/>
      <cat-item lemma="seguir" tags="vblex.pii.*"/>
      <cat-item lemma="seguir" tags="vblex.pis.*"/>
      <cat-item lemma="seguir" tags="vblex.cni.*"/>
      <cat-item lemma="seguir" tags="vblex.ifi.*"/>
      <cat-item lemma="seguir" tags="vblex.fti.*"/>
      <cat-item lemma="seguir" tags="vblex.imp.*"/>
    </def-cat>
    <def-cat n="anar_continuar_p3">
      <cat-item lemma="anar" tags="vblex.pri.p3.*"/>
      <cat-item lemma="anar" tags="vblex.prs.p3.*"/>
      <cat-item lemma="anar" tags="vblex.pii.p3.*"/>
      <cat-item lemma="anar" tags="vblex.pis.p3.*"/>
      <cat-item lemma="anar" tags="vblex.cni.p3.*"/>
      <cat-item lemma="anar" tags="vblex.ifi.p3.*"/>
      <cat-item lemma="anar" tags="vblex.fti.p3.*"/>
      <cat-item lemma="anar" tags="vblex.imp.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.pri.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.prs.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.pii.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.pis.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.cni.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.ifi.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.fti.p3.*"/>
      <cat-item lemma="continuar" tags="vblex.imp.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.pri.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.prs.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.pii.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.pis.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.cni.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.ifi.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.fti.p3.*"/>
      <cat-item lemma="seguir" tags="vblex.imp.p3.*"/>
    </def-cat>
    <def-cat n="anarpri">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
    </def-cat>
    <def-cat n="anarprip3">
      <cat-item lemma="anar" tags="vblex.pri.p3.*"/>
    </def-cat>
    <def-cat n="molt">
      <cat-item lemma="molt" tags="preadv"/>
      <cat-item lemma="molt" tags="adv"/>
      <cat-item lemma="molt" tags="adj.m.sg"/>
    </def-cat>
    <def-cat n="comp">
      <cat-item lemma="tant" tags="adj.*"/>
      <cat-item lemma="més" tags="adv"/>
      <cat-item lemma="menys" tags="adv"/>
      <cat-item lemma="manco" tags="adv"/>
    </def-cat>
    <def-cat n="lopronom">
      <cat-item lemma="el" tags="prn.pro.p3.mf.sg"/>
    </def-cat>
    <def-cat n="nosaltres">
      <cat-item lemma="nosaltres" tags="prn.tn.p1.mf.pl"/>
      <cat-item lemma="vosaltres" tags="prn.tn.p2.mf.pl"/>
    </def-cat>
    <def-cat n="en">
      <cat-item lemma="en" tags="pr"/>
    </def-cat>
    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="per">
      <cat-item lemma="per" tags="pr"/>
    </def-cat>
    <def-cat n="dir">
      <cat-item lemma="dir" tags="vblex.pri.*"/>
      <cat-item lemma="dir" tags="vblex.pii.*"/>
      <cat-item lemma="dir" tags="vblex.fti.*"/>
      <cat-item lemma="dir" tags="vblex.ifi.*"/>
      <cat-item lemma="dir" tags="vblex.cni.*"/>
    </def-cat>
    <def-cat n="passiva_reflexa_p3sg">
      <cat-item lemma="dir" tags="vblex.*.p3.sg"/>
      <cat-item lemma="discutir" tags="vblex.*.p3.sg"/>
      <cat-item lemma="parlar" tags="vblex.*.p3.sg"/>
      <cat-item lemma="voler" tags="vbmod.*.p3.sg"/>
    </def-cat>
    <def-cat n="passiva_reflexa_pp">
      <cat-item lemma="dir" tags="vblex.pp.m.sg"/>
      <cat-item lemma="discutir" tags="vblex.pp.m.sg"/>
      <cat-item lemma="parlar" tags="vblex.pp.m.sg"/>
      <cat-item lemma="voler" tags="vbmod.pp.m.sg"/>
    </def-cat>
    <def-cat n="haver">
      <cat-item lemma="haver" tags="vbhaver.*"/>
    </def-cat>
    <def-cat n="haver_prip3sg">
      <cat-item lemma="haver" tags="vbhaver.pri.p3.sg"/>
    </def-cat>
    <def-cat n="haverde">
      <cat-item lemma="haver# de" tags="vbmod.*"/>
    </def-cat>
    <def-cat n="haverde_inf">
      <cat-item lemma="haver# de" tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="haverde_pp">
      <cat-item lemma="haver# de" tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="caldre">
      <cat-item lemma="caldre" tags="vbmod.*"/>
    </def-cat>
    <def-cat n="caldre_inf">
      <cat-item lemma="caldre" tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="caldre_pp">
      <cat-item lemma="caldre" tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="voler_mod">
      <cat-item lemma="voler" tags="vbmod.*"/>
    </def-cat>
    <def-cat n="voler_mod_inf">
      <cat-item lemma="voler" tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="voler_mod_pp">
      <cat-item lemma="voler" tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="soler">
      <cat-item lemma="soler" tags="vblex.*"/>
    </def-cat>
    <def-cat n="soler_inf">
      <cat-item lemma="soler" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="soler_pp">
      <cat-item lemma="soler" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="tornar">
      <cat-item lemma="tornar" tags="vblex.*"/>
    </def-cat>
    <def-cat n="tornar_inf">
      <cat-item lemma="tornar" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="tornar_conj">
      <cat-item lemma="tornar" tags="vblex.*.p1.*"/>
      <cat-item lemma="tornar" tags="vblex.*.p2.*"/>
      <cat-item lemma="tornar" tags="vblex.*.p3.*"/>
    </def-cat>
    <def-cat n="tornar_pp">
      <cat-item lemma="tornar" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="ij">
      <cat-item tags="ij"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>
    <def-cat n="cm">
      <cat-item tags="cm"/>
    </def-cat>
    <def-cat n="lpar">
      <cat-item tags="lpar"/>
    </def-cat>
    <def-cat n="rpar">
      <cat-item tags="rpar"/>
    </def-cat>
    <def-cat n="sentquecm">
      <cat-item tags="sent"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
      <cat-item tags="cm"/>
      <cat-item tags="cnjcoo"/>
      <cat-item lemma="comme que" tags="cnjadv"/>
    </def-cat>
    <def-cat n="sentquecmrel">
      <cat-item tags="sent"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="rel.*"/>
      <cat-item tags="cnjadv"/>
      <cat-item tags="cm"/>
      <cat-item tags="cnjcoo"/>
      <cat-item lemma="comme que" tags="cnjadv"/>
    </def-cat>
    <def-cat n="sentque_nocm">
      <cat-item tags="sent"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
      <cat-item tags="cnjcoo"/>
      <cat-item lemma="comme que" tags="cnjadv"/>
    </def-cat>
    <def-cat n="sentquerel_nocm">
      <cat-item tags="sent"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="rel.*"/>
      <cat-item tags="cnjadv"/>
      <cat-item tags="cnjcoo"/>
      <cat-item lemma="comme que" tags="cnjadv"/>
    </def-cat>
    <def-cat n="occ_or_etc">
      <cat-item lemma="occidental" tags="adj.*"/>
      <cat-item lemma="oriental" tags="adj.*"/>
      <cat-item lemma="central" tags="adj.*"/>
      <cat-item lemma="septentrional" tags="adj.*"/>
      <cat-item lemma="meridional" tags="adj.*"/>
    </def-cat>
    <def-cat n="quants">
      <cat-item lemma="quant" tags="*.pl"/>
    </def-cat>
  </section-def-cats>

  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
    </def-attr>
    <def-attr n="a_npant">
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_nptop">
      <attr-item tags="np.top"/>
      <attr-item tags="np.loc"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_detdef">
      <attr-item tags="det.def"/>
    </def-attr>
    <def-attr n="a_predet">
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
    </def-attr>
     <def-attr n="a_sup">
      <attr-item tags="sup"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
    <def-attr n="a_prep">
      <attr-item tags="pr"/>
    </def-attr>
    <def-attr n="a_relat">
      <attr-item tags="rel.adv"/>
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.aa"/>
      <attr-item tags="rel.an"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn.tn.p1"/>
      <attr-item tags="prn.tn.p2"/>
      <attr-item tags="prn.tn.p3"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.tn.ref.p3"/>
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.itg"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.ref"/>
      <attr-item tags="prn.enc.adv"/>
    </def-attr>
    <def-attr n="a_prnpro">
      <attr-item tags="prn.pro"/>
      <attr-item tags="prn.pro.ref"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_inf">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbser.inf"/>
      <attr-item tags="vbhaver.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_infnm">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbser.inf"/>
      <attr-item tags="vbhaver.inf"/>
    </def-attr>
    <def-attr n="a_infnh">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbser.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbhaver.pp"/>
      <attr-item tags="vbmod.pp"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_xifra">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="persona">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="tipoadv">
      <attr-item tags="itg"/>
    </def-attr>
    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
      <attr-item tags="p3.mf.sg"/>
      <attr-item tags="p3.mf.pl"/>
      <attr-item tags="p3.mf.sp"/>
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.f.pl"/>
      <attr-item tags="p3.nt"/>
      <attr-item tags="adv"/>
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="ifi"/>
      <attr-item tags="pii"/>
      <attr-item tags="fti"/>
      <attr-item tags="cni"/>
      <attr-item tags="prs"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="imp"/>
    </def-attr>
  </section-def-attrs>

  <section-def-vars>
    <def-var n="inici" v="&lt;si&gt;"/> <!-- indica si és la primera frase que es tradueix -->
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="genero_tmp"/>
    <def-var n="numero"/>
    <def-var n="numero_tmp"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="afegir_putain"/>
  </section-def-vars>

  <section-def-lists>
    <def-list n="verbs_moviment">
      <list-item v="anar"/>
      <list-item v="traslladar"/>
      <list-item v="viatjar"/>
      <list-item v="emigrar"/>
      <list-item v="inmigrar"/>
      <list-item v="moure"/>
      <list-item v="venir"/>
      <list-item v="vindre"/>
      <list-item v="eixir"/>
      <list-item v="sortir"/>
      <list-item v="entrar"/>
      <list-item v="pujar"/>
      <list-item v="baixar"/>
      <list-item v="caminar"/>
      <list-item v="dirigir"/>
      <list-item v="apropar"/>
      <list-item v="córrer"/>
      <list-item v="portar"/>
      <list-item v="passar"/>
      <list-item v="tornar"/>
      <list-item v="regressar"/>
      <list-item v="arribar"/>
      <list-item v="aparèixer"/>
      <list-item v="marxar"/>
    </def-list>

    <def-list n="verbs_estat">
      <list-item v="conviure"/>
      <list-item v="viure"/>
      <list-item v="actuar"/>
      <list-item v="allotjar"/>
      <list-item v="assentar"/>
      <list-item v="buscar"/>
      <list-item v="celebrar"/>
      <list-item v="centralitzar"/>
      <list-item v="cercar"/>
      <list-item v="col·locar"/>
      <list-item v="concentrar"/>
      <list-item v="desembocar"/>
      <list-item v="endinsar"/>
      <list-item v="establir"/>
      <list-item v="estrenar"/>
      <list-item v="excavar"/>
      <list-item v="exercir"/>
      <list-item v="existir"/>
      <list-item v="exposar"/>
      <list-item v="ficar"/>
      <list-item v="inaugurar"/>
      <list-item v="incloure"/>
      <list-item v="indagar"/>
      <list-item v="ingressar"/>
      <list-item v="inserir"/>
      <list-item v="instal·lar"/>
      <list-item v="introduir"/>
      <list-item v="irrompre"/>
      <list-item v="penetrar"/>
      <list-item v="pescar"/>
      <list-item v="publicar"/>
      <list-item v="reunir"/>
      <list-item v="romandre"/>
      <list-item v="treballar"/>
      <list-item v="trobar"/>
      <list-item v="ubicar"/>
      <list-item v="estudiar"/>
    </def-list>

    <def-list n="vbambser">
      <list-item v="aller"/>
      <list-item v="apparaître"/>
      <list-item v="paraître"/>
      <list-item v="arriver"/>
      <list-item v="venir"/>
      <list-item v="partir"/>
      <list-item v="naître"/>
      <list-item v="renaître"/>
      <list-item v="mourir"/>
      <list-item v="descendre"/>
      <list-item v="monter"/>
      <list-item v="entrer"/>
      <list-item v="rentrer"/>
      <list-item v="sortir"/>
      <list-item v="tomber"/>
      <list-item v="retourner"/>
      <list-item v="passer"/>
      <list-item v="rester"/>
      <list-item v="devenir"/>
      <list-item v="revenir"/>
    </def-list>

    <!--
    <def-list n="vbestat">
      <list-item v="aller"/>
      <list-item v="apparaître"/>
      <list-item v="paraître"/>
      <list-item v="arriver"/>
      <list-item v="venir"/>
      <list-item v="partir"/>
      <list-item v="naître"/>
      <list-item v="mourir"/>
      <list-item v="descendre"/>
      <list-item v="monter"/>
      <list-item v="entrer"/>
      <list-item v="sortir"/>
      <list-item v="tomber"/>
      <list-item v="retourner"/>
      <list-item v="passer"/>
      <list-item v="rester"/>
      <list-item v="devenir"/>
      <list-item v="revenir"/>
    </def-list>
    -->

    <def-list n="mesos">
      <list-item v="gener"/>
      <list-item v="febrer"/>
      <list-item v="març"/>
      <list-item v="abril"/>
      <list-item v="maig"/>
      <list-item v="juny"/>
      <list-item v="juliol"/>
      <list-item v="agost"/>
      <list-item v="setembre"/>
      <list-item v="octubre"/>
      <list-item v="novembre"/>
      <list-item v="desembre"/>
      <list-item v="veremari"/>
      <list-item v="brumari"/>
      <list-item v="frimari"/>
      <list-item v="rufolari"/>
      <list-item v="nivós"/>
      <list-item v="pluviós"/>
      <list-item v="ventós"/>
      <list-item v="germinal"/>
      <list-item v="floreal"/>
      <list-item v="pradal"/>
      <list-item v="messidor"/>
      <list-item v="termidor"/>
      <list-item v="fructidor"/>
    </def-list>

    <def-list n="lang_dial">
      <list-item v="portugais"/>
      <list-item v="espagnol"/>
      <list-item v="catalan"/>
      <list-item v="valencien"/>
      <list-item v="majorquin"/>
      <list-item v="majorquain"/>
      <list-item v="minorquin"/>
      <list-item v="mahonnais"/>
      <list-item v="ibizois"/>
      <list-item v="baléare"/>
      <list-item v="alguérois"/>
      <list-item v="roussillonnais"/>
      <list-item v="aragonais"/>
      <list-item v="asturien"/>
      <list-item v="léonais"/>
      <list-item v="mirandais"/>
      <list-item v="basque"/>
      <list-item v="castillan"/>
      <list-item v="andalou"/>
      <list-item v="mozarabe"/>
      <list-item v="français"/>
      <list-item v="breton"/>
      <list-item v="normand"/>
      <list-item v="champenois"/>
      <list-item v="franc-comtois"/>
      <list-item v="lorrain"/>
      <list-item v="picard"/>
      <list-item v="chti"/>
      <list-item v="ch'ti"/>
      <list-item v="alsacien"/>
      <list-item v="bourgonde"/>
      <list-item v="bourguignon"/>
      <list-item v="poitevin"/>
      <list-item v="saintongeais"/>
      <list-item v="angevin"/>
      <list-item v="occitan"/>
      <list-item v="aranais"/>
      <list-item v="corse"/>
      <list-item v="auvergnat"/>
      <list-item v="limousin"/>
      <list-item v="gascon"/>
      <list-item v="béarnais"/>
      <list-item v="languedocien"/>
      <list-item v="provençal"/>
      <list-item v="niçois"/>
      <list-item v="savoyard"/>
      <list-item v="luxembourgeois"/>
      <list-item v="anglais"/>
      <list-item v="écossais"/>
      <list-item v="gallois"/>
      <list-item v="mannois"/>
      <list-item v="cornique"/>
      <list-item v="irlandais"/>
      <list-item v="wallon"/>
      <list-item v="flamand"/>
      <list-item v="hollandais"/>
      <list-item v="néerlandais"/>
      <list-item v="brabançon"/>
      <list-item v="limbourgeois"/>
      <list-item v="frison"/>
      <list-item v="allemand"/>
      <list-item v="bavarois"/>
      <list-item v="souabe"/>
      <list-item v="burgonde"/>
      <list-item v="danois"/>
      <list-item v="islandais"/>
      <list-item v="norvégien"/>
      <list-item v="suédois"/>
      <list-item v="finlandais"/>
      <list-item v="finnois"/>
      <list-item v="carélien"/>
      <list-item v="russe"/>
      <list-item v="slave"/>
      <list-item v="tchétchène"/>
      <list-item v="ingouche"/>
      <list-item v="karatchaï"/>
      <list-item v="balkar"/>
      <list-item v="kabarde"/>
      <list-item v="circassien"/>
      <list-item v="ossète"/>
      <list-item v="tchouvache"/>
      <list-item v="tatar"/>
      <list-item v="tatare"/>
      <list-item v="tartare"/>
      <list-item v="bachkir"/>
      <list-item v="komi"/>
      <list-item v="oudmourte"/>
      <list-item v="mordve"/>
      <list-item v="khanty"/>
      <list-item v="mansi"/>
      <list-item v="kalmouk"/>
      <list-item v="yakoute"/>
      <list-item v="iakoute"/>
      <list-item v="tchouktche"/>
      <list-item v="youkaguir"/>
      <list-item v="nivkhe"/>
      <list-item v="guiliak"/>
      <list-item v="koriak"/>
      <list-item v="itelmène"/>
      <list-item v="kamtchadale"/>
      <list-item v="khakasse"/>
      <list-item v="touvinien"/>
      <list-item v="altaïen"/>
      <list-item v="nogaï"/>
      <list-item v="estonien"/>
      <list-item v="letton"/>
      <list-item v="lituanien"/>
      <list-item v="lithuanien"/>
      <list-item v="balte"/>
      <list-item v="polonais"/>
      <list-item v="juif"/>
      <list-item v="sorabe"/>
      <list-item v="cachoube"/>
      <list-item v="tchèque"/>
      <list-item v="slovaque"/>
      <list-item v="hongrois"/>
      <list-item v="vaudois"/>
      <list-item v="italien"/>
      <list-item v="sarde"/>
      <list-item v="piémontais"/>
      <list-item v="lombard"/>
      <list-item v="émilien"/>
      <list-item v="romagnol"/>
      <list-item v="ligure"/>
      <list-item v="ligurien"/>
      <list-item v="génois"/>
      <list-item v="sicilien"/>
      <list-item v="napolitain"/>
      <list-item v="calabrais"/>
      <list-item v="toscan"/>
      <list-item v="florentin"/>
      <list-item v="vénitien"/>
      <list-item v="frioulan"/>
      <list-item v="istriote"/>
      <list-item v="maltais"/>
      <list-item v="slovène"/>
      <list-item v="dalmate"/>
      <list-item v="croate"/>
      <list-item v="serbe"/>
      <list-item v="bosniaque"/>
      <list-item v="bosnien"/>
      <list-item v="monténégrin"/>
      <list-item v="macédonien"/>
      <list-item v="roumain"/>
      <list-item v="moldave"/>
      <list-item v="bulgare"/>
      <list-item v="albanés"/>
      <list-item v="rom"/>
      <list-item v="romani"/>
      <list-item v="grec"/>
      <list-item v="achéen"/>
      <list-item v="minoen"/>
      <list-item v="mycénien"/>
      <list-item v="béotien"/>
      <list-item v="étolien"/>
      <list-item v="phocidien"/>
      <list-item v="thessalien"/>
      <list-item v="ukrainien"/>
      <list-item v="ruthène"/>
      <list-item v="biélorusse"/>
      <list-item v="moldave"/>
      <list-item v="turc"/>
      <list-item v="ottoman"/>
      <list-item v="avar"/>
      <list-item v="petchénègue"/>
      <list-item v="couman"/>
      <list-item v="kiptchak"/>
      <list-item v="polovtse"/>
      <list-item v="kurde"/>
      <list-item v="arménien"/>
      <list-item v="géorgien"/>
      <list-item v="mingrélien"/>
      <list-item v="laze"/>
      <list-item v="abkhaze"/>
      <list-item v="azerbaïdjanais"/>
      <list-item v="kazakh"/>
      <list-item v="karakalpak"/>
      <list-item v="turkmène"/>
      <list-item v="turcoman"/>
      <list-item v="ouzbek"/>
      <list-item v="kirghiz"/>
      <list-item v="tadjik"/>
      <list-item v="mongol"/>
      <list-item v="moghol"/>
      <list-item v="mogol"/>
      <list-item v="bouriate"/>
      <list-item v="mandchou"/>
      <list-item v="toungouse"/>
      <list-item v="évenk"/>
      <list-item v="ouïghour"/>
      <list-item v="cachemiri"/>
      <list-item v="cachemirien"/>
      <list-item v="baloutche"/>
      <list-item v="sindi"/>
      <list-item v="sindhi"/>
      <list-item v="pendjabi"/>
      <list-item v="panjabi"/>
      <list-item v="punjabi"/>
      <list-item v="arabe"/>
      <list-item v="sarrasin"/>
      <list-item v="hébreu"/>
      <list-item v="cananéen"/>
      <list-item v="nabatéen"/>
      <list-item v="amazigh"/>
      <list-item v="amazighe"/>
      <list-item v="berbère"/>
      <list-item v="kabyle"/>
      <list-item v="touareg"/>
      <list-item v="copte"/>
      <list-item v="nubien"/>
      <list-item v="bhojpuri"/>
      <list-item v="bengali"/>
      <list-item v="bengalais"/>
      <list-item v="marathe"/>
      <list-item v="gujarati"/>
      <list-item v="tamoul"/>
      <list-item v="tamil"/>
      <list-item v="télougou"/>
      <list-item v="cingalais"/>
      <list-item v="népalais"/>
      <list-item v="tibétain"/>
      <list-item v="chinois"/>
      <list-item v="cantonais"/>
      <list-item v="japonais"/>
      <list-item v="aïnou"/>
      <list-item v="coréen"/>
      <list-item v="vietnamien"/>
      <list-item v="thaïlandais"/>
      <list-item v="birman"/>
      <list-item v="laotien"/>
      <list-item v="cambodgien"/>
      <list-item v="khmer"/>
      <list-item v="karen"/>
      <list-item v="karène"/>
      <list-item v="malais"/>
      <list-item v="tagal"/>
      <list-item v="indonésien"/>
      <list-item v="javanais"/>
      <list-item v="taïwanais"/>
      <list-item v="hawaïen"/>
      <list-item v="tahitien"/>
      <list-item v="samoan"/>
      <list-item v="tongan"/>
      <list-item v="nauruan"/>
      <list-item v="maori"/>
      <list-item v="éthiopien"/>
      <list-item v="afar"/>
      <list-item v="amhara"/>
      <list-item v="sidama"/>
      <list-item v="oromo"/>
      <list-item v="somalien"/>
      <list-item v="malgache"/>
      <list-item v="wolof"/>
      <list-item v="peul"/>
      <list-item v="bambara"/>
      <list-item v="mandingue"/>
      <list-item v="songhaï"/>
      <list-item v="haoussa"/>
      <list-item v="yoruba"/>
      <list-item v="igbo"/>
      <list-item v="bantou"/>
      <list-item v="swahili"/>
      <list-item v="zoulou"/>
      <list-item v="kikuyu"/>
      <list-item v="kimbundu"/>
      <list-item v="tswana"/>
      <list-item v="swazi"/>
      <list-item v="hottentot"/>
      <list-item v="bochiman"/>
      <list-item v="apache"/>
      <list-item v="algonquien"/>
      <list-item v="algonquin"/>
      <list-item v="chinook"/>
      <list-item v="cherokee"/>
      <list-item v="chéroki"/>
      <list-item v="tchéroki"/>
      <list-item v="mohawk"/>
      <list-item v="huron"/>
      <list-item v="iroquois"/>
      <list-item v="comanche"/>
      <list-item v="navajo"/>
      <list-item v="creek"/>
      <list-item v="kiowa"/>
      <list-item v="esquimau"/>
      <list-item v="mapuche"/>
      <list-item v="gaulois"/>
      <list-item v="ibère"/>
      <list-item v="celtibère"/>
      <list-item v="étrusque"/>
      <list-item v="latin"/>
      <list-item v="sabin"/>
      <list-item v="ombrien"/>
      <list-item v="osque"/>
      <list-item v="thrace"/>
      <list-item v="dace"/>
      <list-item v="illyrien"/>
      <list-item v="troyen"/>
      <list-item v="lydien"/>
      <list-item v="lycien"/>
      <list-item v="phrygien"/>
      <list-item v="ionien"/>
      <list-item v="dorien"/>
      <list-item v="locrien"/>
      <list-item v="crétois"/>
      <list-item v="sogdien"/>
      <list-item v="bactrien"/>
      <list-item v="élamite"/>
      <list-item v="proto-élamite"/>
      <list-item v="perse"/>
      <list-item v="persan"/>
      <list-item v="sumérien"/>
      <list-item v="akkadien"/>
      <list-item v="accadien"/>
      <list-item v="hittite"/>
      <list-item v="hourrite"/>
      <list-item v="hurrite"/>
      <list-item v="nabatéen"/>
      <list-item v="araméen"/>
      <list-item v="guarani"/>
      <list-item v="aymara"/>
      <list-item v="quechua"/>
      <list-item v="quichua"/>
    </def-list>

    <def-list n="pais">
      <list-item v="Europe"/>
      <list-item v="Asie"/>
      <list-item v="Afrique"/>
      <list-item v="Afrique du Sud"/>
      <list-item v="Amérique"/>
      <list-item v="Amérique Centrale"/>
      <list-item v="Amérique du Nord"/>
      <list-item v="Amérique du Sud"/>
      <list-item v="Amazonie"/>
      <list-item v="Océanie"/>
      <list-item v="Eurasie"/>
      <list-item v="Pangée"/>
      <list-item v="Gondwana"/>
      <list-item v="Australie"/>
      <list-item v="Australie-Méridionale"/>
      <list-item v="Tasmanie"/>
      <list-item v="Nouvelle-Galles du Sud"/>
      <list-item v="Queensland"/>
<!--      <list-item v="Victoria"/> -->
      <list-item v="Nouvelle-Zélande"/>
      <list-item v="Timor"/>
      <list-item v="Timor oriental"/>
      <list-item v="Tuvalu"/>
      <list-item v="Vanuatu"/>
      <list-item v="Tonga"/>
      <list-item v="Kiribati"/>
      <list-item v="Papouasie"/>
      <list-item v="Papouasie-Nouvelle-Guinée"/>
      <list-item v="Nouvelle-Calédonie"/>
      <list-item v="Portugal"/>
      <list-item v="Espagne"/>
      <list-item v="Catalogne"/>
      <list-item v="Navarre"/>
      <list-item v="Biscaye"/>
      <list-item v="Guipuscoa"/>
      <list-item v="Castille"/>
      <list-item v="Aragon"/>
      <list-item v="Asturies"/>
      <list-item v="Galice"/>
      <list-item v="Pays Basque"/>
      <list-item v="Andalousie"/>
      <list-item v="Estrémadure"/>
      <list-item v="Andorre"/>
      <list-item v="France"/>
      <list-item v="Champagne"/>
      <list-item v="Bretagne"/>
      <list-item v="Finistère"/>
      <list-item v="Normandie"/>
      <list-item v="Roussillon"/>
      <list-item v="Occitanie"/>
      <list-item v="Gascogne"/>
      <list-item v="Guyenne"/>
      <list-item v="Béarn"/>
      <list-item v="Comminges"/>
      <list-item v="Aran"/>
      <list-item v="Aquitaine"/>
      <list-item v="Nouvelle-Aquitaine"/>
<!--      <list-item v="Gironde"/> -->
      <list-item v="Auvergne"/>
<!--      <list-item v="Limousin"/> -->
      <list-item v="Provence"/>
      <list-item v="Vaucluse"/>
      <list-item v="Savoie"/>
      <list-item v="Drôme"/>
      <list-item v="Allier"/>
      <list-item v="Ardèche"/>
<!--      <list-item v="Vivarais"/> -->
      <list-item v="Var"/>
      <list-item v="Saintonge"/>
      <list-item v="Poitou"/>
      <list-item v="Bourgogne"/>
      <list-item v="Berry"/>
<!--      <list-item v="Aisne"/> -->
      <list-item v="Picardie"/>
      <list-item v="Lorraine"/>
      <list-item v="Alsace"/>
      <list-item v="Corse"/>
      <list-item v="Grande-Bretagne"/>
      <list-item v="Angleterre"/>
      <list-item v="Yorkshire"/>
      <list-item v="Lancashire"/>
      <list-item v="Lincolnshire"/>
      <list-item v="Essex"/>
      <list-item v="Middlesex"/>
      <list-item v="Wessex"/>
      <list-item v="Sussex"/>
      <list-item v="Suffolk"/>
      <list-item v="Devon"/>
      <list-item v="Hampshire"/>
      <list-item v="Cornouaille"/>
      <list-item v="Cornouailles"/>
      <list-item v="Pays de Galles"/>
      <list-item v="Écosse"/>
      <list-item v="Irlande"/>
      <list-item v="Benelux"/>
      <list-item v="Belgique"/>
      <list-item v="Wallonie"/>
      <list-item v="Flandre"/>
      <list-item v="Luxembourg"/>
      <list-item v="Hollande"/>
      <list-item v="Frise"/>
      <list-item v="Allemagne"/>
      <list-item v="Germanie"/>
      <list-item v="Bade"/>
      <list-item v="pays de Bade"/>
      <list-item v="Bavière"/>
      <list-item v="Brandenbourg"/>
      <list-item v="Poméranie"/>
      <list-item v="Saxe"/>
      <list-item v="Saxe-Anhalt"/>
      <list-item v="Basse-Saxe"/>
      <list-item v="Franconie"/>
      <list-item v="Basse-Franconie"/>
      <list-item v="Haute-Franconie"/>
      <list-item v="Moyenne-Franconie"/>
      <list-item v="Souabe"/>
      <list-item v="Thuringe"/>
      <list-item v="Schleswig-Holstein"/>
      <list-item v="Schleswig"/>
      <list-item v="Holstein"/>
      <list-item v="Sorabie"/>
      <list-item v="Lusace"/>
      <list-item v="Haute-Lusace"/>
      <list-item v="Basse-Lusace"/>
      <list-item v="Prusse"/>
      <list-item v="Prusse-Orientale"/>
      <list-item v="Danemark"/>
      <list-item v="Jutland"/>
      <list-item v="Islande"/>
      <list-item v="Norvège"/>
      <list-item v="Suède"/>
      <list-item v="Finlande"/>
      <list-item v="Laponie"/>
      <list-item v="Prussie"/>
      <list-item v="Russie"/>
      <list-item v="Carélie"/>
      <list-item v="Tchétchénie"/>
      <list-item v="Ingouchie"/>
      <list-item v="Kabardino-Balkarie"/>
      <list-item v="Karatchaïévo-Tcherkessie"/>
      <list-item v="Adyguée"/>
      <list-item v="Ossétie"/>
      <list-item v="Ossétie du Nord"/>
      <list-item v="Ossétie du Nord-Alanie"/>
      <list-item v="Ossétie du Sud"/>
      <list-item v="Alanie"/>
      <list-item v="Tchouvachie"/>
      <list-item v="Tatarstan"/>
      <list-item v="Tatarie"/>
      <list-item v="Tartarie"/>
      <list-item v="Bashkortostan"/>
      <list-item v="Oudmourtie"/>
      <list-item v="Mordovie"/>
      <list-item v="Kalmoukie"/>
      <list-item v="Touva"/>
      <list-item v="Bouriatie"/>
      <list-item v="Iakoutie"/>
      <list-item v="Yakoutie"/>
      <list-item v="Kamtchatka"/>
      <list-item v="Kouban"/>
      <list-item v="Koubane"/>
      <list-item v="Estonie"/>
      <list-item v="Lettonie"/>
      <list-item v="Lituanie"/>
      <list-item v="Livonie"/>
      <list-item v="Pologne"/>
      <list-item v="Silésie"/>
      <list-item v="Mazovie"/>
      <list-item v="Mazurie"/>
      <list-item v="Podlachie"/>
      <list-item v="Volhynie"/>
      <list-item v="Volynie"/>
      <list-item v="Zaporoguie"/>
      <list-item v="Tchécoslovaquie"/>
      <list-item v="Tchéquie"/>
      <list-item v="Bohême"/>
      <list-item v="Moravie"/>
      <list-item v="Slovaquie"/>
      <list-item v="Hongrie"/>
      <list-item v="Autriche"/>
      <list-item v="Suisse"/>
      <list-item v="Valais"/>
      <list-item v="Tessin"/>
      <list-item v="Italie"/>
      <list-item v="Ligurie"/>
      <list-item v="Piémont"/>
      <list-item v="Lombardie"/>
      <list-item v="Émilie-Romagne"/>
      <list-item v="Émilie"/>
      <list-item v="Romagne"/>
      <list-item v="Toscane"/>
      <list-item v="Campanie"/>
      <list-item v="Calabre"/>
      <list-item v="Sardaigne"/>
      <list-item v="Sicile"/>
      <list-item v="Slovénie"/>
      <list-item v="Croatie"/>
      <list-item v="Serbie"/>
      <list-item v="Bosnie"/>
      <list-item v="Bosnie-Herzégovine"/>
      <list-item v="Herzégovine"/>
      <list-item v="Monténégro"/>
      <list-item v="Macédoine"/>
      <list-item v="Kosovo"/>
      <list-item v="Albanie"/>
      <list-item v="Roumanie"/>
      <list-item v="Valachie"/>
      <list-item v="Transylvanie"/>
      <list-item v="Moldavie"/>
      <list-item v="Bulgarie"/>
      <list-item v="Illyrie"/>
      <list-item v="Thrace"/>
      <list-item v="Dacie"/>
      <list-item v="Mésie"/>
      <list-item v="Moésie"/>
      <list-item v="Dobroudja"/>
      <list-item v="Dobrogée"/>
      <list-item v="Dalmatie"/>
      <list-item v="Grèce"/>
      <list-item v="Thessalie"/>
      <list-item v="Étolie"/>
      <list-item v="Épire"/>
      <list-item v="Béotie"/>
      <list-item v="Arcadie"/>
      <list-item v="Laconie"/>
      <list-item v="Messénie"/>
      <list-item v="Argolide"/>
      <list-item v="Achaïe"/>
      <list-item v="Attique"/>
      <list-item v="Élide"/>
      <list-item v="Ukraine"/>
      <list-item v="Crimée"/>
      <list-item v="Galicie"/>
      <list-item v="Podolie"/>
      <list-item v="Biélorussie"/>
      <list-item v="Transdnistrie"/>
      <list-item v="Turquie"/>
      <list-item v="Cappadoce"/>
      <list-item v="Cilicie"/>
      <list-item v="Bythinie"/>
      <list-item v="Mysie"/>
      <list-item v="Paphlagonie"/>
      <list-item v="Pamphylie"/>
      <list-item v="Pisidie"/>
      <list-item v="Galatie"/>
      <list-item v="Lydie"/>
      <list-item v="Lycie"/>
      <list-item v="Carie"/>
      <list-item v="Lycaonie"/>
      <list-item v="Éolide"/>
      <list-item v="Éolie"/>
      <list-item v="Syrie"/>
      <list-item v="Kurdistan"/>
      <list-item v="Arménie"/>
      <list-item v="Géorgie"/>
      <list-item v="Abkhazie"/>
      <list-item v="Colchide"/>
      <list-item v="Ibérie"/>
      <list-item v="Azerbaïdjan"/>
      <list-item v="Kazakhstan"/>
      <list-item v="Turkménistan"/>
      <list-item v="Ouzbékistan"/>
      <list-item v="Kirghizistan"/>
      <list-item v="Kirghizie"/>
      <list-item v="Tadjikistan"/>
      <list-item v="Iran"/>
      <list-item v="Mésopotamie"/>
      <list-item v="Perse"/>
      <list-item v="Assyrie"/>
      <list-item v="Élam"/>
      <list-item v="Iraq"/>
      <list-item v="Irak"/>
      <list-item v="Arabie"/>
      <list-item v="Arabie saoudite"/>
      <list-item v="Jordanie"/>
      <list-item v="Syrie"/>
<!--      <list-item v="Liban"/> -->
      <list-item v="Palestine"/>
      <list-item v="Néguev"/>
<!--      <list-item v="Yémen"/> -->
      <list-item v="Koweït"/>
      <list-item v="Qatar"/>
<!--      <list-item v="Émirats arabes unis"/> -->
      <list-item v="Afghanistan"/>
      <list-item v="Pakistan"/>
      <list-item v="Baloutchistan"/>
      <list-item v="Sind"/>
      <list-item v="Inde"/>
      <list-item v="Bengale"/>
      <list-item v="Gujarat"/>
      <list-item v="Maharashtra"/>
      <list-item v="Népal"/>
      <list-item v="Boutan"/>
      <list-item v="Tibet"/>
      <list-item v="Chine"/>
      <list-item v="Mongolie"/>
      <list-item v="Mandchourie"/>
      <list-item v="Hubei"/>
      <list-item v="Xinjiang"/>
      <list-item v="Corée"/>
      <list-item v="Corée du Nord"/>
      <list-item v="Corée du Sud"/>
      <!-- <list-item v="Japon"/> -->
      <list-item v="Viêtnam"/>
      <list-item v="Tonkin"/>
      <list-item v="Annam"/>
      <list-item v="Cochinchine"/>
      <list-item v="Cambodge"/>
      <list-item v="Birmanie"/>
      <list-item v="Myanmar"/>
      <list-item v="État Karen"/>
      <list-item v="Laos"/>
      <list-item v="Taïlande"/>
      <list-item v="Indonésie"/>
      <list-item v="Malaisie"/>
      <list-item v="Sarawak"/>
      <list-item v="Bornéo"/>
      <list-item v="Bangladesh"/>
      <list-item v="Sri-Lanka"/>
      <list-item v="Sri Lanka"/>
      <list-item v="Maroc"/>
      <list-item v="Numidie"/>
      <list-item v="Canaries"/>
      <list-item v="Mauritanie"/>
      <list-item v="Algérie"/>
      <list-item v="Tunisie"/>
      <list-item v="Libye"/>
      <list-item v="Égypte"/>
      <list-item v="Nubie"/>
      <list-item v="Burkina"/>
      <list-item v="Burkina Faso"/>
      <list-item v="Mali"/>
      <list-item v="Niger"/>
      <list-item v="Nigéria"/>
      <list-item v="Biafra"/>
      <list-item v="Tchad"/>
      <list-item v="Sénégal"/>
      <list-item v="Gambie"/>
      <list-item v="Sénégambie"/>
      <list-item v="Sierra Leone"/>
      <list-item v="Côte d'Ivoire"/>
      <list-item v="Ghana"/>
      <list-item v="Liberia"/>
      <list-item v="Togo"/>
      <list-item v="Guinée"/>
      <list-item v="Guinée-Bissau"/>
      <list-item v="Guinée équatoriale"/>
      <list-item v="Bénin"/>
<!--      <list-item v="Cameroun"/> -->
      <list-item v="Gabon"/>
      <list-item v="Éthiopie"/>
      <list-item v="Tigré"/>
      <list-item v="Érythrée"/>
      <list-item v="Somalie"/>
      <list-item v="Somaliland"/>
      <list-item v="Zaïre"/>
      <list-item v="Kivu"/>
      <list-item v="Katanga"/>
      <list-item v="Rwanda"/>
      <list-item v="Burundi"/>
      <list-item v="Ouganda"/>
      <list-item v="Kenya"/>
      <list-item v="Tanzanie"/>
      <list-item v="Tanganyika"/>
      <list-item v="Malawi"/>
      <list-item v="Lesotho"/>
      <list-item v="Botswana"/>
      <list-item v="Zimbabwe"/>
      <list-item v="Rhodésie"/>
      <list-item v="Namibie"/>
      <list-item v="Zambie"/>
      <list-item v="Swaziland"/>
      <list-item v="Eswatini"/>
      <list-item v="Angola"/>
      <list-item v="Mozambique"/>
      <list-item v="Groenland"/>
      <list-item v="Canada"/>
      <list-item v="Manitoba"/>
      <list-item v="Ontario"/>
      <list-item v="Québec"/>
      <list-item v="Nouveau-Brunswick"/>
      <list-item v="Saskatchewan"/>
      <list-item v="Nouvelle-Orléans"/>
      <list-item v="Alabama"/>
      <list-item v="Alaska"/>
      <list-item v="Arkansas"/>
      <list-item v="Arizona"/>
      <list-item v="Californie"/>
      <list-item v="Connecticut"/>
      <list-item v="Delaware"/>
      <list-item v="Floride"/>
      <list-item v="Idaho"/>
      <list-item v="Illinois"/>
      <list-item v="Iowa"/>
      <list-item v="Kansas"/>
      <list-item v="Kentucky"/>
      <list-item v="Louisiane"/>
      <list-item v="Maine"/>
      <list-item v="Maryland"/>
      <list-item v="Massachusetts"/>
      <list-item v="Michigan"/>
      <list-item v="Minnesota"/>
      <list-item v="Montana"/>
      <list-item v="New Hampshire"/>
      <list-item v="New Jersey"/>
      <list-item v="Nebraska"/>
      <list-item v="Nevada"/>
      <list-item v="Montana"/>
      <list-item v="Oklahoma"/>
      <list-item v="Ohio"/>
      <list-item v="Oregon"/>
      <list-item v="Pennsylvanie"/>
      <list-item v="Tennessee"/>
      <list-item v="Texas"/>
      <list-item v="Utah"/>
      <list-item v="Vermont"/>
      <list-item v="Virginie"/>
      <list-item v="Virginie-Occidentale"/>
      <list-item v="Wisconsin"/>
      <list-item v="Mexique"/>
      <list-item v="Jamaïque"/>
      <list-item v="Mexique"/>
      <list-item v="Belize"/>
      <list-item v="Guatemala"/>
      <list-item v="Honduras"/>
      <list-item v="Nicaragua"/>
      <list-item v="Costa Rica"/>
      <list-item v="Panama"/>
      <list-item v="Barbade"/>
      <list-item v="Colombie"/>
      <list-item v="Vénézuéla"/>
      <list-item v="Venezuela"/>
      <list-item v="Guadeloupe"/>
      <list-item v="Réunion"/>
      <list-item v="Martinique"/>
      <list-item v="Surinam"/>
      <list-item v="Guyana"/>
      <list-item v="Brésil"/>
      <list-item v="Équateur"/>
      <list-item v="Pérou"/>
      <list-item v="Nouvelle-Castille"/>
      <list-item v="Chili"/>
      <list-item v="Argentine"/>
      <list-item v="Bolivie"/>
      <list-item v="Paraguay"/>
      <list-item v="Uruguay"/>
    </def-list>

    <def-list n="pp_estat">
      <list-item v="marier"/>
      <list-item v="divorcer"/>
      <list-item v="mourir"/>
    </def-list>

    <def-list n="pr_de">
      <list-item v="de"/>
      <list-item v="à côté de"/>
      <list-item v="afin de"/>
      <list-item v="à cause de"/>
      <list-item v="à condition de"/>
      <list-item v="à côté de"/>
      <list-item v="à l'époque de"/>
      <list-item v="à l'encontre de"/>
      <list-item v="à l'envers de"/>
      <list-item v="à l'époque de"/>
      <list-item v="à l'exception de"/>
      <list-item v="à l'initiative de"/>
      <list-item v="à l'instar de"/>
      <list-item v="à l'insu de"/>
      <list-item v="à l'issue de"/>
      <list-item v="à l'occasion de"/>
      <list-item v="à l'égard de"/>
      <list-item v="à la demande de"/>
      <list-item v="à la différence de"/>
      <list-item v="à la fin de"/>
      <list-item v="à la requête de"/>
      <list-item v="à la veille de"/>
      <list-item v="à moins de"/>
      <list-item v="à propos de"/>
      <list-item v="à partir de"/>
      <list-item v="à proximité de"/>
      <list-item v="afin de"/>
      <list-item v="au bénéfice de"/>
      <list-item v="au bout de"/>
      <list-item v="au cours de"/>
      <list-item v="au début de"/>
      <list-item v="au delà de"/>
      <list-item v="au désavantage de"/>
      <list-item v="au dire de"/>
      <list-item v="au gré de"/>
      <list-item v="au lieu de"/>
      <list-item v="au milieu de"/>
      <list-item v="au moyen de"/>
      <list-item v="au profit de"/>
      <list-item v="au prétexte de"/>
      <list-item v="au sujet de"/>
      <list-item v="au vu de"/>
      <list-item v="au-dedans de"/>
      <list-item v="au-dehors de"/>
      <list-item v="au-delà de"/>
      <list-item v="au-derrière de"/>
      <list-item v="au-dessous de"/>
      <list-item v="au-dessus de"/>
      <list-item v="au-devant de"/>
      <list-item v="autour de"/>
      <list-item v="aux bons soins de"/>
      <list-item v="aux dépends de"/>
      <list-item v="avant de"/>
      <list-item v="compte tenu de"/>
      <list-item v="dans bien de"/>
      <list-item v="dans l'espoir de"/>
      <list-item v="dans la foulée de"/>
      <list-item v="dans le cadre de"/>
      <list-item v="dans le cas de"/>
      <list-item v="dans le dos de"/>
      <list-item v="de la part de"/>
      <list-item v="depuis la fin de"/>
      <list-item v="depuis le début de"/>
      <list-item v="derrière de"/>
      <list-item v="devant de"/>
      <list-item v="du vivant de"/>
      <list-item v="en cas de"/>
      <list-item v="en dehors de"/>
      <list-item v="en échange de"/>
      <list-item v="en faveur de"/>
      <list-item v="en guise de"/>
      <list-item v="en marge de"/>
      <list-item v="en période de"/>
      <list-item v="en plus de"/>
      <list-item v="en raison de"/>
      <list-item v="en période de"/>
      <list-item v="en temps de"/>
      <list-item v="en tête de"/>
      <list-item v="eu égard de"/>
      <list-item v="jusqu'à la moitié de"/>
      <list-item v="jusqu'à la fin de"/>
      <list-item v="jusqu'en fin de"/>
      <list-item v="le long de"/>
      <list-item v="lors de"/>
      <list-item v="par l'intermédiaire de"/>
      <list-item v="près de"/>
      <list-item v="pour ce qui est de"/>
      <list-item v="proche de"/>
      <list-item v="sur la rêquete de"/>
      <list-item v="sur le point de"/>
      <list-item v="un peu de"/>
      <list-item v="un peu moins de"/>
      <list-item v="un peu plus de"/>
      <list-item v="un peu trop de"/>
      <list-item v="un peu trop peu de"/>
      <list-item v="vers la moitié de"/>
      <list-item v="vis-à-vis de"/>
    </def-list>


    <def-list n="part_sing">
      <list-item v="argent"/>
      <list-item v="eau"/>
      <list-item v="beurre"/>
      <list-item v="limonade"/>
      <list-item v="vin"/>
      <list-item v="bière"/>
      <list-item v="viande"/>
      <list-item v="pain"/>
      <list-item v="essence"/>
      <list-item v="soupe"/>
    </def-list>

  </section-def-lists>

  <section-def-macros>
    <def-macro n="f_pis2prs" npar="1"> <!-- canviem tots els pis per prs -->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="pis"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="temps"/>
            <lit-tag v="prs"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_setpronom" npar="1">
<!--
      <choose>
        <when>
          <test>
            <equal>
              <case-of pos="1" side="sl" part="lem"/>
              <lit v="Aa"/>
            </equal>
          </test>
          <modify-case>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="aa"/>
          </modify-case>
        </when>
      </choose>
-->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="persona"/>
              <lit-tag v="p1"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="je"/>
              </let>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="pl"/>
                    </equal>
                  </test>
                  <let>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="nous"/>
                  </let>
                </when>
              </choose>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="persona"/>
                  <lit-tag v="p2"/>
                </equal>
              </test>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="sg"/>
                    </equal>
                  </test>
                  <let>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="tu"/>
                  </let>
                </when>
                <otherwise>
                  <choose>
                    <when>
                      <test>
                        <equal>
                          <clip pos="1" side="tl" part="nbr"/>
                          <lit-tag v="pl"/>
                        </equal>
                      </test>
                      <let>
                        <clip pos="1" side="sl" part="lem"/>
                        <lit v="vous"/>
                      </let>
                    </when>
                  </choose>
                </otherwise>
              </choose>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="persona"/>
                      <lit-tag v="p3"/>
                    </equal>
                  </test>
                  <let>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="il"/>
                  </let>
                </when>
              </choose>
            </otherwise>
          </choose>
        </otherwise>
      </choose>

      <modify-case>
        <clip pos="1" side="sl" part="lem"/>
        <case-of pos="1" side="tl" part="lem"/>
      </modify-case>
      <let><var n="inici"/><lit-tag v="no"/></let>
    </def-macro>

    <def-macro n="f_seton" npar="2"> <!-- es comencen > on comence (canviem el nombre del verb si hi ha canvi es > on) -->
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_setgen" npar="1">
      <choose>
        <when>
          <test>
            <or>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
              <and>
                <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
              </and>
            </or>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="sl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="gen"/>
                      <lit-tag v="f"/>
                    </equal>
                  </test>
                  <let>
                    <clip pos="1" side="sl" part="gen"/>
                    <lit-tag v="f"/>
                  </let>
                </when>
                <otherwise>
                  <choose>
                    <when>
                      <test>
                        <equal>
                          <clip pos="1" side="tl" part="gen"/>
                          <lit-tag v="mf"/>
                        </equal>
                      </test>
                      <let>
                        <clip pos="1" side="sl" part="gen"/>
                        <lit-tag v="m"/>
                      </let>
                    </when>
                  </choose>
                </otherwise>
              </choose>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <or>
                  <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                  <and>
                    <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                    <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
                  </and>
                </or>
              </test>
              <let>
                <clip pos="1" side="sl" part="gen"/>
                <lit-tag v="mf"/>
              </let>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </test>
                  <let>
                    <clip pos="1" side="sl" part="nbr"/>
                    <lit-tag v="sg"/>
                  </let>
                </when>
              </choose>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_bcond" npar="2">
<!--Per mirar si el blanc conté o no format -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>

    <def-macro n="superlatiu" npar="1">
<!--Per modificar el superlatiu per très + adj -->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="a_sup"/>
              <lit-tag v="sup"/>
            </equal>
          </test>
          <out>
            <lu>
              <lit v="très"/>
              <lit-tag v="preadv"/>
            </lu>
            <b/>
          </out>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_modimp" npar="1">
<!--Per canviar la 3a persona d'imperatiu per 2a del plural -->
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="persona"/><lit-tag v="p2"/></let>
          <choose>
            <when>
              <test>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
              </test>
              <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
            </when>
          </choose>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_modimp2" npar="2">
<!--Per canviar la 3a persona d'imperatiu per 2a del plural + el pronom reflexiu -->
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="persona"/><lit-tag v="p2"/></let>
          <choose>
            <when>
              <test>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
              </test>
              <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <equal><clip pos="2" side="sl" part="a_prnenc"/><lit-tag v="prn.enc.ref"/></equal>
              </test>
              <let><clip pos="2" side="tl" part="lem"/><lit v="vous"/></let>
              <let><clip pos="2" side="tl" part="persona"/><lit-tag v="p2"/></let>
              <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
              <let><clip pos="2" side="tl" part="a_prnenc"/><lit-tag v="prn.enc"/></let>
            </when>
          </choose>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_espai_prepadv" npar="1"> <!-- canviem els adv per prep -->
      <let><clip pos="1" side="tl" part="a_adv"/><lit-tag v="pr"/></let>
      <choose>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="darrere"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="derrière"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="rere"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="derrière"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="davant"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="devant"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="sobre"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="sur"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="sota"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="sous"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="al davant"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="devant"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="al darrere"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="derrière"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="al damunt"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="au-dessus de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a sobre"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="au-dessus de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a sota"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="au-dessous de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="prop"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="près de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a prop"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="près de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a la vora"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="près de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="al voltant"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="autour de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a l'entorn"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="autour de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a dins"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="dans"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a fora"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="hors de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a l'interior"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="a l'intérieur de"/></let>
        </when>
        <when>
          <test>
            <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="a l'exterior"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="a l'extérieur de"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord_pedac" npar="1">
<!--Pedaç totalment ad-hoc per solucionar problemes amb el canvi de pl a sg en els articles des/les
  (no s'expandeix el gènere perquè no es fa si està previst posar mf) -->
      <choose>
        <when>
          <test>
            <or>
              <and>
                <equal><clip pos="1" side="tl" part="lem"/><lit v="le"/></equal>
                <equal><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></equal>
                <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
              </and>
              <and>
                <equal><clip pos="1" side="tl" part="lem"/><lit v="un"/></equal>
                <equal><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.ind"/></equal>
                <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
              </and>
            </or>
          </test>
          <let><clip pos="1" side="tl" part="gen"/><var n="genero"/></let>
        </when>
      </choose>

<!--Pedaç totalment ad-hoc per solucionar problemes amb l'assignació del gènere i nombre a heureux, feliç > joyeux -->
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="joyeux"/></equal>
              <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></equal>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord1" npar="1">
      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <let><var n="inici"/><lit-tag v="no"/></let>
    </def-macro>

    <def-macro n="f_concord2" npar="2">
      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
<!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
            <equal>
              <clip pos="2" side="tl" part="a_num"/>
              <lit-tag v="num"/>
            </equal>
            <not>
            <equal>
              <clip pos="2" side="tl" part="lem"/>
              <lit v="1"/>
            </equal>
            </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>

        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
      <let><var n="inici"/><lit-tag v="no"/></let>
    </def-macro>

    <def-macro n="f_concord3" npar="3">
      <choose>
<!-- Look if in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look if in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="3"/></call-macro>
      <let><var n="inici"/><lit-tag v="no"/></let>
    </def-macro>

    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <call-macro n="f_concord_pedac"><with-param pos="1"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="2"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="3"/></call-macro>
      <call-macro n="f_concord_pedac"><with-param pos="4"/></call-macro>
      <let><var n="inici"/><lit-tag v="no"/></let>
    </def-macro>

    <def-macro n="f_lexicAdj" npar="1">
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="bo"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="bon"/>
            </get-case-from>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_lang_dial1" npar="1">
<!-- mirem si que és a la llista de llengües, però segur que no es tracta d'una llengua; en aquest cas posem majúscula (aquí es mira si hi ha plural) -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              <in caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <list n="lang_dial"/>
              </in>
            </and>
          </test>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="Aa"/>
          </modify-case>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_lang_dial0" npar="1">
<!-- mirem si que és a la llista de llengües, en aquest cas posem majúscula (aquí no es mira si hi ha plural) -->
      <choose>
        <when>
          <test>
            <in caseless="yes">
              <clip pos="1" side="tl" part="lem"/>
              <list n="lang_dial"/>
            </in>
          </test>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="Aa"/>
          </modify-case>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_lang_dial2" npar="2">
<!-- mirem si (segur) que no es tracta de la llengua, en aquest cas posem majúscula -->
<!-- p1 = det, p2 = n -->
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
                <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
                <equal><clip pos="1" side="sl" part="lem"/><lit v="un"/></equal>
              </or>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <list n="lang_dial"/>
              </in>
            </and>
          </test>
          <modify-case>
            <clip pos="2" side="tl" part="lemh"/>
            <lit v="Aa"/>
          </modify-case>
        </when>
      </choose>
    </def-macro>

<def-macro n="f_vaux_pp2" npar="2">
   <choose> <!-- vaux + vlex: es canvia el vaux a être o avoir -->
     <when>
       <test>
         <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><lit v="être"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <!-- el nombre del participi, l'agafem de l'auxiliar, si aquest en té (no és infinitiu o gerundi) -->
       <choose>
         <when>
           <test>
           <or>
             <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
             <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
           </or>
           </test>
           <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
         </when>
         <otherwise>
           <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
         </otherwise>
       </choose>
       <!-- el gènere, l'agafem de la variable "genero", però només en 3a persona i si genero no es mf -->
       <choose>
         <when>
           <test>
           <and>
           <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p3"/></equal>
           <or>
             <equal><var n="genero"/><lit-tag v="m"/></equal>
             <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
           </test>
           <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
           <let><var n="genero_tmp"/><var n="genero"/></let>
         </when>
         <otherwise>
           <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
	   <let><var n="genero_tmp"/><lit-tag v="m"/></let>
         </otherwise>
       </choose>
       <let><var n="numero_tmp"/><clip pos="1" side="tl" part="nbr"/></let>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><lit v="avoir"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
       <let><var n="genero_tmp"/><lit-tag v="m"/></let>
       <let><var n="numero_tmp"/><lit-tag v="sg"/></let>
     </otherwise>
   </choose>

      <modify-case>
        <clip pos="1" side="tl" part="lem"/>
        <case-of pos="1" side="sl" part="lem"/>
      </modify-case>
</def-macro>

<def-macro n="f_vaux_pp3" npar="3">
   <choose> <!-- vaux + vlex: es canvia el vaux a être o avoir, el tercer element és un adjectiu que serveix per obtenir el gènere del pp si être -->
     <when>
       <test>
         <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><lit v="être"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
       <!-- el gènere, l'agafem en primer lloc del tercer membre (adj) o altrament de la variable "genero", però només en 3a persona i si genero no es mf -->
       <choose>
         <when>
           <test>
           <or>
               <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></equal>
               <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="f"/></equal>
             </or>
           </test>
           <let><clip pos="2" side="tl" part="gen"/><clip pos="3" side="tl" part="gen"/></let>
         </when>
         <otherwise>
           <choose>
             <when>
               <test>
               <and>
               <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p3"/></equal>
               <or>
                   <equal><var n="genero"/><lit-tag v="m"/></equal>
                   <equal><var n="genero"/><lit-tag v="f"/></equal>
                 </or>
               </and>
               </test>
               <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
             </when>
             <otherwise>
               <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
             </otherwise>
           </choose>
         </otherwise>
       </choose>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><lit v="avoir"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
     </otherwise>
   </choose>
</def-macro>

<def-macro n="f_vaux_pp2_enc" npar="3">
   <choose> <!-- vaux + vlex + enc: es canvia el vaux a être o avoir, el tercer element és un enclític que convé per saber si tenim un verb pronominal -->
     <when>
       <test>
         <or>
           <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
           <and>
             <not><equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
             <equal><clip pos="1" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
           </and>
           <and>
             <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             <equal><clip pos="1" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
             <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
           </and>
         </or>
       </test>
       <let><clip pos="1" side="tl" part="lem"/><lit v="être"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
       <!-- el nombre del participi, l'agafem de l'auxiliar, si aquest en té (no és infinitiu o gerundi) -->
       <choose>
         <when>
           <test>
           <or>
             <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
             <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
           </or>
           </test>
           <let><clip pos="2" side="tl" part="nbr"/><clip pos="1" side="tl" part="nbr"/></let>
         </when>
         <otherwise>
           <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
         </otherwise>
       </choose>
       <!-- el gènere, l'agafem de la variable "genero", però només en 3a persona i si genero no es mf -->
       <choose>
         <when>
           <test>
           <and>
           <equal><clip pos="1" side="tl" part="persona"/><lit-tag v="p3"/></equal>
           <or>
             <equal><var n="genero"/><lit-tag v="m"/></equal>
             <equal><var n="genero"/><lit-tag v="f"/></equal>
             </or>
           </and>
           </test>
           <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
           <let><var n="genero_tmp"/><var n="genero"/></let>
         </when>
         <otherwise>
           <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
	   <let><var n="genero_tmp"/><lit-tag v="m"/></let>
         </otherwise>
       </choose>
       <let><var n="numero_tmp"/><clip pos="1" side="tl" part="nbr"/></let>
     </when>
     <otherwise>
       <let><clip pos="1" side="tl" part="lem"/><lit v="avoir"/></let>
       <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
       <let><var n="genero_tmp"/><lit-tag v="m"/></let>
       <let><var n="numero_tmp"/><lit-tag v="sg"/></let>
     </otherwise>
   </choose>

      <modify-case>
        <clip pos="1" side="tl" part="lem"/>
        <case-of pos="1" side="sl" part="lem"/>
      </modify-case>
</def-macro>

<def-macro n="print_enc_enc_2_pro_pro" npar="2">
     <choose>
       <when>
         <test>
           <or>
             <and>
               <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="li"/></equal>
               <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="el"/></equal>
             </and>
             <and>
               <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="li"/></equal>
               <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="ho"/></equal>
             </and>
           </or>
         </test>
         <out>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="2" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="1" side="tl" part="tipoenc_pro"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="1" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="2" side="tl" part="tipoenc_pro"/>
           </lu>
         </out>
       </otherwise>
     </choose>
</def-macro>

<def-macro n="f_calen_ilfaut1" npar="1">
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="falloir"/></equal>
             <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
           </and>
         </test>
         <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
       </when>
     </choose>
</def-macro>

<def-macro n="f_calen_ilfaut2" npar="2"> <!-- per a temps compostos: p1 = auxiliar, p2 = verb -->
     <choose>
       <when>
         <test>
           <and>
             <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="falloir"/></equal>
             <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
           </and>
         </test>
         <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
       </when>
     </choose>
</def-macro>

<def-macro n="f_uns_num" npar="1">
     <choose>
       <when>
         <test>
           <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="un"/></equal>
         </test>
         <let><clip pos="1" side="tl" part="lem"/><get-case-from pos="1"><lit v="près de"/></get-case-from></let>
         <let><clip pos="1" side="tl" part="tags"/><lit-tag v="pr"/></let>
       </when>
     </choose>
</def-macro>
  </section-def-macros>

  <section-rules>
<!--regles de concordança-->
    <rule>
<!-- REGLA: DET -->
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <let><var n="inici"/><lit-tag v="no"/></let>
      </action>
  </rule>

    <rule comment="REGLA: LOPRONOM">
      <pattern>
        <pattern-item n="lopronom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <let><var n="inici"/><lit-tag v="no"/></let>
      </action>
  </rule>


    <rule comment="REGLA: NOM">
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: NP: Joan > Joan, Espanya > l'Espagne">
      <pattern>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in>
                <clip pos="1" side="tl" part="lem"/>
                <list n="pais"/>
              </in>
            </test>
            <out>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <var n="genero"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: ca detdefsg npant (cal Joan > chez Joan)">
      <pattern>
        <pattern-item n="ca"/>
        <pattern-item n="detdefsg"/>
        <pattern-item n="npant"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: det NP">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: det TOP ADJ: els Urals meridionals > l'Oural méridional">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="nptop"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: a NP (evita la generació de l'article si país f.sg)">
      <pattern>
        <pattern-item n="a"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <in><clip pos="2" side="tl" part="lem"/><list n="pais"/></in>
                  <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                </and>
                <!-- + pays m.sg qui commencen en voyelle -->
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Annam"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Alabama"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Alaska"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Arkansas"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Aragon"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Arizona"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Azerbaïdjan"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Équateur"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Essex"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Hampshire"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Honduras"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Hubei"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Idaho"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Illinois"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iowa"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iran"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Irak"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iraq"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Oklahoma"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ohio"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ontario"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Oregon"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ouganda"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ouzbékistan"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Uruguay"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Wisconsin"/></equal>
              </or>
            </test>
            <let><clip pos="1" side="tl" part="lem"/><get-case-from pos="1"><lit v="en"/></get-case-from></let> <!-- en Égypte -->
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <not><in><clip pos="2" side="tl" part="lem"/><list n="pais"/></in></not>
                <and>
                  <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                </and>
                <!-- + pays m.sg qui commencen en voyelle -->
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Annam"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Alabama"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Alaska"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Arkansas"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Aragon"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Arizona"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Azerbaïdjan"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Équateur"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Essex"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Hampshire"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Honduras"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Hubei"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Idaho"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Illinois"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iowa"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iran"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Irak"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Iraq"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Oklahoma"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ohio"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ontario"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Oregon"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ouganda"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Ouzbékistan"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Uruguay"/></equal>
                <equal><clip pos="2" side="tl" part="lem"/><lit v="Wisconsin"/></equal>
              </or>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <var n="genero"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: de NP (evita la generació de l'article si país f.sg)">
      <pattern>
        <pattern-item n="deprep"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
<!--
        <choose>
          <when>
            <test>
              <or>
                <not><in><clip pos="2" side="tl" part="lem"/><list n="pais"/></in></not>
                <and>
                  <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
                  <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                </and>
              </or>
            </test>
-->
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
<!--
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <var n="genero"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
-->
      </action>
    </rule>

    <rule comment="REGLA: ANT de TOP (evita la generació de l'article)">
      <pattern>
        <pattern-item n="np_unk"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: lpar NP rpar (evita la generació de l'article)">
      <pattern>
        <pattern-item n="lpar"/>
        <pattern-item n="nptop"/>
        <pattern-item n="rpar"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: per NPtop ">
      <pattern>
        <pattern-item n="per"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <in><clip pos="2" side="tl" part="lem"/><list n="pais"/></in>
            </test>
            <out>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <var n="genero"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: sent NP">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <let>
         <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in>
                <clip pos="2" side="tl" part="lem"/>
                <list n="pais"/>
              </in>
            </test>
            <out>
              <lu>
                <lit v="Le"/>
                <lit-tag v="det.def"/>
                <var n="genero"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: adj NP: antic Egipte > ancienne Égypte">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: det adj NP: l'antic Egipte > l'ancienne Égypte">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adj"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NP num_romans: Pere I > Pierre Ier, Pere II > Pierre II">
      <pattern>
        <pattern-item n="np_unk"/>
        <pattern-item n="num_romans"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v="Ier"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="tags"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <lit-tag v="num"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: ANT num_romans de TOP (evita la generació de l'article)">
      <pattern>
        <pattern-item n="np_unk"/>
        <pattern-item n="num_romans"/>
        <pattern-item n="deprep"/>
        <pattern-item n="nptop"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v="Ier"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="tags"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <lit-tag v="num"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: ADJ">
      <pattern>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="superlatiu">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PRONOM">
<!--Special case, macro f_concord1
is not applicable because gender and number can not be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <equal><clip pos="1" side="tl" part="a_prn"/><lit-tag v="prn.tn"/></equal>
                <equal><clip pos="1" side="tl" part="a_prn"/><lit-tag v="prn.tn.p3"/></equal>
              </or>
            </test>
            <let><var n="genero"/><clip pos="1" side="tl" part="gen"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_prn"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
        <let><var n="inici"/><lit-tag v="no"/></let>
      </action>
  </rule>

    <rule comment="REGLA: PRONPRO">
      <pattern>
        <pattern-item n="prnpro"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
        </out>
        <let><var n="inici"/><lit-tag v="no"/></let>
      </action>
  </rule>

  <rule comment="REGLA: NUM">
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: a les NUM (a les deu > a dix heures)">
      <pattern>
        <pattern-item n="a"/>
        <pattern-item n="lesdetdef"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="heure"/>
            </get-case-from>
            <lit-tag v="n.f.pl"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: a les NUM NOM (a les deu nenes > aux dix filles -- per evitar que la regla de les hores salti quan no cal)">
      <pattern>
        <pattern-item n="a"/>
        <pattern-item n="lesdetdef"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: a les NUM NUM (a les deu mil > aux dix mille -- per evitar que la regla de les hores salti quan no cal)">
      <pattern>
        <pattern-item n="a"/>
        <pattern-item n="lesdetdef"/>
        <pattern-item n="num"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="REGLA: RELAT">
      <pattern>
        <pattern-item n="relat"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PREP RELAT">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="elqual"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: el que > ce que ">
      <pattern>
        <pattern-item n="eldetmsg"/>
        <pattern-item n="que_rel"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="ce"/>
            </get-case-from>
            <lit-tag v="prn.tn.nt"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: det nom npant_unk: l'anglais Smith > l'Anglais Smith">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="npant_unk"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: det nom npant_unk num_romans: el rei Pere II > le roi Pierre II">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="npant_unk"/>
        <pattern-item n="num_romans"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="tl" part="lem"/>
                <lit v="Ier"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="tags"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="num"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <or>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="segle"/></equal>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="mil·leni"/></equal>
                </or>
                <equal><clip pos="2" side="sl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </and>
            </test>
            <call-macro n="superlatiu">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: ADJ NOM">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lexicAdj">
          <with-param pos="1"/>
        </call-macro>
       <call-macro n="superlatiu">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <or>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="segle"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="mil·leni"/></equal>
                </or>
                <equal><clip pos="3" side="sl" part="gen"/><lit-tag v="mf"/></equal>
                <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: DET segle num cnjcoo num: els segles I i II > les Ier et IIe siècles">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="segle"/>
        <pattern-item n="num_romans"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num_romans"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_concord2"> <!-- repeteixo per a la regla següent -->
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: segle num cnjcoo num: segles I i II > Ier et IIe siècles">
      <pattern>
        <pattern-item n="segle"/>
        <pattern-item n="num_romans"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num_romans"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1"> <!-- repeteixo per a la regla següent -->
          <with-param pos="1"/>
        </call-macro>
        <modify-case>
          <clip pos="1" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PREP segle num: des de mitjan segle I > depuis le début du Ier siècle">
      <pattern>
        <pattern-item n="des_de_mitjan"/>
        <pattern-item n="segle"/>
        <pattern-item n="num_romans"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1"> <!-- repeteixo per a la regla següent -->
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <clip pos="2" side="tl" part="gen"/>
            <var n="numero"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NOM ADJ ADJ-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: DET ADJ NOM-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lexicAdj">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: PREDET DET NOM-->
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: PREDET DET NOM ADJ-->
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: DET ADJ-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: ADJ NOM ADJ-->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lexicAdj">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="superlatiu">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: DET ADJ NOM ADJ -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lexicAdj">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NOM ADV ADJ-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: anar inf + enc + enc: va donar-te-la, te les a données">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="el"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <clip pos="4" side="sl" part="gen"/>
                <clip pos="4" side="sl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que anar inf + enc + enc: , va donar-te-la, il te les a données">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="sl" part="lem"/>
            <lit-tag v="prn.tn"/>
            <clip pos="2" side="sl" part="persona"/>
            <lit-tag v="m"/>
            <clip pos="2" side="sl" part="nbr"/>
          </lu>
          <b/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="el"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <clip pos="5" side="sl" part="gen"/>
                <clip pos="5" side="sl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="DET NOM ADV ADJ: l'home molt alt > l'homme très haut, l'home més alt > l'homme le plus haut">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="el"/></equal>
                <or>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="més"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="menys"/></equal>
                </or>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="1" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule>
<!-- REGLA: DET ADV NOM-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NUM NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NUM ADJ -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NUM NOM ADJ -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!-- REGLA: NUM ADJ NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lexicAdj">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="superlatiu">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NUM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_uns_num">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NUM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_uns_num">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_lang_dial0">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

<!--fi regles de concordança-->

<!-- dates -->

    <rule comment="REGLA: NUM de MES de NUM, 20 de novembre de 1998: 20 novembre 1998">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="deprep"/>
        <pattern-item n="mes"/>
        <pattern-item n="deprep"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <choose>
          <when>
            <test>
      <equal>
              <clip pos="1" side="sl" part="lem"/>
        <lit v="1"/>
      </equal>
            </test>
            <out>
              <lu>
                <lit v="1er"/>
                <lit-tag v="adj.m.sg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: NUM de MES, 20 de novembre: 20 novembre">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="deprep"/>
        <pattern-item n="mes"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
      <equal>
              <clip pos="1" side="sl" part="lem"/>
        <lit v="1"/>
      </equal>
            </test>
            <out>
              <lu>
                <lit v="1er"/>
                <lit-tag v="adj.m.sg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM de MES de NUM, el 20 de novembre de 1998: le 20 novembre 1998">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="deprep"/>
        <pattern-item n="mes"/>
        <pattern-item n="deprep"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="lem"/><lit v="1"/></equal>
            </test>
            <out>
              <lu>
                <lit v="1er"/>
                <lit-tag v="adj.m.sg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="6" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NUM de MES del NUM, el 20 de novembre del 1998: le 20 novembre 1998">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="deprep"/>
        <pattern-item n="mes"/>
        <pattern-item n="deprep"/>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="7"/>
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="lem"/><lit v="1"/></equal>
            </test>
            <out>
              <lu>
                <lit v="1er"/>
                <lit-tag v="adj.m.sg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="7" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: DET NUM de MES, el 20 de novembre: le 20 novembre">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="deprep"/>
        <pattern-item n="mes"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="lem"/><lit v="1"/></equal>
            </test>
            <out>
              <lu>
                <lit v="1er"/>
                <lit-tag v="adj.m.sg"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

<!-- fi dates -->

    <rule comment="REGLA: a principis de gener > début janvier">
      <pattern>
        <pattern-item n="principi_prep"/>
        <pattern-item n="mes"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="début"/>
            </get-case-from>
            <lit-tag v="n.m.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: a finals de gener > fin janvier">
      <pattern>
        <pattern-item n="fi_prep"/>
        <pattern-item n="mes"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="fin"/>
            </get-case-from>
            <lit-tag v="n.f.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: fins al gener > jusqu'en janvier">
      <pattern>
        <pattern-item n="finsprep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="mes"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: de la senyora X > de madame X">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="n_senyor"/>
        <pattern-item n="npant_unk"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>


    <rule comment="REGLA: DETDEF DE: el de l'esquerra: celui de la gauche">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="celui"/>
            </get-case-from>
            <lit-tag v="prn.tn"/>
            <clip pos="1" side="sl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: MOLTdet DE: molt de soroll: beaucoup de bruit">
      <pattern>
        <pattern-item n="moltdet"/>
        <pattern-item n="deprep"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="beaucoup"/>
            </get-case-from>
            <lit-tag v="prn.tn.mf.pl"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>

<!-- REGLES VERBS QUE SÓN PRONOMINALS EN CATALÀ PERÒ NO EN FRANCÈS -->

    <rule comment="PRNPROREF VERBPRON > VERBNOPRON: es mou > bouge">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
      </pattern>
      <action>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNPROREF HAVER PPPRON > HAVER/SER PPNOPRON: s'ha mogut > a bougé">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="verbospron_pp"/>
      </pattern>
      <action>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="2" side="tl" part="lem"/><get-case-from pos="2"><lit v="être"/></get-case-from></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNPROREF ANAR INFPRON > HAVER/SER INFNOPRON: es va moure > a bougé">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="ANAR INFPRON PRNENC > HAVER/SER INFNOPRON: va moure's > a bougé, va moure-hi, y a remué">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="3" side="tl" part="lemh"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="3" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNPROREF VBMOD INFPRON > VBMOD INFNOPRON: es pot moure > peut bouger">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="VBMOD INFPRON PRNENC > VBMOD INFNOPRON: pot moure's > peut bouger, pot moure-hi, y peut remuer">
      <pattern>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="3" side="tl" part="lemh"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="3" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
            <let>
                <clip pos="2" side="tl" part="lemh"/>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
            </let>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

<!-- xxxxx Ara amb negació -->
    <rule comment="NO PRNPROREF VERBPRON > NE VERBNOPRON PAS: no es mou > ne bouge pas">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNPROREF HAVER PPPRON > NE HAVER/SER PAS PPNOPRON: ne s'ha mogut > n'a pas bougé">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="verbospron_pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><get-case-from pos="3"><lit v="être"/></get-case-from></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNPROREF ANAR INFPRON > NE HAVER/SER PAS INFNOPRON: no es va moure > n'a pas bougé">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO ANAR INFPRON PRNENC > NE HAVER/SER PAS INFNOPRON: no va moure's > n'a pas bougé, va moure-hi, n'y a pas remué">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNPROREF VBMOD INFPRON > NE VBMOD INFNOPRON: no es pot moure > ne peut pas bouger">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO VBMOD INFPRON PRNENC > NE VBMOD PAS INFNOPRON: no pot moure's > ne peut pas bouger, no pot moure-hi, n'y peut pas remuer">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

<!-- xxxxx Ara amb generació de pronoms subjecte -->
    <rule comment="SENT PRNPROREF VERBPRON > SENT PRNSUBJ VERBNOPRON: es mou > il bouge">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT PRNPROREF HAVER PPPRON > SENT PRNSUBJ HAVER/SER PPNOPRON: s'ha mogut > il a bougé">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="verbospron_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><get-case-from pos="3"><lit v="être"/></get-case-from></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT PRNPROREF ANAR INFPRON > SENT PRNSUBJ HAVER/SER INFNOPRON: es va moure > il a bougé">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT ANAR INFPRON PRNENC > SENT PRNSUBJ HAVER/SER INFNOPRON: va moure's > il a bougé, va moure-hi, il y a remué">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT PRNPROREF VBMOD INFPRON > SENT PRNSUBJ VBMOD INFNOPRON: es pot moure > il peut bouger">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT VBMOD INFPRON PRNENC > SENT PRNSUBJ VBMOD INFNOPRON: pot moure's > il peut bouger, pot moure-hi, il y peut remuer">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

<!-- xxxxx Ara amb negació i generació de pronoms subjecte -->
    <rule comment="SENT NO PRNPROREF VERBPRON > SENT PRNSUBJ NE VERBNOPRON PAS: no es mou > il ne bouge pas">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="verbospron"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
<!--Si no concuerdan el pronombre y el verbo, envíalo todo -->
            <out>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT NO PRNPROREF HAVER PPPRON > SENT PRNSUBJ NE HAVER/SER PAS PPNOPRON: no s'ha mogut > il n'a pas bougé">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="verbospron_pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><get-case-from pos="4"><lit v="être"/></get-case-from></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="5" side="tl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="5" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT PRNPROREF NO ANAR INFPRON > SENT PRNSUBJ NE HAVER/SER PAS INFNOPRON: no es va moure > il n'a pas bougé">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT NO ANAR INFPRON PRNENC > SENT PRNSUBJ NE HAVER/SER PAS INFNOPRON: no va moure's > il n'a pas bougé, no va moure-hi, il n'y a pas remué">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="5" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="5" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT NO PRNPROREF VBMOD INFPRON > SENT PRNSUBJ NE VBMOD PAS INFNOPRON: no es pot moure > il ne peut pas bouger">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="tags"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

    <rule comment="SENT NO VBMOD INFPRON PRNENC > SENT PRNSUBJ NE VBMOD PAS INFNOPRON: no pot moure's > il ne peut pas bouger, ne pot moure-hi, il n'y peut pas remuer">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="vbmod"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>

        <choose>
<!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
          <when>
            <test>
              <equal>
                <clip pos="5" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <lit-tag v="prn.pro"/>
                <clip pos="5" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
        </out>
      </action>
    </rule>

<!-- xxxxx Ara infinitius i gerundis -->

    <rule comment="INFPRON PRNENCREF > INFNOPRON: moure's > bouger">
      <pattern>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="es_enc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
      </action>
  </rule>

    <rule comment="GERPRON PRNENCREF > GERNOPRON: mouvent-se > en bougeant">
      <pattern>
        <pattern-item n="verbospron_ger"/>
        <pattern-item n="es_enc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
      </action>
  </rule>

    <rule comment="NO INFPRON PRNENCREF > NE PAS INFNOPRON: no moure's > ne pas bouger">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="verbospron_inf"/>
        <pattern-item n="es_enc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
  </rule>

    <rule comment="NO GERPRON PRNENCREF > EN NE GERNOPRON PAS: no mouvent-se > en ne bougeant pas">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="verbospron_ger"/>
        <pattern-item n="es_enc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
  </rule>

<!-- FI REGLES VERBS QUE SÓN PRONOMINALS EN CATALÀ PERÒ NO EN FRANCÈS -->


    <rule comment="vaig fer >> ai fait">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_calen_ilfaut2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
  </action>
</rule>

    <rule comment="no vaig fer >> n'ai pas fait">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="whole"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
  </action>
</rule>

    <rule comment="REGLA: anar inf enc: van comprar-me > m'ont acheté, van comprar-se, se sont achetés">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="3" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
        </out>

        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="1" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="1" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: no anar inf enc: no van comprar-me > ne m'ont pas acheté">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="4" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="1" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="1">
                  <clip pos="4" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
        </otherwise>
      </choose>
      <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="4" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="4" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="4" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="4" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
       <out>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: GER">
      <pattern>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          </out>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="aa"/>
          </modify-case>
          <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: NO GER">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          </out>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="aa"/>
          </modify-case>
          <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: imp">
      <pattern>
        <pattern-item n="imp"/>
      </pattern>
      <action>
        <call-macro n="f_modimp">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!--REGLA: sent imp -->
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="imp"/>
      </pattern>
      <action>
        <call-macro n="f_modimp">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: inf">
      <pattern>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: verb en forma personal">
      <pattern>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_calen_ilfaut1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="1" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="tags"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="mf"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="1" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="tags"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </otherwise>
        </choose>
      </action>
  </rule>


     <rule comment="REGLA: hi ha + nom">
      <pattern>
        <pattern-item n="hi"/>
        <pattern-item n="haver-cnj-p3"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
       <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <not><equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let><var n="numero"/><clip pos="3" side="tl" part="nbr"/></let>
        </when>
        <when>
          <test>
            <not><equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let><var n="numero"/><clip pos="3" side="sl" part="nbr"/></let>
        </when>
      </choose>
<choose>
  <when>
    <test>
      <equal>
        <clip pos="2" side="tl" part="temps"/>
      <lit-tag v="imp"/>
      </equal>
    </test>
  <call-macro n="f_modimp">
          <with-param pos="2"/>
        </call-macro>
  </when>
</choose>
<out>
  <lu>
    <get-case-from pos="1">
      <lit v="il"/>
    </get-case-from>
    <lit-tag v="prn.tn.p3.m.sg"/>
  </lu>
  <b/>
  <lu>
    <get-case-from pos="2">
      <clip pos="1" side="tl" part="lem"/>
    </get-case-from>
    <clip pos="1" side="tl" part="tags"/>
  </lu>
  <b pos="1"/>
</out>
<choose>
  <when>
    <test>
      <or>
        <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
        <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="part_sing"/></in>
      </or>
    </test>
    <out>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_verb"/>
        <clip pos="2" side="tl" part="temps"/>
        <clip pos="2" side="tl" part="persona"/>
        <clip pos="2" side="tl" part="gen"/>
        <clip pos="2" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
      <b pos="2"/>
      <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="3" side="tl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
    </out>
   </when>
   <otherwise>
     <out>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="a_verb"/>
         <clip pos="2" side="tl" part="temps"/>
         <clip pos="2" side="tl" part="persona"/>
         <clip pos="2" side="tl" part="gen"/>
         <clip pos="2" side="tl" part="nbr"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </otherwise>
 </choose>
</action>
  </rule>

     <rule comment="REGLA: verb en forma personal + nom">
      <pattern>
        <pattern-item n="verb_conj"/>
      <pattern-item n="nom"/>
      </pattern>
      <action>
       <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_calen_ilfaut1">
          <with-param pos="1"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <not><equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let><var n="numero"/><clip pos="2" side="tl" part="nbr"/></let>
        </when>
        <when>
          <test>
            <not><equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let><var n="numero"/><clip pos="2" side="sl" part="nbr"/></let>
        </when>
      </choose>
<choose>
  <when>
    <test>
      <equal>
        <clip pos="1" side="tl" part="temps"/>
      <lit-tag v="imp"/>
      </equal>
    </test>
  <call-macro n="f_modimp">
          <with-param pos="1"/>
        </call-macro>
  </when>
</choose>
<choose>
  <when>
    <test>
      <or>
        <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
        <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="part_sing"/></in>
      </or>
    </test>
    <out>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_verb"/>
        <clip pos="1" side="tl" part="temps"/>
        <clip pos="1" side="tl" part="persona"/>
        <clip pos="1" side="tl" part="gen"/>
        <clip pos="1" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
      <b pos="1"/>
      <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="2" side="tl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
    </out>
   </when>
   <otherwise>
     <out>
       <lu>
         <clip pos="1" side="tl" part="lemh"/>
         <clip pos="1" side="tl" part="a_verb"/>
         <clip pos="1" side="tl" part="temps"/>
         <clip pos="1" side="tl" part="persona"/>
         <clip pos="1" side="tl" part="gen"/>
         <clip pos="1" side="tl" part="nbr"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
     </out>
   </otherwise>
 </choose>
</action>
</rule>

 <rule comment="REGLA: no+ verb en forma personal">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="verb_conj"/>
   </pattern>
   <action>
     <call-macro n="f_pis2prs">
       <with-param pos="2"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <clip pos="2" side="tl" part="temps"/>
                 <clip pos="2" side="tl" part="persona"/>
                 <clip pos="2" side="tl" part="gen"/>
                 <clip pos="2" side="tl" part="nbr"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <clip pos="2" side="tl" part="temps"/>
                 <clip pos="2" side="tl" part="persona"/>
                 <clip pos="2" side="tl" part="gen"/>
                 <clip pos="2" side="tl" part="nbr"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
      </action>
  </rule>


    <rule comment="REGLA: no+ verb en infinitiu">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
  <lu>
             <clip pos="1" side="tl" part="whole"/>
          </lu>
      <b/>
  <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
  </lu>
       <b pos="1"/>
          <lu>
              <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="persona"/>
      <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>


    <rule comment="REGLA: no+ verb en forma personal + pas, gens, gaire, etc.">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="negadv"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
  <lu>
             <clip pos="1" side="tl" part="whole"/>
          </lu>
       <b pos="1"/>
          <lu>
              <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="persona"/>
      <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
          </lu>
      <b pos="2"/>
  <lu>
             <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
  </rule>


    <rule comment="REGLA: no+ prnpro + verb en forma personal: no en vull > je n'en veux pas">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
            <clip pos="1" side="tl" part="whole"/>
           </lu>
           <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <clip pos="3" side="tl" part="temps"/>
             <clip pos="3" side="tl" part="persona"/>
             <clip pos="3" side="tl" part="gen"/>
             <clip pos="3" side="tl" part="nbr"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="whole"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <clip pos="3" side="tl" part="temps"/>
                 <clip pos="3" side="tl" part="persona"/>
                 <clip pos="3" side="tl" part="gen"/>
                 <clip pos="3" side="tl" part="nbr"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="whole"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <clip pos="3" side="tl" part="temps"/>
                 <clip pos="3" side="tl" part="persona"/>
                 <clip pos="3" side="tl" part="gen"/>
                 <clip pos="3" side="tl" part="nbr"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
      </action>
  </rule>


    <rule comment="REGLA: no+ prnpro + prnpro + verb en forma personal: no n'hi vull > je n'en y veux pas">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="4"/>
        </call-macro>
        <out>
  <lu>
             <clip pos="1" side="tl" part="whole"/>
          </lu>
       <b pos="1"/>
  <lu>
             <clip pos="2" side="tl" part="whole"/>
          </lu>
       <b pos="2"/>
  <lu>
             <clip pos="3" side="tl" part="whole"/>
          </lu>
       <b pos="3"/>
          <lu>
              <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                  <clip pos="4" side="tl" part="temps"/>
                  <clip pos="4" side="tl" part="persona"/>
      <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                  <clip pos="4" side="tl" part="lemq"/>
          </lu>
       <b/>
  <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
  </lu>
        </out>
      </action>
  </rule>


    <rule comment="REGLA: no + verb en forma personal + nom: no tinc amics > n'ai pas d'amis">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
      <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <or>
              <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
               <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="part_sing"/></in>
            </or>
          </test>
          <out>
           <lu>
           <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
        </out>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_verb"/>
                <lit-tag v="vbser"/>
              </equal>
            </test>
            <out>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
            </out>
          </when>
        </choose>
        <out>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </when>
      <otherwise>
       <out>
        <lu>
          <clip pos="1" side="tl" part="whole"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <lit v="pas"/>
          <lit-tag v="adv"/>
        </lu>
        <b/>
        <lu>
          <clip pos="3" side="tl" part="whole"/>
        </lu>
        </out>
      </otherwise>
    </choose>
   </action>
  </rule>


  <rule comment="REGLA: verb en forma no personal + nom">
      <pattern>
        <pattern-item n="verbnp"/>
      <pattern-item n="nom"/>
      </pattern>
      <action>
      <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="2"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
<choose>
          <when>
            <test>
            <or>
              <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
               <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="part_sing"/></in>
            </or>
            </test>
            <out>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
              </lu>
      <b pos="1"/>
      <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
      <clip pos="2" side="tl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
  </when>
          <otherwise>
            <out>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="persona"/>
      <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
              </lu>
      <b pos="1"/>
              <lu>
              <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

<rule comment="REGLA: prep + nom">
  <pattern>
    <pattern-item n="prep"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <!-- reset variables -->
    <let><var n="numero"/><lit-tag v="sg"/></let>
    <let><var n="genero"/><lit-tag v="m"/></let>
    <call-macro n="f_concord1">
      <with-param pos="2"/>
    </call-macro>
    <call-macro n="f_lang_dial1">
      <with-param pos="2"/>
    </call-macro>
    <call-macro n="f_setgen">
      <with-param pos="2"/>
    </call-macro>
  <choose>
    <when>
      <test>
        <equal>
          <clip pos="2" side="tl" part="nbr"/>
          <lit-tag v="sp"/>
        </equal>
      </test>
      <let>
        <var n="numero"/>
        <clip pos="2" side="sl" part="nbr"/>
      </let>
    </when>
  </choose>
  <choose>
      <when>
      <test>
        <and>
          <not><in caseless="yes"><clip pos="1" side="tl" part="lem"/><list n="pr_de"/></in></not>
          <or>
            <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            <and>
              <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
            </and>
          </or>
        </and>
      </test>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        <b pos="1"/>
        <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <clip pos="2" side="sl" part="gen"/>
            <var n="numero"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
    </out>
  </when>
  <otherwise>
    <out>
      <lu>
        <clip pos="1" side="tl" part="whole"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="tags"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
    </out>
  </otherwise>
</choose>
  </action>
  </rule>

<rule comment="REGLA: prep + nom + adj">
  <pattern>
    <pattern-item n="prep"/>
    <pattern-item n="nom"/>
    <pattern-item n="adj"/>
  </pattern>
  <action>
    <!-- reset variables -->
    <let><var n="numero"/><lit-tag v="sg"/></let>
    <let><var n="genero"/><lit-tag v="m"/></let>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="f_lang_dial1">
      <with-param pos="2"/>
    </call-macro>
      <call-macro n="f_setgen">
      <with-param pos="2"/>
    </call-macro>
  <choose>
    <when>
      <test>
        <equal>
          <clip pos="2" side="tl" part="nbr"/>
          <lit-tag v="sp"/>
        </equal>
      </test>
      <let>
        <var n="numero"/>
        <clip pos="2" side="sl" part="nbr"/>
      </let>
    </when>
  </choose>
  <choose>
    <when>
      <test>
        <and>
          <not><in caseless="yes"><clip pos="1" side="tl" part="lem"/><list n="pr_de"/></in></not>
          <or>
            <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            <and>
              <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
            </and>
          </or>
        </and>
      </test>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        <b pos="1"/>
        <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <clip pos="2" side="sl" part="gen"/>
            <var n="numero"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
    </out>
  </when>
  <otherwise>
    <out>
      <lu>
        <clip pos="1" side="tl" part="whole"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="tags"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
      <b pos="2"/>
      <lu>
        <clip pos="3" side="tl" part="lemh"/>
        <clip pos="3" side="tl" part="tags"/>
        <clip pos="3" side="tl" part="lemq"/>
      </lu>
    </out>
  </otherwise>
</choose>
  </action>
  </rule>

<rule comment="REGLA: prep + nom + adv adj">
  <pattern>
    <pattern-item n="prep"/>
    <pattern-item n="nom"/>
    <pattern-item n="adv"/>
    <pattern-item n="adj"/>
  </pattern>
  <action>
    <!-- reset variables -->
    <let><var n="numero"/><lit-tag v="sg"/></let>
    <let><var n="genero"/><lit-tag v="m"/></let>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="4"/>
    </call-macro>
    <call-macro n="f_lang_dial1">
      <with-param pos="2"/>
    </call-macro>
      <call-macro n="f_setgen">
      <with-param pos="2"/>
    </call-macro>
  <choose>
    <when>
      <test>
        <equal>
          <clip pos="2" side="tl" part="nbr"/>
          <lit-tag v="sp"/>
        </equal>
      </test>
      <let>
        <var n="numero"/>
        <clip pos="2" side="sl" part="nbr"/>
      </let>
    </when>
  </choose>
  <choose>
    <when>
      <test>
        <and>
          <not>
            <in caseless="yes"><clip pos="1" side="tl" part="lem"/><list n="pr_de"/></in>
          </not>
          <or>
            <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
            <and>
              <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
            </and>
          </or>
        </and>
        </test>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        <b pos="1"/>
        <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <clip pos="2" side="sl" part="gen"/>
            <var n="numero"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
    </out>
  </when>
  <otherwise>
    <out>
      <lu>
        <clip pos="1" side="tl" part="whole"/>
      </lu>
      <b pos="1"/>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="tags"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
      <b pos="2"/>
      <lu>
        <clip pos="3" side="tl" part="lemh"/>
        <clip pos="3" side="tl" part="tags"/>
        <clip pos="3" side="tl" part="lemq"/>
      </lu>
      <b pos="3"/>
      <lu>
        <clip pos="4" side="tl" part="lemh"/>
        <clip pos="4" side="tl" part="tags"/>
        <clip pos="4" side="tl" part="lemq"/>
      </lu>
    </out>
  </otherwise>
</choose>
  </action>
  </rule>

     <rule comment="REGLA: prep + tu">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="tu"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="toi"/>
            <lit-tag v="prn.tn.p2.mf.sg"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: prep + ell">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="ell"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="lui"/>
            <lit-tag v="prn.pro.p3.mf.sg"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: prep + ells">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="ells"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="eux"/>
            <lit-tag v="prn.tn.p3.m.pl"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: espai_prep + meu">
      <pattern>
        <pattern-item n="espai_prepadv"/>
        <pattern-item n="meu"/>
      </pattern>
      <action>
        <call-macro n="f_espai_prepadv"><with-param pos="1"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="moi"/>
            <lit-tag v="prn.tn.p1.mf.sg"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: espai_prep + teu">
      <pattern>
        <pattern-item n="espai_prepadv"/>
        <pattern-item n="teu"/>
      </pattern>
      <action>
        <call-macro n="f_espai_prepadv"><with-param pos="1"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="toi"/>
            <lit-tag v="prn.tn.p2.mf.sg"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: espai_prep + seu">
      <pattern>
        <pattern-item n="espai_prepadv"/>
        <pattern-item n="seu"/>
      </pattern>
      <action>
        <call-macro n="f_espai_prepadv"><with-param pos="1"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="lui"/>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: espai_prep + nostre">
      <pattern>
        <pattern-item n="espai_prepadv"/>
        <pattern-item n="nostre"/>
      </pattern>
      <action>
        <call-macro n="f_espai_prepadv"><with-param pos="1"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="nous"/>
            <lit-tag v="prn.tn.p1.mf.pl"/>
          </lu>
        </out>
      </action>
  </rule>

     <rule comment="REGLA: espai_prep + vostre">
      <pattern>
        <pattern-item n="espai_prepadv"/>
        <pattern-item n="vostre"/>
      </pattern>
      <action>
        <call-macro n="f_espai_prepadv"><with-param pos="1"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
            <b pos="1"/>
          <lu>
            <lit v="vous"/>
            <lit-tag v="prn.tn.p2.mf.pl"/>
          </lu>
        </out>
      </action>
  </rule>

<!-- tornar -->

    <rule comment="REGLA: tornar_conj a verb_inf > verb_conj à nouveau">
      <pattern>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="3" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="à nouveau"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="mf"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: tornar_conj a verb_inf prnenc > prnpro verb_conj à nouveau">
      <pattern>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="4" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="à nouveau"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <lit-tag v="prn.pro"/>
                    <clip pos="4" side="tl" part="tipoenc_pro"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="mf"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <lit-tag v="prn.pro"/>
                    <clip pos="4" side="tl" part="tipoenc_pro"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: tornar_conj a verb_inf prnenc prnenc > prnpro prnpro verb_conj à nouveau">
      <pattern>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
            <call-macro n="print_enc_enc_2_pro_pro">
              <with-param pos="4"/>
              <with-param pos="5"/>
            </call-macro>
            <out>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="2">
                  <lit v="à nouveau"/>
                </get-case-from>
                <lit-tag v="adv"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                </test>
                <call-macro n="print_enc_enc_2_pro_pro">
                  <with-param pos="4"/>
                  <with-param pos="5"/>
                </call-macro>
                <out>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <lit-tag v="prn.pro"/>
                    <clip pos="4" side="tl" part="tipoenc_pro"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="1" side="sl" part="persona"/>
                    <lit-tag v="mf"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                </out>
                <call-macro n="print_enc_enc_2_pro_pro">
                  <with-param pos="4"/>
                  <with-param pos="5"/>
                </call-macro>
                <out>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="à nouveau"/>
                    </get-case-from>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT tornar_conj a verb_inf > SENT prnsubj verb_conj à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: SENT tornar_conj a verb_inf prnenc > SENT prnsubj prnpro verb_conj à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="5" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="5" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: SENT tornar_conj a verb_inf prnenc prnenc > SENT prnsubj prnpro prnpro verb_conj à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="tornar_conj"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <out>
          <b/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="5"/>
          <with-param pos="6"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>


    <rule comment="REGLA: he tornat a verb_inf > ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="4">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: he tornat a verb_inf prnenc > prnpro ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>

      </pattern>
      <action>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="1"/>
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="5" side="tl" part="lem"/>
             </get-case-from>
             <lit-tag v="prn.pro"/>
             <clip pos="5" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <get-case-from pos="3">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="5" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="5" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="5" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="5" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="4">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: no he tornat a verb_inf > n'ai pas verb_pp à nouveau">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="5"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="2"/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: no he tornat a verb_inf prnenc > ne prnpro ai pas verb_pp à nouveau">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="2"/>
          <with-param pos="5"/>
          <with-param pos="6"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="6" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="6" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="2"/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="6" side="tl" part="lem"/>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="6" side="tl" part="lem"/>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: vaig tornar a verb_inf > ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="4">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: vaig tornar a verb_inf prnenc > prnpro ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="1"/>
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="5" side="tl" part="lem"/>
             </get-case-from>
             <lit-tag v="prn.pro"/>
             <clip pos="5" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <get-case-from pos="3">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="5" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="5" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="5" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="5" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="4">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: no vaig tornar a verb_inf > n'ai pas verb_pp à nouveau">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="5"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="2"/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: no vaig tornar a verb_inf prnenc > ne prnpro ai pas verb_pp à nouveau">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="2"/>
          <with-param pos="5"/>
          <with-param pos="6"/>
        </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="6" side="tl" part="lem"/>
             <lit-tag v="prn.pro"/>
             <clip pos="6" side="tl" part="tipoenc_pro"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="2"/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b/>
           <lu>
             <clip pos="5" side="tl" part="lemh"/>
             <clip pos="5" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero_tmp"/>
             <var n="numero_tmp"/>
             <clip pos="5" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="6" side="tl" part="lem"/>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="1" side="tl" part="lem"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="6" side="tl" part="lem"/>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: SENT,que he tornat a verb_inf > SENT,que j'ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: SENT,que he tornat a verb_inf prnenc > SENT,que je prnpro ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="2"/>
          <with-param pos="5"/>
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="6" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="6" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: SENT,que vaig tornar a verb_inf > SENT,que j'ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="REGLA: SENT,que vaig tornar a verb_inf prnenc > SENT,que je prnpro ai verb_pp à nouveau">
      <pattern>
        <pattern-item n="sentquerel_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_vaux_pp2_enc">
          <with-param pos="2"/>
          <with-param pos="5"/>
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="6" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="2">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="3">
                   <clip pos="6" side="tl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.pro"/>
                 <clip pos="6" side="tl" part="tipoenc_pro"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="2" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="5" side="tl" part="lemh"/>
                 <clip pos="5" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <var n="genero_tmp"/>
                 <var n="numero_tmp"/>
                 <clip pos="5" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
     <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
     <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
     <out>
       <b/>
       <lu>
         <get-case-from pos="5">
           <lit v="à nouveau"/>
         </get-case-from>
         <lit-tag v="adv"/>
       </lu>
     </out>
  </action>
</rule>

    <rule comment="PRNREF HAVER TORNAT A INF > PRNREF SER PP À NOUVEAU: s'ha tornat a incorporar > s'est incorporé à nouveau, m'ha tornat a dir > m'a dit à nouveau ">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <let><clip pos="5" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="1" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="5" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="5" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="5">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNREF HAVER TORNAT A INF > PRNREF SER PP À NOUVEAU: s'ha tornat a incorporar > s'est incorporé à nouveau, m'ha tornat a dir > m'a dit à nouveau ">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <let><clip pos="6" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="6" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="6" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="6" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="6">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNREF ANAR TORNAR A INF > PRNREF SER PP À NOUVEAU: es va tornar a incorporar > s'est incorporé à nouveau, em va tornar a dir > m'a dit à nouveau ">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <let><clip pos="5" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="1" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="5" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="5" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
          <otherwise>
            <let><clip pos="2" side="tl" part="lem"/><lit v="avoir"/></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="5">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNREF ANAR TORNAR A INF > PRNREF SER PP À NOUVEAU: es va tornar a incorporar > s'est incorporé à nouveau, em va tornar a dir > m'a dit à nouveau ">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <let><clip pos="6" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="6" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="6" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="6" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
          <otherwise>
            <let><clip pos="3" side="tl" part="lem"/><lit v="avoir"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="6">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNREF HAVER TORNAT A INF > NE PRNREF SER PAS PP À NOUVEAU: no s'ha tornat a incorporar > ne s'est pas incorporé à nouveau, no m'ha tornat a dir > ne m'a pas dit à nouveau ">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <let><clip pos="6" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="6" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="6" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="6" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="1" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="6">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNREF HAVER TORNAT A INF > NE PRNREF SER PAS PP À NOUVEAU: no s'ha tornat a incorporar > ne s'est pas incorporé à nouveau, no m'ha tornat a dir > ne m'a pas dit à nouveau ">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="tornar_pp"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <let><clip pos="7" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="4" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="7" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="7" side="tl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="7" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="4">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="4">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="tags"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="6"/><with-param pos="7"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="7">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNREF VA TORNAR A INF > NE PRNREF SER PAS PP À NOUVEAU: no es va tornar a incorporar > ne s'est pas incorporé à nouveau, no em va tornar a dir > ne m'a pas dit à nouveau ">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <let><clip pos="6" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="6" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="6" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="6" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
          <otherwise>
            <let><clip pos="3" side="tl" part="lem"/><lit v="avoir"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="1" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="6">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNREF VA TORNAR A INF > NE PRNREF SER PAS PP À NOUVEAU: no es va tornar a incorporar > ne s'est pas incorporé à nouveau, no em va tornar a dir > ne m'a pas dit à nouveau ">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="tornar_inf"/>
        <pattern-item n="aprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <let><clip pos="7" side="tl" part="temps"/><lit-tag v="pp.m.sg"/></let>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="4" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="7" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="7" side="tl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="7" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
          <otherwise>
            <let><clip pos="4" side="tl" part="lem"/><lit v="avoir"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="whole"/>
                </get-case-from>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="4">
                  <clip pos="2" side="tl" part="whole"/>
                </get-case-from>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="4">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="7" side="tl" part="lemh"/>
            <clip pos="7" side="tl" part="tags"/>
            <clip pos="7" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="5"/><with-param pos="6"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="6"/><with-param pos="7"/></call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="7">
              <lit v="à nouveau"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

<!-- fi tornar -->

<!-- verbs modals -->

    <rule comment="regla: cal + inf -> il faut + inf">
      <pattern>
        <pattern-item n="caldre"/>
        <pattern-item n="inf_que"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: cal + inf + prnenc -> il faut + prnpro + inf">
      <pattern>
        <pattern-item n="caldre"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="3" side="tl" part="lem"/>
            </get-case-from>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: cal + inf + prnenc + prnenc -> il faut + prnpro + prnpro + inf">
      <pattern>
        <pattern-item n="caldre"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: anar + caldre_inf + inf -> il a fallu + inf">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="caldre_inf"/>
        <pattern-item n="inf_que"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: anar + caldre_inf + inf + prnenc -> il a fallu + prnpro + inf">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="caldre_inf"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: anar + caldre_inf + inf + prnenc + prnenc -> il a fallu + prnpro + prnpro + inf">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="caldre_inf"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il"/>
            </get-case-from>
            <lit-tag v="prn.tn.p3.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="2"/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es + poder -> on + pouvoir ">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="poder_p3"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal>
                <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              </and>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es + haver + pogut -> on + avoir + pu ">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haver_p3"/>
        <pattern-item n="poder_pp"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal>
                <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
              </and>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es + anar + poder_inf -> on + avoir + pu ">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="anarprip3"/>
        <pattern-item n="poder_inf"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver.pri.p3.sg"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <lit-tag v="sg"/>
                <clip pos="3" side="tl" part="lemq"/>
               </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser.pri.p3"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
               </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="regla: SENT s'ha de + inf -> SENT on doit + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="haverde"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: s'ha de + inf -> doit se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haverde"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT no s'ha de + inf -> SENT on ne doit pas + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="haverde"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="4">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: no s'ha de + inf -> ne doit pas se + inf">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="haverde"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="1">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT s'ha hagut de + inf -> SENT on a dû + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="haverde_pp"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: s'ha hagut de + inf -> a dû se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="haverde_pp"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT es va haver de + inf -> SENT on a dû + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es va haver de + inf -> a dû se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT no es va haver de + inf -> SENT on n'a pas dû + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="4">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <get-case-from pos="5">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: no es va haver de + inf -> n'a pas dû se + inf">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="3"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT va haver-se de + inf -> SENT on a dû + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="es_enc"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: va haver-se de + inf -> a dû se + inf">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="haverde_inf"/>
        <pattern-item n="es_enc"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
              <lit v="devoir"/>
            </get-case-from>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="se"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT es voler + inf -> SENT on vouloir + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="voler_mod"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es + voler + inf -> vouloir se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="voler_mod"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT s'ha volgut + inf -> SENT on a voulu + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="voler_mod_pp"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es + ha volgut + inf -> a voulu se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="voler_mod_pp"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT es va voler + inf -> SENT on a voulu + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="voler_mod_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri.p3.sg"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es va voler + inf -> a voulu se + inf">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="voler_mod_inf"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <lit-tag v="vbmod.pp.m.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: es soler + inf -> on + vblex_cnj + d'habitude">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="soler"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <lit-tag v="p3.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="d'habitude"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT es soler + inf -> SENT on + vblex_cnj + d'habitude">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="soler"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <lit-tag v="p3.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="d'habitude"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: no es soler + inf -> on + ne + vblex_cnj + pas + d'habitude">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="soler"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <lit-tag v="p3.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="d'habitude"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT no es soler + inf -> SENT on + ne + vblex_cnj + pas + d'habitude">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="soler"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <lit-tag v="p3.sg"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <lit v="d'habitude"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
    </rule>

<!-- fi verbs modals -->

<!-- passiva reflexa -->

    <rule comment="regla: es diu que -> on dit que (suposo que és una passiva reflexa)">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="passiva_reflexa_p3sg"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: s'ha dit que -> on a dit que (suposo que és una passiva reflexa)">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="passiva_reflexa_pp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: SENT s'ha dit que -> SENT on a dit que (suposo que és una passiva reflexa)">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="es"/>
        <pattern-item n="haver_prip3sg"/>
        <pattern-item n="passiva_reflexa_pp"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="on"/>
            </get-case-from>
            <lit-tag v="prn.pro.ref.p3.mf.sp"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

<!-- fi passiva reflexa -->

<rule comment="regla: haverger pp: havent caigut > après être tombé">
   <pattern>
     <pattern-item n="haverger"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <let><clip pos="1" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <out>
       <lu>
         <get-case-from pos="1">
           <lit v="après"/>
         </get-case-from>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <get-case-from pos="2">
           <clip pos="1" side="tl" part="lem"/>
         </get-case-from>
         <clip pos="1" side="tl" part="tags"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>

<rule comment="regla: haver pp: he caigut > suis tombé">
   <pattern>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <get-case-from pos="1">
               <clip pos="1" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: no haver pp: no he caigut > ne suis pas tombé">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
         </test>
         <out>
           <lu>
             <clip pos="1" side="tl" part="lem"/>
             <clip pos="1" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b/>
           <lu>
             <lit v="pas"/>
             <lit-tag v="adv"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </out>
       </when>
       <otherwise>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
             <modify-case>
               <clip pos="1" side="tl" part="lemh"/>
               <lit v="aa"/>
             </modify-case>
             <out>
               <lu>
                 <clip pos="1" side="tl" part="whole"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="pas"/>
                 <lit-tag v="adv"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
             </out>
           </otherwise>
         </choose>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: haver pp nom: han passat camions > sont passés des camions">
   <pattern>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="1"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="3"/>
     </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="3"/>
        </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="3"/>
     </call-macro>
     <out>
       <lu>
         <get-case-from pos="1">
           <clip pos="1" side="tl" part="lem"/>
         </get-case-from>
         <clip pos="1" side="tl" part="tags"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="3" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: no haver pp: no han passat camions > ne sont pas passés des camions">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_lang_dial1">
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="4"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="lem"/>
         <clip pos="1" side="tl" part="tags"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="4" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: prnpronoref haver pp: hi han passat camions > y sont passés des camions">
   <pattern>
     <pattern-item n="prnpronoref"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="4"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="3" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: no prnpronoref haver pp: no hi han passat camions > n'y sont pas passés des camions">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="prnpronoref"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="3"/>
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="5"/>
     </call-macro>
     <call-macro n="f_lang_dial1">
       <with-param pos="5"/>
     </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="5"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="whole"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lem"/>
         <clip pos="3" side="tl" part="tags"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="4" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="4"/>
       <lu>
         <clip pos="5" side="tl" part="lemh"/>
         <clip pos="5" side="tl" part="tags"/>
         <clip pos="5" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: haver estarpp ger: han estat cantant > ont été en train de chanter">
   <pattern>
     <pattern-item n="haver"/>
     <pattern-item n="estar_portar_pp"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <out>
       <lu>
         <clip pos="1" side="tl" part="lem"/>
         <clip pos="1" side="tl" part="tags"/>
         <clip pos="1" side="tl" part="lemq"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="en train de"/>
         <lit-tag v="pr"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="a_verb"/>
         <lit-tag v="inf"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: no haver estarpp ger: no han estat cantant > n'ont pas été en train de chanter">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="haver"/>
     <pattern-item n="estar_portar_pp"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
         <clip pos="2" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="en train de"/>
         <lit-tag v="pr"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="a_verb"/>
         <lit-tag v="inf"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: anarpri estarinf ger: van estar cantant > ont été en train de chanter">
   <pattern>
     <pattern-item n="anarpri"/>
     <pattern-item n="estar_portar_inf"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <out>
       <lu>
         <lit v="avoir"/>
         <lit-tag v="vbhaver"/>
         <lit-tag v="pri"/>
         <clip pos="1" side="tl" part="persona"/>
         <clip pos="1" side="tl" part="nbr"/>
       </lu>
       <b pos="1"/>
       <lu>
         <clip pos="2" side="tl" part="lemh"/>
         <clip pos="2" side="tl" part="a_verb"/>
         <lit-tag v="pp.m.sg"/>
       </lu>
       <b/>
       <lu>
         <lit v="en train de"/>
         <lit-tag v="pr"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="a_verb"/>
         <lit-tag v="inf"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: no anarpri estarinf ger: no van estar cantant > n'ont pas été en train de chanter">
   <pattern>
     <pattern-item n="noadv"/>
     <pattern-item n="anarpri"/>
     <pattern-item n="estar_portar_inf"/>
     <pattern-item n="ger"/>
   </pattern>
   <action>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       <lu>
         <lit v="avoir"/>
         <lit-tag v="vbhaver"/>
         <lit-tag v="pri"/>
         <clip pos="2" side="tl" part="persona"/>
         <clip pos="2" side="tl" part="nbr"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="a_verb"/>
         <lit-tag v="pp.m.sg"/>
       </lu>
       <b/>
       <lu>
         <lit v="en train de"/>
         <lit-tag v="pr"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="a_verb"/>
         <lit-tag v="inf"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>



<rule comment="regla: SENT haverger pp: SENT havent caigut > SENT après être tombé">
   <pattern>
     <pattern-item n="sentquecm"/>
     <pattern-item n="haverger"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       <lu>
         <get-case-from pos="2">
           <lit v="après"/>
         </get-case-from>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <get-case-from pos="3">
           <clip pos="2" side="tl" part="lem"/>
         </get-case-from>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>

<rule comment="regla: SENT haver pp: SENT he caigut > SENT je suis tombé">
   <pattern>
     <pattern-item n="sentquecm"/>
     <pattern-item n="vbhaver_conj"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_setpronom">
       <with-param pos="2"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

     <out>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: SENT no haver pp: SENT no he caigut > SENT je ne suis pas tombé">
   <pattern>
     <pattern-item n="sentquecm"/>
     <pattern-item n="noadv"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_vaux_pp2">
       <with-param pos="3"/>
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_setpronom">
       <with-param pos="3"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

     <out>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lem"/>
         <clip pos="3" side="tl" part="tags"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: SENT haver pp: SENT han vist camions > SENT ils ont vu des camions">
   <pattern>
     <pattern-item n="sentquecm"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_vaux_pp2">
       <with-param pos="2"/>
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_setpronom">
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_lang_dial1">
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="4"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <when>
            <test>
              <or>
                <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p1"/></equal>
                <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p2"/></equal>
              </or>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

     <out>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lemh"/>
         <clip pos="3" side="tl" part="tags"/>
         <clip pos="3" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="4" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>


<rule comment="regla: SENT no haver pp: SENT no han vist camions > SENT ils n'ont pas vu des camions">
   <pattern>
     <pattern-item n="sentquecm"/>
     <pattern-item n="noadv"/>
     <pattern-item n="haver"/>
     <pattern-item n="pp"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_vaux_pp2">
       <with-param pos="3"/>
       <with-param pos="4"/>
     </call-macro>
     <call-macro n="f_setpronom">
       <with-param pos="3"/>
     </call-macro>
     <call-macro n="f_concord1">
       <with-param pos="5"/>
     </call-macro>
     <call-macro n="f_lang_dial1">
       <with-param pos="5"/>
     </call-macro>
     <call-macro n="f_setgen">
       <with-param pos="5"/>
     </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

     <out>
       <lu>
         <clip pos="2" side="tl" part="lem"/>
         <clip pos="2" side="tl" part="tags"/>
       </lu>
       <b pos="2"/>
       <lu>
         <clip pos="3" side="tl" part="lem"/>
         <clip pos="3" side="tl" part="tags"/>
       </lu>
       <b/>
       <lu>
         <lit v="pas"/>
         <lit-tag v="adv"/>
       </lu>
       <b pos="3"/>
       <lu>
         <clip pos="4" side="tl" part="lemh"/>
         <clip pos="4" side="tl" part="tags"/>
         <clip pos="4" side="tl" part="lemq"/>
       </lu>
       <b/>
       <lu>
         <lit v="de"/>
         <lit-tag v="pr"/>
       </lu>
       <b/>
       <lu>
         <lit v="le"/>
         <lit-tag v="det.def"/>
         <clip pos="5" side="sl" part="gen"/>
         <var n="numero"/>
       </lu>
       <b pos="4"/>
       <lu>
         <clip pos="5" side="tl" part="lemh"/>
         <clip pos="5" side="tl" part="tags"/>
         <clip pos="5" side="tl" part="lemq"/>
       </lu>
     </out>
   </action>
</rule>

    <rule comment="PRNREF HAVER PP > PRNREF SER PP: s'ha incorporat > s'est incorporé, m'ha dit > m'a dit">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_seton">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_calen_ilfaut2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="falloir"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="il"/>
                </get-case-from>
                <lit-tag v="prn.tn.p3.m.sg"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="1" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="1" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNPROADV HAVER PP > PRNPROADV HAVER/SER PP: n'ha incorporat > n'a incorporé, hi ha anat > y est allé">
      <pattern>
        <pattern-item n="prnpronoref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="2" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="3" side="tl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="3" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNREF HAVER PP > NO PRNREF SER PP: no s'ha incorporat > ne s'est pas incorporé, no m'ha dit > ne m'a pas dit">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="NO PRNPROADV HAVER PP > NO PRNPROADV HAVER/SER PP: no n'ha incorporat > n'en a pas incorporé, no hi ha anat > n'y est pas allé">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpronoref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="PRNREF ANAR INF > PRNREF SER PP: es va incorporar > s'est incorporé, em va dir > m'a dit">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_calen_ilfaut2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_seton">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="1" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="NO PRNREF ANAR INF > NE PRNREF SER PAS PP: no es va incorporar > ne s'est pas incorporé, no em va dir > ne m'a pas dit">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="PRNPROADV ANAR INF > PRNPROADV HAVER/SER PP: hi va arribar > y est arrivé, hi va dir > hi a dit">
      <pattern>
        <pattern-item n="prnpronoref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="NO PRNPROADV ANAR INF > NE PRNPROADV ADV/SER PAS PP: no hi va anar > n'y est pas arrivé, no hi va dir > n'y a pas dit">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpronoref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

<!-- regles de generació de pronoms-->
    <rule comment="REGLA: SENT,que VERB">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="2" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="2" side="tl" part="lemh"/>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="2" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="2" side="tl" part="lemh"/>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que anar inf">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="sl" part="lem"/>
            <lit-tag v="prn.tn"/>
            <clip pos="2" side="sl" part="persona"/>
            <lit-tag v="m"/>
            <clip pos="2" side="sl" part="nbr"/>
          </lu>
          <b/>
        </out>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que NO anar inf">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="sl" part="lem"/>
            <lit-tag v="prn.tn"/>
            <clip pos="3" side="sl" part="persona"/>
            <lit-tag v="m"/>
            <clip pos="3" side="sl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
          </lu>
          <b pos="2"/>
        </out>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que anar inf enc: Van comprar-me > Ils m'ont acheté">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="2" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="4" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><clip pos="2" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="4" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                    <equal><clip pos="4" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="4" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="4" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <get-case-from pos="3">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp.m"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="3">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: SENT,que NO anar inf enc: No van comprar-me > Ils ne m'ont pas acheté">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="5" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="5" side="tl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.pro"/>
                <clip pos="5" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="5" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="5" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="5" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="5" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="5" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="5" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="5" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="5" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <get-case-from pos="3">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="3">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: Que_rel VERB">
      <pattern>
        <pattern-item n="que_rel"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="qui"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
        <otherwise>
      <!-- el que segueix és una còpia de la regla anterior -->
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="2" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="2" side="tl" part="lemh"/>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                </out>
                <modify-case>
                  <clip pos="2" side="tl" part="lemh"/>
                  <lit v="aa"/>
                </modify-case>
                <out>
                  <lu>
                    <clip pos="2" side="tl" part="lemh"/>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: Que_rel anar inf">
      <pattern>
        <pattern-item n="que_rel"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <not>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="qui"/>
              </equal>
              </not>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
        </choose>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: Que_rel no anar inf (que no va inventar: qu'il n'a pas inventé, que no ha vingut: qui n'est pas venu)">
      <pattern>
        <pattern-item n="que_rel"/>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <not>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="qui"/>
              </equal>
              </not>
            </test>
            <out>
              <lu>
                <clip pos="3" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
       <out>
          <lu>
            <get-case-from pos="4">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="4">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que ser pp: seria expulsada > elle serait expulsée">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="vbser_conj"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="gen"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que ser pp: SENT,que + No + VERB > SENT,que + PRNSUJ + Ne + VERB + pas">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <clip pos="3" side="sl" part="lem"/>
                    </get-case-from>
                    <lit-tag v="prn.tn"/>
                    <clip pos="3" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="3" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: SENT,que ser pp: SENT,que + No + VERB + Ni > SENT,que + PRNSUJ + Ne + VERB + Ni">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="negadv"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="whole"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <clip pos="3" side="sl" part="lem"/>
                    </get-case-from>
                    <lit-tag v="prn.tn"/>
                    <clip pos="3" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="3" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="whole"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

<!-- dóna massa problemes perquè deixen de generar-se articles partitius
    <rule comment="REGLA: PRNPRO VERB: li escriuen >> lui écrivent">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_seton">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>
-->

<!-- ara amb pronom -->
    <rule comment="REGLA: SENT,que PRNPRO VERB: Li escriuen >> Ils lui écrivent">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_calen_ilfaut1">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
          <!-- no generem un pronom per al subjecte -->
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PRNREF HAVER PP > PRNREF SER PP: s'ha incorporat > il s'est incorporé">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
          <!-- no generem un pronom per al subjecte -->
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </otherwise>
        </choose>
<!--
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <clip pos="2" side="sl" part="persona"/>
              </equal>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
          </when>
        </choose>
-->
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="3" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="4" side="tl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></let>
<!-- el pronom subjecte es crea en masculí, per tant deixem igual el gènere del participi
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><clip pos="4" side="tl" part="gen"/><var n="genero"/></let>
              </when>
            </choose>
-->
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule>
<!--REGLA: NO PRNREF HAVER PP > NE PRNREF SER PAS PP: no s'ha incorporat > il ne s'est pas incorporé -->
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haver"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="lem"/>
                </get-case-from>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="3">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="3">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>
<!--
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="persona"/>
              </equal>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="5" side="tl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></let>
          </when>
        </choose>
-->
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="4" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <let><clip pos="4" side="tl" part="lem"/><lit v="être"/></let>
            <let><clip pos="4" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
            <let><clip pos="5" side="tl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <!-- ja hem posat 'on' -->
            <call-macro n="f_bcond">
              <with-param pos="3"/>
              <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: SENT,que No PRN VERB: No li escriuen >> Ils ne lui écrivent pas">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="lem"/>
                </get-case-from>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
            </out>
            <let><clip pos="4" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <!-- ja hem posat 'on' -->
            <call-macro n="f_bcond">
              <with-param pos="3"/>
              <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que PRN VERB : Li vas dir >> Tu lui as dit, Hi vas anar >> Tu y es allé">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_seton">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
          <!-- no generem un pronom per al subjecte -->
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <out>
              <lu>
                <lit v="être"/>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <lit v="avoir"/>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que NO PRN VERB : NO li vas dir >> Tu ne lui as pas dit, No hi vas anar >> Tu n'y es pas allé">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
          <!-- no generem un pronom per al subjecte -->
          </when>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </otherwise>
        </choose>
        <out>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="4" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <out>
              <lu>
                <lit v="être"/>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="a_verb"/>
                <lit-tag v="pp.m"/>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <lit v="avoir"/>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

<!--ara amb nom-->
    <rule comment="REGLA: SENT,que + VERB + NOM">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_calen_ilfaut1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <not><equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let>
            <var n="numero"/><clip pos="3" side="tl" part="nbr"/></let>
        </when>
        <when>
          <test>
            <not><equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal></not>
          </test>
          <let>
            <var n="numero"/><clip pos="3" side="sl" part="nbr"/></let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="tags"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <clip pos="2" side="sl" part="lem"/>
                    </get-case-from>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="2" side="tl" part="lemq"/>
                  </lu>
                  <b pos="2"/>
                </out>
                <choose>
                  <when>
                    <test>
                      <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="devenir"/></equal></not>
                    </test>
                    <out>
                      <lu>
                        <lit v="de"/>
                        <lit-tag v="pr"/>
                      </lu>
                      <b/>
                      <lu>
                        <lit v="le"/>
                        <lit-tag v="det.def"/>
                        <clip pos="3" side="tl" part="gen"/>
                        <var n="numero"/>
                      </lu>
                      <b/>
                    </out>
                  </when>
                </choose>
                <out>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="tags"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
            </out>
            <choose>
              <when>
                <test>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="devenir"/></equal></not>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="le"/>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <var n="numero"/>
                  </lu>
                  <b/>
                </out>
              </when>
            </choose>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que + ANAR + INF + NOM">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_calen_ilfaut2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
            <test>
            <or>
              <equal><clip pos="3" side="sl" part="a_verb"/><lit-tag v="vbser"/></equal>
              <not><equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal></not>
              <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="part_sing"/></in>
            </or>
            </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                </out>
                <choose>
                  <when>
                    <test>
                      <equal><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></equal>
                    </test>
                    <out>
                      <lu>
                        <clip pos="3" side="tl" part="lemh"/>
                        <clip pos="3" side="tl" part="a_verb"/>
                        <lit-tag v="pp.m"/>
                        <clip pos="2" side="tl" part="nbr"/>
                        <clip pos="3" side="tl" part="lemq"/>
                      </lu>
                    </out>
                  </when>
                  <otherwise>
                    <out>
                      <lu>
                        <clip pos="3" side="tl" part="lemh"/>
                        <clip pos="3" side="tl" part="a_verb"/>
                        <lit-tag v="pp.m.sg"/>
                        <clip pos="3" side="tl" part="lemq"/>
                      </lu>
                    </out>
                  </otherwise>
                </choose>
                <out>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="tags"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <call-macro n="f_setgen">
                <with-param pos="4"/>
               </call-macro>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </test>
                  <let>
                    <var n="numero"/>
                    <clip pos="4" side="sl" part="nbr"/>
                  </let>
                </when>
              </choose>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                </out>
                <choose>
                  <when>
                    <test>
                      <equal><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></equal>
                    </test>
                    <out>
                      <lu>
                        <clip pos="3" side="tl" part="lemh"/>
                        <clip pos="3" side="tl" part="a_verb"/>
                        <lit-tag v="pp.m"/>
                        <clip pos="2" side="tl" part="nbr"/>
                        <clip pos="3" side="tl" part="lemq"/>
                      </lu>
                    </out>
                  </when>
                  <otherwise>
                    <out>
                      <lu>
                        <clip pos="3" side="tl" part="lemh"/>
                        <clip pos="3" side="tl" part="a_verb"/>
                        <lit-tag v="pp.m.sg"/>
                        <clip pos="3" side="tl" part="lemq"/>
                      </lu>
                    </out>
                  </otherwise>
                </choose>
                <out>
                  <b/>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="le"/>
                    <lit-tag v="det.def"/>
                    <clip pos="4" side="sl" part="gen"/>
                    <var n="numero"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="tags"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
            </out>
            <choose>
              <when>
                <test>
                  <equal><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbser"/></equal>
                </test>
                <out>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <lit-tag v="pp.m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <lit-tag v="pp.m.sg"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
            <out>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: SENT,que + VERB + VERB + NOM">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="verbnp"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
            <test>
            <or>
              <equal><clip pos="3" side="sl" part="a_verb"/><lit-tag v="vbser"/></equal>
              <not><equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal></not>
              <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="part_sing"/></in>
            </or>
            </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="tags"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <call-macro n="f_setgen">
                <with-param pos="4"/>
               </call-macro>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </test>
                  <let>
                    <var n="numero"/>
                    <clip pos="4" side="sl" part="nbr"/>
                  </let>
                </when>
              </choose>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="sl" part="lem"/>
                    <lit-tag v="prn.tn"/>
                    <clip pos="2" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_verb"/>
                    <clip pos="2" side="tl" part="temps"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="le"/>
                    <lit-tag v="det.def"/>
                    <clip pos="4" side="sl" part="gen"/>
                    <var n="numero"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="tags"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="REGLA: sentque_nocm no + verb en forma personal + nom: no tinc amics > je n'ai pas d'amis">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="4"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="tags"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <clip pos="3" side="sl" part="lem"/>
                    </get-case-from>
                    <lit-tag v="prn.tn"/>
                    <clip pos="3" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="tags"/>
                    <clip pos="3" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
		  </out>
		  <choose>
		    <when>
		      <test>
			<equal>
			  <clip pos="3" side="sl" part="a_verb"/>
			  <lit-tag v="vbser"/>
			</equal>
		      </test>
		      <out>
			<b/>
			<lu>
			  <lit v="le"/>
			  <lit-tag v="det.def"/>
			  <clip pos="4" side="sl" part="gen"/>
			  <var n="numero"/>
			</lu>
		      </out>
		    </when>
		  </choose>
		  <out>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="tags"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              </out>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="3" side="sl" part="a_verb"/>
                      <lit-tag v="vbser"/>
                    </equal>
                  </test>
                  <out>
                    <b/>
                    <lu>
                      <lit v="le"/>
                      <lit-tag v="det.def"/>
                      <clip pos="4" side="sl" part="gen"/>
                      <var n="numero"/>
                    </lu>
                  </out>
                </when>
              </choose>
              <out>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="sentque_nocm PRNREF ANAR INF > PRNREF SER PP: es va incorporar > il s'est incorporé, em va dir > il m'a dit">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>

     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
          <!-- no generem un pronom per al subjecte -->
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="3" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
            </out>
            <modify-case>
              <clip pos="2" side="tl" part="lemh"/>
              <lit v="aa"/>
            </modify-case>
          </otherwise>
        </choose>

        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="2" side="sl" part="persona"/><clip pos="3" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="2" side="sl" part="nbr"/><clip pos="3" side="sl" part="nbr"/></equal>
                    <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="4" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="tags"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <get-case-from pos="3">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="sentque_nocm NO PRNREF ANAR INF > NE PRNREF SER PAS PP: no es va incorporar > il ne s'est pas incorporé, no em va dir > il ne m'a pas dit">
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="4"/>
        </call-macro>
     <out>
       <lu>
         <clip pos="1" side="tl" part="whole"/>
       </lu>
       <b pos="1"/>
       </out>

        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="tl" part="lem"/>
                </get-case-from>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b/>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="2">
                  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="4" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
        <modify-case>
          <clip pos="2" side="tl" part="lemh"/>
          <lit v="aa"/>
        </modify-case>

        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <lit v="on"/>
              </equal>
            </test>
            <!-- ja hem posat 'on' -->
            <call-macro n="f_bcond">
              <with-param pos="3"/>
              <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
            </out>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <or>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <not><equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal></not>
                  <equal><clip pos="3" side="sl" part="persona"/><clip pos="4" side="sl" part="persona"/></equal>
                  <or>
                    <equal><clip pos="3" side="sl" part="nbr"/><clip pos="4" side="sl" part="nbr"/></equal>
                    <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
                  </or>
                </and>
                <and>
                  <not><equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="on"/></equal></not>
                  <equal><clip pos="4" side="sl" part="persona"/><lit-tag v="p3"/></equal>
                  <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="es"/></equal>
                </and>
                <in caseless="yes"><clip pos="5" side="tl" part="lemh"/><list n="vbambser"/></in>
              </or>
            </test>
            <choose>
              <when>
                <test>
                    <or>
                      <equal><var n="genero"/><lit-tag v="m"/></equal>
                      <equal><var n="genero"/><lit-tag v="f"/></equal>
                    </or>
                </test>
                <let><var n="genero_tmp"/><var n="genero"/></let>
              </when>
              <otherwise>
                <let><var n="genero_tmp"/><lit-tag v="m"/></let>
              </otherwise>
            </choose>
            <out>
              <lu>
                <get-case-from pos="4">
                  <lit v="être"/>
                </get-case-from>
                <lit-tag v="vbser"/>
                <lit-tag v="pri"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="a_verb"/>
                <lit-tag v="pp"/>
                <lit-tag v="m"/>
                <!-- <var n="genero_tmp"/> -->
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="4">
                  <lit v="avoir"/>
                </get-case-from>
                <lit-tag v="vbhaver"/>
                <lit-tag v="pri"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="a_verb"/>
                <lit-tag v="pp.m.sg"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>


    <rule>
<!--REGLA: sentque_nocm No + VERB + VERB + NOM-->
      <pattern>
        <pattern-item n="sentque_nocm"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="verbnp"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_setpronom">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="5"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="5" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="4" side="sl" part="a_verb"/>
                    <lit-tag v="vbser"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <lit v="ce"/>
                    </get-case-from>
                    <lit-tag v="prn.tn.nt"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="a_verb"/>
                    <clip pos="4" side="tl" part="temps"/>
                    <clip pos="4" side="tl" part="persona"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="whole"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
                    <get-case-from pos="2">
                      <clip pos="3" side="sl" part="lem"/>
                    </get-case-from>
                    <lit-tag v="prn.tn"/>
                    <clip pos="3" side="sl" part="persona"/>
                    <lit-tag v="m"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <get-case-from pos="3">
                      <clip pos="2" side="tl" part="lemh"/>
                    </get-case-from>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lemh"/>
                    <clip pos="3" side="tl" part="a_verb"/>
                    <clip pos="3" side="tl" part="temps"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="pas"/>
                    <lit-tag v="adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lemh"/>
                    <clip pos="4" side="tl" part="a_verb"/>
                    <clip pos="4" side="tl" part="temps"/>
                    <clip pos="4" side="tl" part="persona"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                    <clip pos="4" side="tl" part="lemq"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="le"/>
                    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <var n="numero"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="5" side="tl" part="lemh"/>
                    <clip pos="5" side="tl" part="tags"/>
                    <clip pos="5" side="tl" part="lemq"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <get-case-from pos="2">
                  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
                <lit-tag v="prn.tn"/>
                <clip pos="3" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <get-case-from pos="3">
                  <clip pos="2" side="tl" part="lemh"/>
                </get-case-from>
                <clip pos="2" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <clip pos="4" side="tl" part="temps"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="5" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="tags"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!-- fi ara amb nom-->

<!--ara amb pronom-->
    <rule comment="PRN + VERB">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="PRN + No + VERB">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="PRETÈRIT INDEFINIT.  Per traduir 'vaig fer' per 'ai fait'">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>

    <rule comment="PRETÈRIT INDEFINIT.  Per traduir 'vaig fer' per 'ai fait'">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
        </out>
      <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="tl" part="lem"/><list n="vbambser"/></in>
            </test>
 <out>
          <lu>
            <get-case-from pos="3">
              <lit v="être"/>
            </get-case-from>
            <lit-tag v="vbser"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       <otherwise>
        <out>
          <lu>
            <get-case-from pos="3">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>

    <rule comment="PRN + VERB + NOM">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="3"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_verb"/>
                <lit-tag v="vbser"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="tags"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="PRN + VERB + VERB + NOM">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="verbnp"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
            <or>
              <equal><clip pos="3" side="sl" part="a_verb"/><lit-tag v="vbser"/></equal>
              <not><equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="pl"/></equal></not>
              <in caseless="yes"><clip pos="2" side="tl" part="lem"/><list n="part_sing"/></in>
            </or>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
          <call-macro n="f_setgen">
            <with-param pos="4"/>
          </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="PRN + No + VERB + NOM">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="4"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="a_verb"/>
                <lit-tag v="vbser"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="tags"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="PRN + No + VERB + VERB + NOM">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="noadv"/>
        <pattern-item n="verb_conj"/>
        <pattern-item n="verbnp"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_setgen">
          <with-param pos="5"/>
        </call-macro>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="5" side="sl" part="nbr"/>
          </let>
        </when>
      </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="a_verb"/>
                <lit-tag v="vbser"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <clip pos="4" side="tl" part="temps"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="4"/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_verb"/>
                <clip pos="3" side="tl" part="temps"/>
                <clip pos="3" side="tl" part="persona"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="3"/>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <clip pos="4" side="tl" part="temps"/>
                <clip pos="4" side="tl" part="persona"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="4"/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="le"/>
                <lit-tag v="det.def"/>
                <clip pos="5" side="sl" part="gen"/>
                <var n="numero"/>
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="tags"/>
                <clip pos="5" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>



     <rule comment="prn + acabar de + inf -> prn + venir de + inf">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="verb_conj"/>
      <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
           <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
             <lu>
        <lit v="venir"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
        <clip pos="3" side="tl" part="whole"/>
      </lu>
      <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <clip pos="4" side="tl" part="temps"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
      </action>
    </rule>

     <rule comment="acabar de + inf + enc-> venir de + enc + inf">
      <pattern>
        <pattern-item n="prntn"/>
        <pattern-item n="verb_conj"/>
      <pattern-item n="deprep"/>
        <pattern-item n="inf"/>
      <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
           <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
             <lu>
        <lit v="venir"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
        <clip pos="3" side="tl" part="whole"/>
      </lu>
      <b pos="3"/>
      <lu>
        <clip pos="5" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="5" side="tl" part="tipoenc_pro"/>
      </lu>
      <b pos="4"/>
              <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_verb"/>
                <clip pos="4" side="tl" part="temps"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </out>
      </action>
    </rule>

<!-- fi ara amb pronom-->
<!-- fi regles generació pronom -->

<rule comment="SENT + IMP + ENCLÍTIC">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modimp">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <mlu>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
  </rule>

    <rule comment="IMP + ENCLÍTIC">
      <pattern>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modimp">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
  </rule>

    <rule comment="GER + ENC">
      <pattern>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="2" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="NO + GER + ENC">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="INF + ENC">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="2" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="NO + INF + ENC">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
  </lu>
  <b/>
  <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
  </lu>
  <b/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="INF + ENC + ENC">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="NO + INF + ENC + ENC: no donar-li'n > ne pas lui en donner">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
        </lu>
        <b/>
        <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
        </lu>
        <b/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="GER + ENC + ENC">
      <pattern>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="NO + GER + ENC + ENC">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <clip pos="1" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="print_enc_enc_2_pro_pro">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
        </out>
      </action>
  </rule>

  <rule comment="estar + ger -> être en train de + inf">
      <pattern>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="1" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="1" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
          </otherwise>
        </choose>
        <out>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

     <rule comment="estar + ger + enc -> être en train de + enc + inf">
      <pattern>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="1"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="1" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="1" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="1" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
          </otherwise>
        </choose>
            <out>
              <lu>
                <lit v="être"/>
                <lit-tag v="vbser"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="en train de"/>
              <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="3" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
      </action>
    </rule>


 <rule comment="estar GER + enc + enc : être en train de pro pro inf">
      <pattern>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="lem"/>
                  <lit v="li"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="lem"/>
                  <lit v="el"/>
                </equal>
              </and>
            </test>
            <out>
             <lu>
              <lit v="être"/>
                <lit-tag v="vbser"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="en train de"/>
                <lit-tag v="pr"/>
                </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="3" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <lit v="être"/>
                <lit-tag v="vbser"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="en train de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="3" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="prn.pro"/>
                <clip pos="4" side="tl" part="tipoenc_pro"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_verb"/>
                <lit-tag v="inf"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

  <rule comment="no estar + ger -> n'être pas en train de + inf">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
          </otherwise>
        </choose>
        <out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

  <rule comment="no estar + ger + enc -> n'être pas en train de + pro + inf">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not><equal><var n="inici"/><lit-tag v="si"/></equal></not>
            </test>
          </when>
          <otherwise>
            <call-macro n="f_setpronom">
              <with-param pos="2"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="p3"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="m"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="2" side="sl" part="lem"/>
                <lit-tag v="prn.tn"/>
                <clip pos="2" side="sl" part="persona"/>
                <lit-tag v="mf"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b/>
            </out>
          </otherwise>
        </choose>
          </otherwise>
        </choose>
        <out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>

  <rule comment="SENT + estar + ger -> SENT + être en train de + inf">
      <pattern>
        <pattern-item n="sentquecm"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="f_setpronom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_pis2prs">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="p3"/>
	      </equal>
	    </test>
	    <out>
	      <lu>
		<clip pos="2" side="sl" part="lem"/>
		<lit-tag v="prn.tn"/>
		<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="m"/>
		<clip pos="2" side="sl" part="nbr"/>
	      </lu>
	      <b/>
	      <lu>
	<lit v="être"/>
		<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
	      <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <lu>
		<clip pos="2" side="sl" part="lem"/>
		<lit-tag v="prn.tn"/>
	<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="mf"/>
		<clip pos="2" side="sl" part="nbr"/>
	      </lu>
	      <b/>
		 <lu>
	<lit v="être"/>
	<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
      <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </otherwise>
	</choose>
      </action>
    </rule>

     <rule comment="SENT + estar + ger + enc -> SENT + être en train de + enc + inf">
      <pattern>
	<pattern-item n="sentquecm"/>
	<pattern-item n="estar_portar_conj"/>
	<pattern-item n="ger"/>
      <pattern-item n="prnenc"/>
      </pattern>
      <action>
	<call-macro n="f_setpronom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_pis2prs">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="p3"/>
	      </equal>
	    </test>
	    <out>
	      <lu>
		<clip pos="2" side="sl" part="lem"/>
		<lit-tag v="prn.tn"/>
		<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="m"/>
		<clip pos="2" side="sl" part="nbr"/>
	      </lu>
	      <b/>
		 <lu>
	<lit v="être"/>
		<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
      <b/>
      <lu>
       <clip pos="4" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="4" side="tl" part="tipoenc_pro"/>
      </lu>
     <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <lu>
		<clip pos="2" side="sl" part="lem"/>
		<lit-tag v="prn.tn"/>
		<clip pos="2" side="sl" part="persona"/>
		<lit-tag v="mf"/>
		<clip pos="2" side="sl" part="nbr"/>
	      </lu>
	      <b/>
		 <lu>
		<lit v="être"/>
		<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
      <b/>
      <lu>
	<clip pos="4" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="4" side="tl" part="tipoenc_pro"/>
      </lu>
       <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </otherwise>
	</choose>
      </action>
    </rule>


 <rule comment="SENT + estar GER + enc + enc : SENT + être en train de pro pro inf">
      <pattern>
	<pattern-item n="sentquecm"/>
	<pattern-item n="estar_portar_conj"/>
	<pattern-item n="ger"/>
	<pattern-item n="prnenc"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>
	<call-macro n="f_pis2prs">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="4" side="sl" part="lem"/>
		  <lit v="li"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="lem"/>
		  <lit v="el"/>
		</equal>
	      </and>
	    </test>
	    <out>
	     <lu>
	      <lit v="être"/>
		<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
	      <b/>
	      <lu>
		<clip pos="5" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="5" side="tl" part="tipoenc_pro"/>
	      </lu>
	      <b/>
	      <lu>
		<clip pos="4" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="4" side="tl" part="tipoenc_pro"/>
	      </lu>
	      <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </when>
	  <otherwise>
	    <out>
     <lu>
		<lit v="être"/>
		<lit-tag v="vbser"/>
		<clip pos="2" side="tl" part="temps"/>
		<clip pos="2" side="tl" part="persona"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </lu>
	      <b pos="2"/>
	      <lu>
	<lit v="en train de"/>
      <lit-tag v="pr"/>
      </lu>
	      <b/>
	      <lu>
		<clip pos="4" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="4" side="tl" part="tipoenc_pro"/>
	      </lu>
	      <b/>
	      <lu>
		<clip pos="5" side="tl" part="lem"/>
		<lit-tag v="prn.pro"/>
		<clip pos="5" side="tl" part="tipoenc_pro"/>
	      </lu>
	      <b/>
	      <lu>
		<clip pos="3" side="tl" part="lemh"/>
		<clip pos="3" side="tl" part="a_verb"/>
		<lit-tag v="inf"/>
		<clip pos="3" side="tl" part="lemq"/>
	      </lu>
	    </out>
	  </otherwise>
	</choose>
      </action>
  </rule>

  <rule comment="PRNPROREF estar + ger -> s'être en train de + inf">
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="2"/>
        </call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


  <rule comment="no PRNPROREF estar + ger -> ne s'être pas en train de + inf">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
	  </lu>
	  <b pos="2"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


  <rule comment="SENT PRNPROREF estar + ger -> SENT s'être en train de + inf">
      <pattern>
	<pattern-item n="sentquecm"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="f_setpronom">
	  <with-param pos="3"/>
	</call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="3"/>
        </call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	</out>

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="sl" part="persona"/>
		<lit-tag v="p3"/>
	      </equal>
	    </test>
	    <out>
	      <lu>
                <get-case-from pos="2">
		  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
		<lit-tag v="prn.tn"/>
		<clip pos="3" side="sl" part="persona"/>
		<lit-tag v="m"/>
		<clip pos="3" side="sl" part="nbr"/>
	      </lu>
	      <b/>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <lu>
                <get-case-from pos="2">
		  <clip pos="3" side="sl" part="lem"/>
                </get-case-from>
		<lit-tag v="prn.tn"/>
		<clip pos="3" side="sl" part="persona"/>
		<lit-tag v="mf"/>
		<clip pos="3" side="sl" part="nbr"/>
	      </lu>
	      <b/>
	    </out>
	  </otherwise>
	</choose>

	<out>
	  <lu>
            <get-case-from pos="3">
	      <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
	  </lu>
	  <b pos="2"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


  <rule comment="SENT NO PRNPROREF estar + ger -> SENT NE s'être pas en train de + inf">
      <pattern>
	<pattern-item n="sentquecm"/>
	<pattern-item n="noadv"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="estar_portar_conj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="f_setpronom">
	  <with-param pos="4"/>
	</call-macro>
        <call-macro n="f_pis2prs">
          <with-param pos="4"/>
        </call-macro>
	<out>
	  <lu>
	    <clip pos="1" side="tl" part="whole"/>
	  </lu>
	  <b pos="1"/>
	</out>

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="sl" part="persona"/>
		<lit-tag v="p3"/>
	      </equal>
	    </test>
	    <out>
	      <lu>
                <get-case-from pos="2">
		  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
		<lit-tag v="prn.tn"/>
		<clip pos="4" side="sl" part="persona"/>
		<lit-tag v="m"/>
		<clip pos="4" side="sl" part="nbr"/>
	      </lu>
	      <b/>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <lu>
                <get-case-from pos="2">
		  <clip pos="4" side="sl" part="lem"/>
                </get-case-from>
		<lit-tag v="prn.tn"/>
		<clip pos="4" side="sl" part="persona"/>
		<lit-tag v="mf"/>
		<clip pos="4" side="sl" part="nbr"/>
	      </lu>
	      <b/>
	    </out>
	  </otherwise>
	</choose>

	<out>
	  <lu>
            <get-case-from pos="3">
	      <clip pos="2" side="tl" part="whole"/>
            </get-case-from>
	  </lu>
	  <b pos="2"/>
	  <lu>
	   <clip pos="3" side="tl" part="whole"/>
	  </lu>
	  <b pos="3"/>
          <lu>
            <lit v="être"/>
            <lit-tag v="vbser"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
          <b pos="4"/>
          <lu>
            <lit v="pas"/>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <lit v="en train de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>


    <rule comment="SENT + IMP + enc + enc">
      <pattern>
	<pattern-item n="sentquecm"/>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modimp2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <and>
               <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="aller"/></equal>
               <equal caseless="yes"><clip pos="4" side="tl" part="lem"/><lit v="en"/></equal>
             </and>
           </test>
        <out>
          <mlu>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_prnenc"/>
              <clip pos="4" side="tl" part="persona"/>
              <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </when>
      <otherwise>
        <out>
    <mlu>
      <lu>
        <clip pos="2" side="tl" part="lemh"/>
        <clip pos="2" side="tl" part="a_verb"/>
        <clip pos="2" side="tl" part="temps"/>
        <clip pos="2" side="tl" part="persona"/>
        <clip pos="2" side="tl" part="nbr"/>
      </lu>
      <lu>
        <clip pos="4" side="tl" part="lem"/>
        <clip pos="4" side="tl" part="a_prnenc"/>
        <clip pos="4" side="tl" part="persona"/>
        <clip pos="4" side="tl" part="gen"/>
        <clip pos="4" side="tl" part="nbr"/>
        <clip pos="2" side="tl" part="lemq"/>
      </lu>
    </mlu>
          </out>
           </otherwise>
         </choose>
      </action>
  </rule>

    <rule comment="IMP + enc + enc">
      <pattern>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modimp2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
               <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="aller"/></equal>
               <equal caseless="yes"><clip pos="3" side="tl" part="lem"/><lit v="en"/></equal>
             </and>
           </test>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </when>
      <otherwise>
        <out>
    <mlu>
      <lu>
        <clip pos="1" side="tl" part="lemh"/>
        <clip pos="1" side="tl" part="a_verb"/>
        <clip pos="1" side="tl" part="temps"/>
        <clip pos="1" side="tl" part="persona"/>
        <clip pos="1" side="tl" part="nbr"/>
      </lu>
      <lu>
        <clip pos="3" side="tl" part="lem"/>
        <clip pos="3" side="tl" part="a_prnenc"/>
        <clip pos="3" side="tl" part="persona"/>
        <clip pos="3" side="tl" part="gen"/>
        <clip pos="3" side="tl" part="nbr"/>
        <clip pos="1" side="tl" part="lemq"/>
      </lu>
    </mlu>
          </out>
           </otherwise>
         </choose>
      </action>
  </rule>

    <rule comment="EN + INF - EN + GER Comprovar traducció">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="infnm"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="EN + INF'S - EN + GER Comprovar traducció">
      <pattern>
        <pattern-item n="en"/>
        <pattern-item n="infnm"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ger"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="l'any 1998 > en 1998">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="any"/>
        <pattern-item n="xifra"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="en"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="prep l'any 1998 > prep l'an 1998">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="any"/>
        <pattern-item n="xifra"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

<!--comparatives-->
    <rule comment="tants/menys/més NOM com/que : autant/moins/plus de NOM que">
      <pattern>
        <pattern-item n="comp"/>
        <pattern-item n="nom"/>
        <pattern-item n="quecom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="tant"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="autant"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="tants/menys/més NOM com/que : autant/moins/plus de NOM que de">
      <pattern>
        <pattern-item n="comp"/>
        <pattern-item n="nom"/>
        <pattern-item n="quecom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="tant"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="autant"/>
                <lit-tag v="adv"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="tan ADJ com: aussi ADJ que">
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
        <pattern-item n="com"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="tan"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="aussi"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
            </out>
            <call-macro n="superlatiu">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
  </rule>

    <rule comment="tan ADV com: aussi ADV que">
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="com"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="tan"/>
              </equal>
            </test>
            <out>
              <lu>
                <lit v="aussi"/>
                <lit-tag v="adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <lit v="que"/>
                <lit-tag v="cnjsub"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!-- fi comparatives -->

    <rule comment="REGLA: quants NOM > combien de">
      <pattern>
        <pattern-item n="quants"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_lang_dial1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: dilluns al matí > lundi matin">
      <pattern>
        <pattern-item n="dia_setmana"/>
        <pattern-item n="aprep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="part_dia_n"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: el dilluns al matí > lundi matin">
      <pattern>
        <pattern-item n="detdef"/>
        <pattern-item n="dia_setmana"/>
        <pattern-item n="aprep"/>
        <pattern-item n="detdef"/>
        <pattern-item n="part_dia_n"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="5"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: dilluns al matí > lundi matin">
      <pattern>
        <pattern-item n="dia_setmana"/>
        <pattern-item n="part_dia_adv"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="al matí"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <lit v="matin"/>
                </get-case-from>
                  <lit-tag v="n.m.sg"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="a la tarda"/></equal>
                <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="a la vesprada"/></equal>
              </or>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <lit v="après-midi"/>
                </get-case-from>
                  <lit-tag v="n.m.sp"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="al vespre"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <lit v="soir"/>
                </get-case-from>
                  <lit-tag v="n.m.sg"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="a la nit"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <lit v="soir"/>
                </get-case-from>
                  <lit-tag v="n.m.sg"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="de matinada"/></equal>
            </test>
            <out>
              <lu>
                <get-case-from pos="2">
                  <lit v="matin"/>
                </get-case-from>
                  <lit-tag v="n.m.sg"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
  </rule>

<!-- expressions de temps amb fa -->

    <rule comment="REGLA: fa NUM temps > il y a NUM temps">
      <pattern>
        <pattern-item n="fa"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il y a"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: fa uns NUM temps > il y a près de NUM temps">
      <pattern>
        <pattern-item n="fa"/>
        <pattern-item n="uns"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il y a"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="près de"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: fa DETIND temps > il y a DETIND temps">
      <pattern>
        <pattern-item n="fa"/>
        <pattern-item n="detind"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="cada"/></equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="tags"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <get-case-from pos="1">
                  <lit v="il y a"/>
                </get-case-from>
                <lit-tag v="vblex.pri.p3.sg"/>
              </lu>
            </out>
          </otherwise>
        </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: fa NUM o NUM temps > il y a NUM ou NUM temps">
      <pattern>
        <pattern-item n="fa"/>
        <pattern-item n="num"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="il y a"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: feia NUM temps > depuis NUM temps">
      <pattern>
        <pattern-item n="feia"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: feia DETIND temps > depuis DETIND temps">
      <pattern>
        <pattern-item n="feia"/>
        <pattern-item n="detind"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PREP feia NUM temps > PREP NUM temps">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="feia"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: PREP feia DETIND temps > PREP il y a DETIND temps">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="feia"/>
        <pattern-item n="detind"/>
        <pattern-item n="n_temps"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="il y a"/>
            </get-case-from>
            <lit-tag v="vblex.pri.p3.sg"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: fa temps_pl que > depuis des temps">
      <pattern>
        <pattern-item n="fa_feia"/>
        <pattern-item n="n_temps_pl"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit v="le"/>
            <lit-tag v="det.def.mf.pl"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: fa NUM temps que > depuis NUM temps">
      <pattern>
        <pattern-item n="fa_feia"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: fa DETIND temps que > depuis DETIND temps">
      <pattern>
        <pattern-item n="fa_feia"/>
        <pattern-item n="detind"/>
        <pattern-item n="n_temps"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: SENT fa NUM temps que > SENT depuis NUM temps">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="fa_feia"/>
        <pattern-item n="num"/>
        <pattern-item n="n_temps"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
  </rule>

    <rule comment="REGLA: SENT fa DETIND temps que > SENT depuis DETIND temps">
      <pattern>
        <pattern-item n="sentquecmrel"/>
        <pattern-item n="fa_feia"/>
        <pattern-item n="detind"/>
        <pattern-item n="n_temps"/>
        <pattern-item n="que"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="2">
              <lit v="depuis"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="4"/><with-param pos="5"/></call-macro>
      </action>
  </rule>

<!-- fi expressions de temps amb fa -->

<!-- "anar + ger" -->

    <rule comment="anar GER >> continuer à INF">
      <pattern>
        <pattern-item n="anar_continuar"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="1">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="haver anat GER >> avoir continué à INF">
      <pattern>
        <pattern-item n="haver"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="va anar GER >> avoir continué à INF">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="anar_continuar_inf"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <lit-tag v="vblex.pp.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no anar GER >> ne continuer pas à INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anar_continuar_cnj"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no haver anat GER >> n'avoir pas continué à INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="haver-cnj"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="3"/>
        </out>
        <let><clip pos="4" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no va anar GER >> n'avoir pas continué à INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anarpri"/>
        <pattern-item n="anar_continuar_inf"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="continuer"/>
            </get-case-from>
            <lit-tag v="vblex.pp.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="3"/>
        </out>
        <let><clip pos="4" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="anar GER PRNENC >> continuer à PRNPRO INF">
      <pattern>
        <pattern-item n="anar_continuar"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="1">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <let><clip pos="2" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="3" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="haver anat GER PRNENC >> avoir continué à PRNPRO INF">
      <pattern>
        <pattern-item n="haver"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="va anar GER PRNENC >> avoir continué à PRNPRO INF">
      <pattern>
        <pattern-item n="anarpri"/>
        <pattern-item n="anar_continuar_inf"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="1" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="1" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="1" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="avoir"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pri"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <lit-tag v="vblex.pp.m.sg"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no anar GER PRNENC >> ne continuer pas à PRNPRO INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="anar_continuar_cnj"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="2">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no haver anat GER PRNENC >> n'avoir pas continué à PRNPRO INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="haver-cnj"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="3"/>
        </out>
        <let><clip pos="4" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="5" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="PRNPROREF anar GER >> continuer à PRNPROREF INF">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="anar_continuar_p3"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="1">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
        </out>
        <let><clip pos="3" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="PRNPROREF haver anat GER >> avoir continué à PRNPROREF INF">
      <pattern>
        <pattern-item n="es"/>
        <pattern-item n="haver-cnj-p3"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="2" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="2" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="2" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="2" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <let><clip pos="4" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no PRNPROREF anar GER >> ne continuer pas à PRNPROREF INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="anar_continuar_p3"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="3">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="1">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="tags"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
        </out>
        <let><clip pos="4" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

    <rule comment="no PRNPROREF haver anat GER >> no avoir pas continué à PRNPROREF INF">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="es"/>
        <pattern-item n="haver-cnj-p3"/>
        <pattern-item n="anar_continuar_ppmsg"/>
        <pattern-item n="ger"/>
      </pattern>
      <action>
     <choose>
       <when>
         <test>
           <equal><var n="inici"/><lit-tag v="si"/></equal>
         </test>
         <call-macro n="f_setpronom">
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="3" side="sl" part="persona"/><lit-tag v="p3"/></equal>
             </test>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="m"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </when>
           <otherwise>
             <out>
               <lu>
                 <get-case-from pos="1">
                   <clip pos="3" side="sl" part="lem"/>
                 </get-case-from>
                 <lit-tag v="prn.tn"/>
                 <clip pos="3" side="sl" part="persona"/>
                 <lit-tag v="mf"/>
                 <clip pos="3" side="sl" part="nbr"/>
               </lu>
               <b/>
             </out>
           </otherwise>
         </choose>
         <modify-case>
           <clip pos="1" side="sl" part="lemh"/>
           <lit v="aa"/>
         </modify-case>
       </when>
     </choose>

        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="4">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="4">
              <lit v="continuer"/>
            </get-case-from>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="4">
              <lit v="à"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
        </out>
        <let><clip pos="5" side="tl" part="temps"/><lit-tag v="inf"/></let>
        <out>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
  </action>
</rule>

<!-- "fi anar + ger" -->

<!-- "tot i + inf" -->

    <rule comment="REGLA: tot i INF > malgré INF">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i HAVERINF PP > malgré HAVERINF PP">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="haverinf"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i no INF > malgré ne pas INF">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="noadv"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i no HAVERINF PP > malgré ne pas HAVERINF PP">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="noadv"/>
        <pattern-item n="haverinf"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i INF PRNENC > malgré PRNPRO INF">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i HAVERINF PRNENC PP > malgré PRNPRO HAVERINF PP">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="haverinf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="3"/>
          <with-param pos="5"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="4" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="tags"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="tags"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i no INF PRNENC > malgré ne pas PRNPRO INF">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="noadv"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="5" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

    <rule comment="REGLA: tot i no HAVERINF PRNENC PP > malgré ne pas PRNPRO HAVERINF PP">
      <pattern>
        <pattern-item n="tot"/>
        <pattern-item n="i"/>
        <pattern-item n="noadv"/>
        <pattern-item n="haverinf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vaux_pp2">
          <with-param pos="4"/>
          <with-param pos="6"/>
        </call-macro>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="malgré"/>
            </get-case-from>
            <lit-tag v="pr"/>
          </lu>
          <b pos="1"/>
        </out>
        <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
        <out>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
          <b/>
          <lu>
            <get-case-from pos="3">
              <lit v="pas"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="5" side="tl" part="lem"/>
            <lit-tag v="prn.pro"/>
            <clip pos="5" side="tl" part="tipoenc_pro"/>
          </lu>
          <b/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="tags"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
          <b pos="5"/>
          <lu>
            <clip pos="6" side="tl" part="lemh"/>
            <clip pos="6" side="tl" part="tags"/>
            <clip pos="6" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
  </rule>

<!-- fi "tot i + inf" -->

<!-- canvi de verb auxiliar en oracions reflexives o impersonals -->

<!--
<rule comment="regla: es haver pp">
   <pattern>
     <pattern-item n="es"/>
     <pattern-item n="haver-cnj-p3"/>
     <pattern-item n="pp"/>
   </pattern>
   <action>
     <out>
       <chunk name="prn_aux_pp">
         <tags>
           <tag><lit-tag v="SV"/></tag>
         </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <lit v="être"/>
             <lit-tag v="vbser"/>
             <clip pos="2" side="tl" part="temps"/>
             <clip pos="2" side="tl" part="persona"/>
             <clip pos="2" side="tl" part="nbr"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="a_verb"/>
             <lit-tag v="pp"/>
             <var n="genero"/>
             <clip pos="2" side="tl" part="nbr"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
       </chunk>
     </out>
   </action>
</rule>
-->

<!-- fi canvi de verb auxiliar en oracions reflexives o impersonals -->

    <rule comment="REGLA: què + ij > qu'est-ce que">
      <pattern>
        <pattern-item n="que_itg"/>
        <pattern-item n="ij"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <let><var n="afegir_putain"/><lit-tag v="si"/></let>
      </action>
    </rule>

    <rule comment="REGLA: comprep (per impedir el la reinicialització de les variables)">
      <pattern>
        <pattern-item n="comprep"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prep">
      <pattern>
        <pattern-item n="prep"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjsub">
      <pattern>
        <pattern-item n="cnjsub"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjadv">
      <pattern>
        <pattern-item n="cnjadv"/>
      </pattern>
      <action>
        <!-- reset variables -->
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: reset variables">
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal><var n="afegir_putain"/><lit-tag v="si"/></equal>
            </test>
            <out>
              <lu>
                <lit v=","/>
                <lit-tag v="cm"/>
              </lu>
              <b/>
              <lu>
                <lit v="putain"/>
                <lit-tag v="ij"/>
              </lu>
            </out>
            <let><var n="afegir_putain"/><lit-tag v="no"/></let>
          </when>
        </choose>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: . No, > . Non, ">
      <pattern>
        <pattern-item n="sent"/>
        <pattern-item n="noadv"/>
        <pattern-item n="cm"/>
      </pattern>
      <action>
        <let><var n="numero"/><lit-tag v="sg"/></let>
        <let><var n="genero"/><lit-tag v="m"/></let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="non"/>
            </get-case-from>
            <lit-tag v="adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule comment="regla: No, > Non, ">
      <pattern>
        <pattern-item n="noadv"/>
        <pattern-item n="cm"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <equal>
              <case-of pos="1" side="sl" part="lem"/>
              <lit v="Aa"/>
            </equal>
          </test>
          <out>
            <lu>
              <get-case-from pos="1">
                <lit v="non"/>
              </get-case-from>
              <lit-tag v="adv"/>
            </lu>
          </out>
        </when>
        <otherwise>
          <out>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </out>
        </otherwise>
      </choose>
        <out>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>

  </section-rules>
</transfer>
